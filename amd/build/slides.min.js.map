{"version":3,"file":"slides.min.js","sources":["../src/slides.js"],"sourcesContent":["define(\n    [\n    'jquery', 'core/log', 'mod_minilesson/definitions', './reveal',\n    'core/str', 'core/modal_factory', 'core/fragment'\n    ],\n    function ($, log, def, RevealImplement, Str, ModalFactory, Fragment) {\n        \"use strict\"; // jshint ;_;\n\n        /*\n       This file is to manage the slides item type\n        */\n\n        log.debug('MiniLesson Slides: initialising');\n\n        return {\n\n            instance: null,\n\n            itemdata: {},\n\n            //for making multiple instances\n            clone: function () {\n                return $.extend(true, {}, this);\n            },\n\n            init: function (index, itemdata, quizhelper) {\n                this.itemdata = itemdata;\n                this.register_events(index, itemdata, quizhelper);\n            },\n\n            prepare_html: function (itemdata) {\n                //do something\n            },\n\n            register_events: function (index, itemdata, quizhelper) {\n                var self = this;\n                //When click next button , report and leave it up to parent to eal with it.\n                $(\"#\" + itemdata.uniqueid + \"_container .minilesson_nextbutton\").on('click', function (e) {\n                    var stepdata = {};\n                    stepdata.index = index;\n                    stepdata.hasgrade = false;\n                    stepdata.totalitems = 0;\n                    stepdata.correctitems = 0;\n                    stepdata.grade = 0;\n                    quizhelper.do_next(stepdata);\n                });\n                $(\"#\" + itemdata.uniqueid + \"_container\").on(\"showElement\", async(e) => {\n                    if (!self.instance) {\n                        self.instance = await RevealImplement.init(e.target.querySelector('.reveal'), itemdata.region, itemdata.selectedtheme);\n                        self.instance.initialize();\n                    }\n\n                    if (itemdata.timelimit > 0) {\n                        $(\"#\" + itemdata.uniqueid + \"_container .progress-container\").show();\n                        $(\"#\" + itemdata.uniqueid + \"_container .progress-container i\").show();\n                        $(\"#\" + itemdata.uniqueid + \"_container .progress-container #progresstimer\").progressTimer({\n                            height: '5px',\n                            timeLimit: itemdata.timelimit,\n                            onFinish: function () {\n                                $(\"#\" + itemdata.uniqueid + \"_container .minilesson_nextbutton\").trigger('click');\n                            }\n                        });\n                    }\n                });\n            },\n\n            register_previewbutton: function (buttonid, region = 'default') {\n                var previewbtn = document.getElementById(buttonid);\n                if (!previewbtn) {\n                    return;\n                }\n                previewbtn.addEventListener('click', function (e) {\n                    e.preventDefault();\n                    var form = previewbtn.form;\n                    if (!form) {\n                        return;\n                    }\n                    ModalFactory.create({\n                        type: ModalFactory.types.CANCEL,\n                        large: true,\n                        removeOnClose: true,\n                        templateContext: {\n                            classes: 'minilesson-slides-preview-modal'\n                        },\n                        title: Str.get_string('slides:previewmodaltitle', 'mod_minilesson'),\n                        body: Fragment.loadFragment('mod_minilesson', 'preview_slides', M.cfg.contextid, {\n                            formdata: new URLSearchParams([...new FormData(form).entries()]).toString()\n                        })\n                    }).then(function (modal) {\n                        modal.getFooter().addClass('d-none');\n                        modal.show();\n                    });\n                    return;\n                });\n                if (previewbtn.form) {\n                    const themeselect = previewbtn.form.querySelector('[data-control=\"theme\"]');\n                    if (themeselect) {\n                        themeselect.addEventListener('change', function (e) {\n                            RevealImplement.setTheme(e.target.value);\n                        });\n                        RevealImplement.setTheme(themeselect.value);\n                    }\n                }\n            }\n        }; //end of return value\n    }\n);"],"names":["define","$","log","def","RevealImplement","Str","ModalFactory","Fragment","debug","instance","itemdata","clone","extend","this","init","index","quizhelper","register_events","prepare_html","self","uniqueid","on","e","stepdata","hasgrade","totalitems","correctitems","grade","do_next","async","target","querySelector","region","selectedtheme","initialize","timelimit","show","progressTimer","height","timeLimit","onFinish","trigger","register_previewbutton","buttonid","previewbtn","document","getElementById","addEventListener","preventDefault","form","create","type","types","CANCEL","large","removeOnClose","templateContext","classes","title","get_string","body","loadFragment","M","cfg","contextid","formdata","URLSearchParams","FormData","entries","toString","then","modal","getFooter","addClass","themeselect","setTheme","value"],"mappings":"AAAAA,+BACI,CACA,SAAU,WAAY,6BAA8B,WACpD,WAAY,qBAAsB,kBAElC,SAAUC,EAAGC,IAAKC,IAAKC,gBAAiBC,IAAKC,aAAcC,iBAOvDL,IAAIM,MAAM,mCAEH,CAEHC,SAAU,KAEVC,SAAU,GAGVC,MAAO,kBACIV,EAAEW,QAAO,EAAM,GAAIC,OAG9BC,KAAM,SAAUC,MAAOL,SAAUM,iBACxBN,SAAWA,cACXO,gBAAgBF,MAAOL,SAAUM,aAG1CE,aAAc,SAAUR,YAIxBO,gBAAiB,SAAUF,MAAOL,SAAUM,gBACpCG,KAAON,KAEXZ,EAAE,IAAMS,SAASU,SAAW,qCAAqCC,GAAG,SAAS,SAAUC,OAC/EC,SAAW,GACfA,SAASR,MAAQA,MACjBQ,SAASC,UAAW,EACpBD,SAASE,WAAa,EACtBF,SAASG,aAAe,EACxBH,SAASI,MAAQ,EACjBX,WAAWY,QAAQL,aAEvBtB,EAAE,IAAMS,SAASU,SAAW,cAAcC,GAAG,eAAeQ,MAAAA,IACnDV,KAAKV,WACNU,KAAKV,eAAiBL,gBAAgBU,KAAKQ,EAAEQ,OAAOC,cAAc,WAAYrB,SAASsB,OAAQtB,SAASuB,eACxGd,KAAKV,SAASyB,cAGdxB,SAASyB,UAAY,IACrBlC,EAAE,IAAMS,SAASU,SAAW,kCAAkCgB,OAC9DnC,EAAE,IAAMS,SAASU,SAAW,oCAAoCgB,OAChEnC,EAAE,IAAMS,SAASU,SAAW,iDAAiDiB,cAAc,CACvFC,OAAQ,MACRC,UAAW7B,SAASyB,UACpBK,SAAU,WACNvC,EAAE,IAAMS,SAASU,SAAW,qCAAqCqB,QAAQ,iBAO7FC,uBAAwB,SAAUC,cAC1BC,WAAaC,SAASC,eAAeH,aACpCC,aAGLA,WAAWG,iBAAiB,SAAS,SAAUzB,GAC3CA,EAAE0B,qBACEC,KAAOL,WAAWK,KACjBA,MAGL3C,aAAa4C,OAAO,CAChBC,KAAM7C,aAAa8C,MAAMC,OACzBC,OAAO,EACPC,eAAe,EACfC,gBAAiB,CACbC,QAAS,mCAEbC,MAAOrD,IAAIsD,WAAW,2BAA4B,kBAClDC,KAAMrD,SAASsD,aAAa,iBAAkB,iBAAkBC,EAAEC,IAAIC,UAAW,CAC7EC,SAAU,IAAIC,gBAAgB,IAAI,IAAIC,SAASlB,MAAMmB,YAAYC,eAEtEC,MAAK,SAAUC,OACdA,MAAMC,YAAYC,SAAS,UAC3BF,MAAMnC,aAIVQ,WAAWK,MAAM,OACXyB,YAAc9B,WAAWK,KAAKlB,cAAc,0BAC9C2C,cACAA,YAAY3B,iBAAiB,UAAU,SAAUzB,GAC7ClB,gBAAgBuE,SAASrD,EAAEQ,OAAO8C,UAEtCxE,gBAAgBuE,SAASD,YAAYE"}