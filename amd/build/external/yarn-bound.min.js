var root,factory;root=window,factory=()=>{return __webpack_modules__={897:(module,exports)=>(Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(content){const objects=[],lines=content.split(/\r?\n+/).filter((line=>!line.match(/^\s*$/)));let filetags,obj=null,readingBody=!1,leadingSpace="",i=0;for(;"#"===lines[i].trim()[0];)filetags||(filetags=[]),filetags.push(lines[i].trim().substr(1)),i+=1;for(;i<lines.length;i+=1)if("==="===lines[i].trim())readingBody=!1,filetags&&(obj.filetags=filetags),objects.push(obj),obj=null;else if(readingBody)obj.body+="".concat(lines[i].replace(leadingSpace,""),"\n");else if("---"===lines[i].trim())readingBody=!0,obj.body="",leadingSpace=lines[i].match(/^\s*/)[0];else if(lines[i].indexOf(":")>-1){const[key,value]=lines[i].split(":"),trimmedKey=key.trim(),trimmedValue=value.trim();if("body"!==trimmedKey){if(null==obj&&(obj={}),obj[trimmedKey])throw new Error("Duplicate tag on node: ".concat(trimmedKey));obj[trimmedKey]=trimmedValue}}return function(nodes){const smartVars={},declareRegex=/<<declare\s+(\$[A-Za-z0-9_.]+)\s*=\s*(.+?)\s*(?:as\s+\w+)?\s*>>/g;if(nodes.forEach((node=>{if(!node.body)return;let match;for(;null!==(match=declareRegex.exec(node.body));){const varName=match[1],expression=match[2].trim();expression.includes("$")&&(smartVars[varName]="(".concat(expression,")"))}declareRegex.lastIndex=0})),0===Object.keys(smartVars).length)return nodes;let changed=!0,iterations=0;const vars=Object.keys(smartVars);for(;changed&&iterations<10;)changed=!1,vars.forEach((v=>{const expr=smartVars[v];vars.forEach((otherV=>{if(v===otherV)return;const escapedV=otherV.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),regex=new RegExp(escapedV+"(?![A-Za-z0-9_.])","g"),newExpr=expr.replace(regex,smartVars[otherV]);newExpr!==expr&&(smartVars[v]=newExpr,changed=!0)}))})),iterations++;nodes.forEach((node=>{node.body&&Object.keys(smartVars).forEach((v=>{const escapedV=v.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),decRegex=new RegExp("^<<declare\\s+"+escapedV+"\\s*=.*>>\\r?\\n?","gm");node.body=node.body.replace(decRegex,"");const usageRegex=new RegExp(escapedV+"(?![A-Za-z0-9_.])","g");node.body=node.body.replace(usageRegex,smartVars[v])})),node.when&&Object.keys(smartVars).forEach((v=>{const escapedV=v.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),usageRegex=new RegExp(escapedV+"(?![A-Za-z0-9_.])","g");node.when=node.when.replace(usageRegex,smartVars[v])}))}))}(objects),objects.forEach((obj=>{obj.body&&(obj.body=function(content,nodeTitle){const safeTitle=(nodeTitle?nodeTitle.replace(/[^a-zA-Z0-9_]/g,"_"):"unknown")+"_"+Math.floor(1e6*Math.random()).toString(36),lines=content.split(/\r?\n/),newLines=[];let onceCounter=0,currentGroup=null;function flushGroup(){if(!currentGroup)return;const groupVarPrefix="$__lg_".concat(Date.now(),"_").concat(Math.floor(1e3*Math.random())),options=currentGroup.options,groupIndent=" ".repeat(currentGroup.indent),conditionalOptions=options.map(((opt,idx)=>({...opt,idx:idx}))).filter((opt=>opt.condition)),defaultOptions=options.map(((opt,idx)=>({...opt,idx:idx}))).filter((opt=>!opt.condition));newLines.push("".concat(groupIndent,"<<set $__pool_2 = 0>>")),conditionalOptions.forEach((opt=>{const varName="".concat(groupVarPrefix,"_").concat(opt.idx);newLines.push("".concat(groupIndent,"<<set ").concat(varName," = ").concat(opt.condition,">>")),newLines.push("".concat(groupIndent,"<<if ").concat(varName,">>")),newLines.push("".concat(groupIndent,"    <<set $__pool_2 = $__pool_2 + 1>>")),newLines.push("".concat(groupIndent,"<<endif>>"))})),newLines.push("".concat(groupIndent,"<<if $__pool_2 > 0>>")),newLines.push("".concat(groupIndent,"    <<set $__pick = floor(random() * $__pool_2)>>")),newLines.push("".concat(groupIndent,"    <<set $__current_idx = 0>>")),conditionalOptions.forEach((opt=>{const varName="".concat(groupVarPrefix,"_").concat(opt.idx);newLines.push("".concat(groupIndent,"    <<if ").concat(varName,">>")),newLines.push("".concat(groupIndent,"        <<if $__current_idx == $__pick>>")),opt.onceVar&&newLines.push("".concat(groupIndent,"            <<set ").concat(opt.onceVar," = true>>")),opt.lines.forEach((l=>newLines.push(l))),newLines.push("".concat(groupIndent,"        <<endif>>")),newLines.push("".concat(groupIndent,"        <<set $__current_idx = $__current_idx + 1>>")),newLines.push("".concat(groupIndent,"    <<endif>>"))})),defaultOptions.length>0&&(newLines.push("".concat(groupIndent,"<<else>>")),newLines.push("".concat(groupIndent,"    <<set $__pool_1 = ").concat(defaultOptions.length,">>")),newLines.push("".concat(groupIndent,"    <<set $__pick = floor(random() * $__pool_1)>>")),defaultOptions.forEach(((opt,dIdx)=>{defaultOptions.length>1&&newLines.push("".concat(groupIndent,"    <<if $__pick == ").concat(dIdx,">>")),opt.onceVar&&newLines.push("".concat(groupIndent,"        <<set ").concat(opt.onceVar," = true>>")),opt.lines.forEach((l=>newLines.push(l))),defaultOptions.length>1&&newLines.push("".concat(groupIndent,"    <<endif>>"))}))),newLines.push("".concat(groupIndent,"<<endif>>")),currentGroup=null}for(let i=0;i<lines.length;i++){const line=lines[i],indentMatch=line.match(/^(\s*)/),indent=indentMatch?indentMatch[1].length:0,trimmed=line.trim();if(trimmed.startsWith("=>"))if(currentGroup)if(indent===currentGroup.indent){let condition=null,text=trimmed.substring(2).trim();const ifMatch=text.match(/<<if\s+(.+)>>/);ifMatch&&(condition=ifMatch[1],text=text.replace(ifMatch[0],"").trim());const onceMatch=text.match(/<<once(?:\s+if\s+(.+))?>>/);let onceVar=null;if(onceMatch){onceVar="$__once_".concat(safeTitle,"_lg_").concat(onceCounter++);let onceCond="!".concat(onceVar);onceMatch[1]&&(onceCond="(".concat(onceCond,") && (").concat(onceMatch[1],")")),condition=condition?"(".concat(condition,") && (").concat(onceCond,")"):onceCond,text=text.replace(onceMatch[0],"").trim()}const innerIndent=" ".repeat(indent+8),contentLines=[];text&&contentLines.push(innerIndent+text),currentGroup.options.push({condition:condition,lines:contentLines,onceVar:onceVar})}else if(indent>currentGroup.indent)currentGroup.options[currentGroup.options.length-1].lines.push("        "+line);else{flushGroup(),currentGroup={indent:indent,options:[]};let condition=null,text=trimmed.substring(2).trim();const ifMatch=text.match(/<<if\s+(.+)>>/);ifMatch&&(condition=ifMatch[1],text=text.replace(ifMatch[0],"").trim());const onceMatch=text.match(/<<once(?:\s+if\s+(.+))?>>/);let onceVar=null;if(onceMatch){onceVar="$__once_".concat(safeTitle,"_lg_").concat(onceCounter++);let onceCond="!".concat(onceVar);onceMatch[1]&&(onceCond="(".concat(onceCond,") && (").concat(onceMatch[1],")")),condition=condition?"(".concat(condition,") && (").concat(onceCond,")"):onceCond,text=text.replace(onceMatch[0],"").trim()}const innerIndent=" ".repeat(indent+8),contentLines=[];text&&contentLines.push(innerIndent+text),currentGroup.options.push({condition:condition,lines:contentLines,onceVar:onceVar})}else{currentGroup={indent:indent,options:[]};let condition=null,text=trimmed.substring(2).trim();const ifMatch=text.match(/<<if\s+(.+)>>/);ifMatch&&(condition=ifMatch[1],text=text.replace(ifMatch[0],"").trim());const onceMatch=text.match(/<<once(?:\s+if\s+(.+))?>>/);let onceVar=null;if(onceMatch){onceVar="$__once_".concat(safeTitle,"_lg_").concat(onceCounter++);let onceCond="!".concat(onceVar);onceMatch[1]&&(onceCond="(".concat(onceCond,") && (").concat(onceMatch[1],")")),condition=condition?"(".concat(condition,") && (").concat(onceCond,")"):onceCond,text=text.replace(onceMatch[0],"").trim()}const innerIndent=" ".repeat(indent+8),contentLines=[];text&&contentLines.push(innerIndent+text),currentGroup.options.push({condition:condition,lines:contentLines,onceVar:onceVar})}else if(""===trimmed||trimmed.startsWith("//"))if(currentGroup){const lastOpt=currentGroup.options[currentGroup.options.length-1];lastOpt?lastOpt.lines.push(line):(flushGroup(),newLines.push(line))}else newLines.push(line);else currentGroup?indent>currentGroup.indent&&currentGroup.options.length>0?currentGroup.options[currentGroup.options.length-1].lines.push("        "+line):(flushGroup(),newLines.push(line)):newLines.push(line)}return flushGroup(),console.log("Transpiled Content:\n",newLines.join("\n")),newLines.join("\n")}(obj.body,obj.title),obj.title&&(obj.body=function(content,nodeTitle){const safeTitle=nodeTitle.replace(/[^a-zA-Z0-9_]/g,"_"),lines=content.split(/\r?\n/),newLines=[];let counter=0;for(let i=0;i<lines.length;i++){let line=lines[i];const trimmed=line.trim();if(trimmed.startsWith("=>")){newLines.push(line);continue}const blockStartMatch=trimmed.match(/^<<once(?:\s+if\s+(.+))?>>$/);if(blockStartMatch){const condition=blockStartMatch[1],variable="$__once_".concat(safeTitle,"_").concat(counter++),indent=line.substring(0,line.indexOf("<"));let finalCondition="!".concat(variable);condition&&(finalCondition="(".concat(finalCondition,") && (").concat(condition,")")),newLines.push("".concat(indent,"<<if ").concat(finalCondition,">>")),newLines.push("".concat(indent,"    <<set ").concat(variable," = true>>"));continue}if("<<endonce>>"===trimmed){const indent=line.substring(0,line.indexOf("<"));newLines.push("".concat(indent,"<<endif>>"));continue}const suffixMatch=line.match(/^(.*?)\s+<<once(?:\s+if\s+(.+))?>>\s*$/);if(suffixMatch){const prefix=suffixMatch[1],cleanPrefix=prefix.trim(),condition=suffixMatch[2],variable="$__once_".concat(safeTitle,"_").concat(counter++),indentMatch=prefix.match(/^\s*/),indent=indentMatch?indentMatch[0]:"";let finalCondition="!".concat(variable);if(condition&&(finalCondition="(".concat(finalCondition,") && (").concat(condition,")")),cleanPrefix.startsWith("->")){let finalPrefix=prefix;const existingIfMatch=prefix.match(/<<if\s+(.+)>>/);if(existingIfMatch){const mergedCond="(".concat(existingIfMatch[1],") && (").concat(finalCondition,")");finalPrefix=prefix.replace(existingIfMatch[0],"<<if ".concat(mergedCond,">>"))}else finalPrefix="".concat(prefix," <<if ").concat(finalCondition,">>");newLines.push(finalPrefix);let bodyIndent=indent+"    ";for(let j=i+1;j<lines.length;j++){const nextLine=lines[j];if(""!==nextLine.trim()){const nextIndentMatch=nextLine.match(/^\s*/),nextIndent=nextIndentMatch?nextIndentMatch[0]:"";nextIndent.length>indent.length&&(bodyIndent=nextIndent);break}}newLines.push("".concat(bodyIndent,"<<set ").concat(variable," = true>>"));continue}if(""!==cleanPrefix){newLines.push("".concat(indent,"<<if ").concat(finalCondition,">>")),newLines.push("".concat(indent,"    ").concat(cleanPrefix)),newLines.push("".concat(indent,"    <<set ").concat(variable," = true>>")),newLines.push("".concat(indent,"<<endif>>"));continue}}newLines.push(line)}return newLines.join("\n")}(obj.body,obj.title)))})),function(nodes){const groups={};nodes.forEach((node=>{groups[node.title]||(groups[node.title]=[]),groups[node.title].push(node)}));const mergedNodes=[];return Object.keys(groups).forEach((title=>{const group=groups[title];if(1===group.length)return void mergedNodes.push(group[0]);const defaultNode=group.find((n=>!n.when||"always"===n.when)),conditionalNodes=group.filter((n=>n.when&&"always"!==n.when));let newBody="";const prefix="$__ng_".concat(title.replace(/[^a-zA-Z0-9_]/g,"_"));newBody+="<<set $__ng_pool = 0>>\n",conditionalNodes.forEach(((node,idx)=>{const varName="".concat(prefix,"_").concat(idx);let condition=node.when;if("once"===condition){const visitedVar="".concat(prefix,"_visited_").concat(idx);condition="!".concat(visitedVar)}newBody+="<<set ".concat(varName," = ").concat(condition,">>\n"),newBody+="<<if ".concat(varName,">>\n"),newBody+="    <<set $__ng_pool = $__ng_pool + 1>>\n",newBody+="<<endif>>\n"})),newBody+="<<if $__ng_pool > 0>>\n",newBody+="    <<set $__pick = floor(random() * $__ng_pool)>>\n",newBody+="    <<set $__current_idx = 0>>\n",conditionalNodes.forEach(((node,idx)=>{const varName="".concat(prefix,"_").concat(idx);if(newBody+="    <<if ".concat(varName,">>\n"),newBody+="        <<if $__current_idx == $__pick>>\n","once"===node.when){const visitedVar="".concat(prefix,"_visited_").concat(idx);newBody+="            <<if !$__lookahead>>\n",newBody+="                <<set ".concat(visitedVar," = true>>\n"),newBody+="            <<endif>>\n"}newBody+=node.body+"\n",newBody+="        <<endif>>\n",newBody+="        <<set $__current_idx = $__current_idx + 1>>\n",newBody+="    <<endif>>\n"})),newBody+="<<else>>\n",newBody+="    <<set $__ng_pre = 0>>\n",defaultNode&&(newBody+=defaultNode.body+"\n"),newBody+="    <<set $__ng_padding = 0>>\n",newBody+="<<endif>>\n",mergedNodes.push({title:title,tags:group[0].tags,body:newBody,filetags:group[0].filetags})})),mergedNodes}(objects)},module.exports=exports.default,exports.default),163:(module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.default=class{constructor(){this.data={}}set(name,value){this.data[name]=value}get(name){const val=this.data[name];return(void 0!==val||!(name.startsWith("$__once_")||name.startsWith("$__ng_")||name.startsWith("__ng_")))&&val}},module.exports=exports.default},947:(module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _runner=_interopRequireDefault(__webpack_require__(333)),_results=_interopRequireDefault(__webpack_require__(377));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}_runner.default.OptionsResult=_results.default.OptionsResult,_runner.default.TextResult=_results.default.TextResult,_runner.default.CommandResult=_results.default.CommandResult,exports.default=_runner.default,module.exports=exports.default},172:(module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e,_tokens=(e=__webpack_require__(958))&&e.__esModule?e:{default:e};exports.default=class{constructor(){this.transitions=[],this.textRule=null,this.isTrackingNextIndentation=!1}addTransition(token,state,delimitsText){return this.transitions.push({token:token,regex:_tokens.default[token],state:state||null,delimitsText:delimitsText||!1}),this}addTextRule(type,state){if(this.textRule)throw new Error("Cannot add more than one text rule to a state.");const rules=[];this.transitions.forEach((transition=>{transition.delimitsText&&rules.push("(".concat(transition.regex.source,")"))}));const textPattern="((?!".concat(rules.join("|"),").)+");return this.addTransition(type,state),this.textRule=this.transitions[this.transitions.length-1],this.textRule.regex=new RegExp(textPattern),this}setTrackNextIndentation(track){return this.isTrackingNextIndentation=track,this}},module.exports=exports.default},160:(module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e,_states=(e=__webpack_require__(434))&&e.__esModule?e:{default:e};exports.default=class{constructor(){this.states=_states.default.makeStates(),this.state="base",this.originalText="",this.lines=[],this.indentation=[[0,!1]],this.shouldTrackNextIndentation=!1,this.previousLevelOfIndentation=0,this.reset()}reset(){this.yytext="",this.yylloc={first_column:1,first_line:1,last_column:1,last_line:1},this.yylineno=1}lex(){if(this.isAtTheEndOfText()){this.yytext="";const indent=this.indentation.pop();return indent&&indent[1]?"Dedent":"EndOfInput"}return this.isAtTheEndOfLine()?(this.advanceLine(),"EndOfLine"):this.lexNextTokenOnCurrentLine()}advanceLine(){this.yylineno+=1;const currentLine=this.getCurrentLine();this.lines[this.yylineno-1]=currentLine,this.previousLevelOfIndentation=this.getLastRecordedIndentation()[0],this.yytext="",this.yylloc={first_column:1,first_line:this.yylineno,last_column:1,last_line:this.yylineno}}lexNextTokenOnCurrentLine(){const thisIndentation=this.getCurrentLineIndentation();if(this.shouldTrackNextIndentation&&this.yylloc.first_column===this.yylloc.last_column&&thisIndentation>this.previousLevelOfIndentation)return this.indentation.push([thisIndentation,!0]),this.shouldTrackNextIndentation=!1,this.yylloc.first_column=this.yylloc.last_column,this.yylloc.last_column+=thisIndentation,this.yytext="","Indent";if(thisIndentation<this.getLastRecordedIndentation()[0]&&this.indentation.pop()[1]&&this.yylloc.first_column===this.yylloc.last_column)return this.yytext="",this.previousLevelOfIndentation=this.getLastRecordedIndentation()[0],"Dedent";thisIndentation===this.previousLevelOfIndentation&&1===this.yylloc.last_column&&(this.yylloc.last_column+=thisIndentation);let rule=this.getState().transitions.find((rule=>{const match=this.getCurrentLine().substring(this.yylloc.last_column-1).match(rule.regex);return null!==match&&0===match.index})),match=this.getCurrentLine().substring(this.yylloc.last_column-1).match(rule.regex);if(1===this.yylloc.last_column&&!this.shouldTrackNextIndentation){const spaceMatch=this.getCurrentLine().substring(this.yylloc.last_column-1).match(/^\s*/);this.yylloc.last_column+=spaceMatch[0].length,rule=this.getState().transitions.find((rule=>{const match=this.getCurrentLine().substring(this.yylloc.last_column-1).match(rule.regex);return null!==match&&0===match.index})),match=this.getCurrentLine().substring(this.yylloc.last_column-1).match(rule.regex)}const matchedText=match[0];this.yytext=this.getCurrentLine().substr(this.yylloc.last_column-1,matchedText.length),"String"===rule.token&&(this.yytext=this.yytext.substring(1,this.yytext.length-1)),this.yylloc.first_column=this.yylloc.last_column,this.yylloc.last_column+=matchedText.length,rule.state&&(this.setState(rule.state),this.shouldTrackNextIndentation&&this.getLastRecordedIndentation()[0]<thisIndentation&&this.indentation.push([thisIndentation,!1]));const nextState=this.states[rule.state],nextStateHasText=!rule.state||nextState.transitions.find((transition=>"Text"===transition.token));if("EndInlineExp"!==rule.token&&"EscapedCharacter"!==rule.token||!nextStateHasText){const spaceMatch=this.getCurrentLine().substring(this.yylloc.last_column-1).match(/^\s*/);spaceMatch[0]&&(this.yylloc.last_column+=spaceMatch[0].length)}return rule.token}setState(state){if(void 0===this.states[state])throw new Error("Cannot set the unknown state [".concat(state,"]"));this.state=state,this.getState().isTrackingNextIndentation&&(this.shouldTrackNextIndentation=!0)}setInput(text){this.originalText=text.replace(/(\r\n)/g,"\n").replace(/\r/g,"\n").replace(/[\n\r]+$/,""),this.lines=this.originalText.split("\n").map((line=>line.replace(/\t/,"    "))),this.reset()}getState(){return this.states[this.state]}getCurrentLine(){return this.lines[this.yylineno-1]}getCurrentLineIndentation(){return this.getCurrentLine().match(/^(\s*)/g)[0].length}getLastRecordedIndentation(){return 0===this.indentation.length?[0,!1]:this.indentation[this.indentation.length-1]}isAtTheEndOfText(){return this.isAtTheEndOfLine()&&this.yylloc.first_line>=this.lines.length}isAtTheEndOfLine(){return this.yylloc.last_column>this.getCurrentLine().length}},module.exports=exports.default},434:(module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e,_lexerState=(e=__webpack_require__(172))&&e.__esModule?e:{default:e};exports.default={makeStates:function(){return{base:(new _lexerState.default).addTransition("EscapedCharacter",null,!0).addTransition("Comment",null,!0).addTransition("Hashtag",null,!0).addTransition("BeginCommand","command",!0).addTransition("BeginInlineExp","inlineExpression",!0).addTransition("ShortcutOption","shortcutOption").addTextRule("Text"),shortcutOption:(new _lexerState.default).setTrackNextIndentation(!0).addTransition("EscapedCharacter",null,!0).addTransition("Comment",null,!0).addTransition("Hashtag",null,!0).addTransition("BeginCommand","expression",!0).addTransition("BeginInlineExp","inlineExpressionInShortcut",!0).addTextRule("Text","base"),command:(new _lexerState.default).addTransition("If","expression").addTransition("Else").addTransition("ElseIf","expression").addTransition("EndIf").addTransition("Set","assignment").addTransition("Declare","declare").addTransition("Jump","jump").addTransition("Stop","stop").addTransition("BeginInlineExp","inlineExpressionInCommand",!0).addTransition("EndCommand","base",!0).addTextRule("Text"),commandArg:(new _lexerState.default).addTextRule("Text"),commandParenArgOrExpression:(new _lexerState.default).addTransition("EndCommand","base",!0).addTransition("LeftParen","expression").addTransition("Variable","expression").addTransition("Number","expression").addTransition("String").addTransition("True").addTransition("False").addTransition("Null").addTransition("RightParen"),assignment:(new _lexerState.default).addTransition("Variable").addTransition("EqualToOrAssign","expression"),declare:(new _lexerState.default).addTransition("Variable").addTransition("EndCommand","base").addTransition("EqualToOrAssign","expression"),jump:(new _lexerState.default).addTransition("Identifier").addTransition("BeginInlineExp","inlineExpressionInCommand",!0).addTransition("EndCommand","base",!0),stop:(new _lexerState.default).addTransition("EndCommand","base",!0),expression:(new _lexerState.default).addTransition("As").addTransition("ExplicitType").addTransition("EndCommand","base").addTransition("Number").addTransition("String").addTransition("LeftParen").addTransition("RightParen").addTransition("EqualTo").addTransition("EqualToOrAssign").addTransition("NotEqualTo").addTransition("GreaterThanOrEqualTo").addTransition("GreaterThan").addTransition("LessThanOrEqualTo").addTransition("LessThan").addTransition("Add").addTransition("UnaryMinus").addTransition("Minus").addTransition("Exponent").addTransition("Multiply").addTransition("Divide").addTransition("Modulo").addTransition("And").addTransition("Or").addTransition("Xor").addTransition("Not").addTransition("Variable").addTransition("Comma").addTransition("True").addTransition("False").addTransition("Null").addTransition("Identifier").addTextRule(),inlineExpression:(new _lexerState.default).addTransition("EndInlineExp","base").addTransition("Number").addTransition("String").addTransition("LeftParen").addTransition("RightParen").addTransition("EqualTo").addTransition("EqualToOrAssign").addTransition("NotEqualTo").addTransition("GreaterThanOrEqualTo").addTransition("GreaterThan").addTransition("LessThanOrEqualTo").addTransition("LessThan").addTransition("Add").addTransition("UnaryMinus").addTransition("Minus").addTransition("Exponent").addTransition("Multiply").addTransition("Divide").addTransition("Modulo").addTransition("And").addTransition("Or").addTransition("Xor").addTransition("Not").addTransition("Variable").addTransition("Comma").addTransition("True").addTransition("False").addTransition("Null").addTransition("Identifier").addTextRule("Text","base"),inlineExpressionInCommand:(new _lexerState.default).addTransition("EndInlineExp","command").addTransition("Number").addTransition("String").addTransition("LeftParen").addTransition("RightParen").addTransition("EqualTo").addTransition("EqualToOrAssign").addTransition("NotEqualTo").addTransition("GreaterThanOrEqualTo").addTransition("GreaterThan").addTransition("LessThanOrEqualTo").addTransition("LessThan").addTransition("Add").addTransition("UnaryMinus").addTransition("Minus").addTransition("Exponent").addTransition("Multiply").addTransition("Divide").addTransition("Modulo").addTransition("And").addTransition("Or").addTransition("Xor").addTransition("Not").addTransition("Variable").addTransition("Comma").addTransition("True").addTransition("False").addTransition("Null").addTransition("Identifier").addTextRule("Text","base"),inlineExpressionInShortcut:(new _lexerState.default).addTransition("EndInlineExp","shortcutOption").addTransition("Number").addTransition("String").addTransition("LeftParen").addTransition("RightParen").addTransition("EqualTo").addTransition("EqualToOrAssign").addTransition("NotEqualTo").addTransition("GreaterThanOrEqualTo").addTransition("GreaterThan").addTransition("LessThanOrEqualTo").addTransition("LessThan").addTransition("Add").addTransition("UnaryMinus").addTransition("Minus").addTransition("Exponent").addTransition("Multiply").addTransition("Divide").addTransition("Modulo").addTransition("And").addTransition("Or").addTransition("Xor").addTransition("Not").addTransition("Variable").addTransition("Comma").addTransition("True").addTransition("False").addTransition("Null").addTransition("Identifier").addTextRule("Text","base")}}},module.exports=exports.default},958:(module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,exports.default={Whitespace:null,Indent:null,Dedent:null,EndOfLine:/\n/,EndOfInput:null,Number:/-?[0-9]+(\.[0-9+])?/,String:/"([^"\\]*(?:\\.[^"\\]*)*)"|'([^'\\]*(?:\\.[^'\\]*)*)'/,BeginCommand:/<</,EndCommand:/>>/,Variable:/\$([A-Za-z0-9_.])+/,ShortcutOption:/->/,Hashtag:/#([^(\s|#|//)]+)/,Comment:/\/\/.*/,OptionStart:/\[\[/,OptionDelimit:/\|/,OptionEnd:/\]\]/,If:/if(?!\w)/,ElseIf:/elseif(?!\w)/,Else:/else(?!\w)/,EndIf:/endif(?!\w)/,Jump:/jump(?!\w)/,Stop:/stop(?!\w)/,Set:/set(?!\w)/,Declare:/declare(?!\w)/,As:/as(?!\w)/,ExplicitType:/(String|Number|Bool)(?=>>)/,True:/true(?!\w)/,False:/false(?!\w)/,Null:/null(?!\w)/,LeftParen:/\(/,RightParen:/\)/,Comma:/,/,UnaryMinus:/-(?!\s)/,EqualTo:/(==|is(?!\w)|eq(?!\w))/,GreaterThan:/(>|gt(?!\w))/,GreaterThanOrEqualTo:/(>=|gte(?!\w))/,LessThan:/(<|lt(?!\w))/,LessThanOrEqualTo:/(<=|lte(?!\w))/,NotEqualTo:/(!=|neq(?!\w))/,Or:/(\|\||or(?!\w))/,And:/(&&|and(?!\w))/,Xor:/(\^|xor(?!\w))/,Not:/(!|not(?!\w))/,EqualToOrAssign:/(=|to(?!\w))/,Add:/\+/,Minus:/-/,Exponent:/\*\*/,Multiply:/\*/,Divide:/\//,Modulo:/%/,AddAssign:/\+=/,MinusAssign:/-=/,MultiplyAssign:/\*=/,DivideAssign:/\/=/,Identifier:/[a-zA-Z0-9_:.]+/,EscapedCharacter:/\\./,Text:/[^\\]/,BeginInlineExp:/{/,EndInlineExp:/}/},module.exports=exports.default},358:(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.Parser=Parser,exports.parser=void 0;var o=function(k,v,o,l){for(o=o||{},l=k.length;l--;o[k[l]]=v);return o},$V0=[1,6],$V1=[1,17],$V2=[1,18],$V3=[1,13],$V4=[1,20],$V5=[1,19],$V6=[5,8,18,19,23,34,36,77],$V7=[1,24],$V8=[5,18,19,23,34,36,77],$V9=[1,25],$Va=[1,27],$Vb=[1,28],$Vc=[5,8,9,18,19,21,23,34,36,77],$Vd=[1,32],$Ve=[1,36],$Vf=[1,37],$Vg=[1,38],$Vh=[1,39],$Vi=[5,8,9,18,19,21,23,26,34,36,77],$Vj=[1,52],$Vk=[1,51],$Vl=[1,46],$Vm=[1,47],$Vn=[1,48],$Vo=[1,53],$Vp=[1,54],$Vq=[1,55],$Vr=[1,56],$Vs=[1,57],$Vt=[5,8,9,18,19,23,34,36,77],$Vu=[1,73],$Vv=[1,74],$Vw=[1,75],$Vx=[1,76],$Vy=[1,77],$Vz=[1,78],$VA=[1,79],$VB=[1,80],$VC=[1,81],$VD=[1,82],$VE=[1,83],$VF=[1,84],$VG=[1,85],$VH=[1,86],$VI=[1,87],$VJ=[26,46,51,53,54,55,56,57,58,60,61,62,63,64,65,66,67,68,70,78],$VK=[26,46,51,53,54,55,56,57,60,61,62,63,64,65,66,67,68,70,78],$VL=[26,46,51,70,78],$VM=[1,124],$VN=[1,125],$VO=[26,46,51,53,54,60,61,62,63,64,65,66,67,68,70,78],$VP=[26,46,51,60,61,62,63,64,65,66,67,68,70,78],$VQ=[51,70],$VR=[8,9,18,19,23,34,77],parser=exports.parser={trace:function(){},yy:{},symbols_:{error:2,node:3,statements:4,EndOfInput:5,conditionalBlock:6,statement:7,Comment:8,EndOfLine:9,text:10,shortcut:11,genericCommand:12,assignmentCommand:13,jumpCommand:14,stopCommand:15,hashtags:16,textNode:17,Text:18,EscapedCharacter:19,inlineExpression:20,Hashtag:21,conditional:22,BeginCommand:23,If:24,expression:25,EndCommand:26,EndIf:27,additionalConditionalBlocks:28,else:29,Else:30,elseif:31,ElseIf:32,shortcutOption:33,ShortcutOption:34,Indent:35,Dedent:36,Jump:37,Identifier:38,Stop:39,setCommandInner:40,declareCommandInner:41,Set:42,Variable:43,EqualToOrAssign:44,Declare:45,As:46,ExplicitType:47,functionArgument:48,functionCall:49,LeftParen:50,RightParen:51,UnaryMinus:52,Add:53,Minus:54,Exponent:55,Multiply:56,Divide:57,Modulo:58,Not:59,Or:60,And:61,Xor:62,EqualTo:63,NotEqualTo:64,GreaterThan:65,GreaterThanOrEqualTo:66,LessThan:67,LessThanOrEqualTo:68,parenExpressionArgs:69,Comma:70,literal:71,True:72,False:73,Number:74,String:75,Null:76,BeginInlineExp:77,EndInlineExp:78,$accept:0,$end:1},terminals_:{2:"error",5:"EndOfInput",8:"Comment",9:"EndOfLine",18:"Text",19:"EscapedCharacter",21:"Hashtag",23:"BeginCommand",24:"If",26:"EndCommand",27:"EndIf",30:"Else",32:"ElseIf",34:"ShortcutOption",35:"Indent",36:"Dedent",37:"Jump",38:"Identifier",39:"Stop",42:"Set",43:"Variable",44:"EqualToOrAssign",45:"Declare",46:"As",47:"ExplicitType",50:"LeftParen",51:"RightParen",52:"UnaryMinus",53:"Add",54:"Minus",55:"Exponent",56:"Multiply",57:"Divide",58:"Modulo",59:"Not",60:"Or",61:"And",62:"Xor",63:"EqualTo",64:"NotEqualTo",65:"GreaterThan",66:"GreaterThanOrEqualTo",67:"LessThan",68:"LessThanOrEqualTo",70:"Comma",72:"True",73:"False",74:"Number",75:"String",76:"Null",77:"BeginInlineExp",78:"EndInlineExp"},productions_:[0,[3,2],[4,1],[4,2],[4,1],[4,2],[7,2],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,2],[7,2],[7,2],[17,1],[17,1],[10,1],[10,1],[10,2],[16,1],[16,2],[22,4],[6,6],[6,4],[6,2],[29,3],[29,2],[31,4],[31,2],[28,5],[28,5],[28,3],[33,2],[33,3],[33,2],[33,2],[33,3],[33,2],[11,1],[11,5],[12,3],[14,4],[14,4],[15,3],[13,3],[13,3],[40,4],[41,4],[41,6],[25,1],[25,1],[25,3],[25,2],[25,3],[25,3],[25,3],[25,3],[25,3],[25,3],[25,2],[25,3],[25,3],[25,3],[25,3],[25,3],[25,3],[25,3],[25,3],[25,3],[49,3],[49,4],[69,3],[69,1],[48,1],[48,1],[48,1],[71,1],[71,1],[71,1],[71,1],[71,1],[20,3]],performAction:function(yytext,yyleng,yylineno,yy,yystate,$$,_$){var $0=$$.length-1;switch(yystate){case 1:return $$[$0-1].flat();case 2:case 4:case 8:case 9:case 10:case 11:case 12:case 18:case 19:case 74:this.$=[$$[$0]];break;case 3:case 20:this.$=$$[$0-1].concat($$[$0]);break;case 5:this.$=$$[$0-1].concat([$$[$0]]);break;case 6:case 27:case 28:this.$=void 0;break;case 7:case 52:case 51:case 75:case 76:this.$=$$[$0];break;case 13:case 15:case 26:case 29:case 30:case 46:case 53:case 23:case 37:case 39:this.$=$$[$0-1];break;case 14:this.$=$$[$0-1].map((s=>Object.assign(s,{hashtags:$$[$0]})));break;case 16:this.$=new yy.TextNode($$[$0],this._$);break;case 17:this.$=new yy.EscapedCharacterNode($$[$0],this._$);break;case 21:this.$=[$$[$0].substring(1)];break;case 22:this.$=[$$[$0-1].substring(1)].concat($$[$0]);break;case 24:this.$=new yy.IfNode($$[$0-5],$$[$0-3].flat());break;case 25:this.$=new yy.IfElseNode($$[$0-3],$$[$0-1].flat(),$$[$0]);break;case 31:this.$=new yy.ElseNode($$[$0-3].flat());break;case 32:this.$=new yy.ElseIfNode($$[$0-4],$$[$0-3].flat());break;case 33:this.$=new yy.ElseIfNode($$[$0-2],$$[$0-1].flat(),$$[$0]);break;case 34:this.$={text:$$[$0]};break;case 35:this.$={text:$$[$0-1],conditional:$$[$0]};break;case 36:this.$={...$$[$0-1],hashtags:$$[$0]};break;case 38:this.$={...$$[$0-2],hashtags:$$[$0-1]};break;case 40:this.$=new yy.DialogShortcutNode($$[$0].text,void 0,this._$,$$[$0].hashtags,$$[$0].conditional);break;case 41:this.$=new yy.DialogShortcutNode($$[$0-4].text,$$[$0-1].flat(),this._$,$$[$0-4].hashtags,$$[$0-4].conditional);break;case 42:this.$=new yy.GenericCommandNode($$[$0-1],this._$);break;case 43:case 44:this.$=new yy.JumpCommandNode($$[$0-1]);break;case 45:this.$=new yy.StopCommandNode;break;case 47:this.$=null;break;case 48:this.$=new yy.SetVariableEqualToNode($$[$0-2].substring(1),$$[$0]);break;case 49:this.$=null,yy.registerDeclaration($$[$0-2].substring(1),$$[$0]);break;case 50:this.$=null,yy.registerDeclaration($$[$0-4].substring(1),$$[$0-2],$$[$0]);break;case 54:this.$=new yy.UnaryMinusExpressionNode($$[$0]);break;case 55:this.$=new yy.ArithmeticExpressionAddNode($$[$0-2],$$[$0]);break;case 56:this.$=new yy.ArithmeticExpressionMinusNode($$[$0-2],$$[$0]);break;case 57:this.$=new yy.ArithmeticExpressionExponentNode($$[$0-2],$$[$0]);break;case 58:this.$=new yy.ArithmeticExpressionMultiplyNode($$[$0-2],$$[$0]);break;case 59:this.$=new yy.ArithmeticExpressionDivideNode($$[$0-2],$$[$0]);break;case 60:this.$=new yy.ArithmeticExpressionModuloNode($$[$0-2],$$[$0]);break;case 61:this.$=new yy.NegatedBooleanExpressionNode($$[$0]);break;case 62:this.$=new yy.BooleanOrExpressionNode($$[$0-2],$$[$0]);break;case 63:this.$=new yy.BooleanAndExpressionNode($$[$0-2],$$[$0]);break;case 64:this.$=new yy.BooleanXorExpressionNode($$[$0-2],$$[$0]);break;case 65:this.$=new yy.EqualToExpressionNode($$[$0-2],$$[$0]);break;case 66:this.$=new yy.NotEqualToExpressionNode($$[$0-2],$$[$0]);break;case 67:this.$=new yy.GreaterThanExpressionNode($$[$0-2],$$[$0]);break;case 68:this.$=new yy.GreaterThanOrEqualToExpressionNode($$[$0-2],$$[$0]);break;case 69:this.$=new yy.LessThanExpressionNode($$[$0-2],$$[$0]);break;case 70:this.$=new yy.LessThanOrEqualToExpressionNode($$[$0-2],$$[$0]);break;case 71:this.$=new yy.FunctionCallNode($$[$0-2],[],this._$);break;case 72:this.$=new yy.FunctionCallNode($$[$0-3],$$[$0-1],this._$);break;case 73:this.$=$$[$0-2].concat([$$[$0]]);break;case 77:this.$=new yy.VariableNode($$[$0].substring(1));break;case 78:case 79:this.$=new yy.BooleanLiteralNode($$[$0]);break;case 80:this.$=new yy.NumericLiteralNode($$[$0]);break;case 81:this.$=new yy.StringLiteralNode($$[$0]);break;case 82:this.$=new yy.NullLiteralNode($$[$0]);break;case 83:this.$=new yy.InlineExpressionNode($$[$0-1],this._$)}},table:[{3:1,4:2,6:3,7:4,8:$V0,10:7,11:8,12:9,13:10,14:11,15:12,17:14,18:$V1,19:$V2,20:15,22:5,23:$V3,33:16,34:$V4,77:$V5},{1:[3]},{5:[1,21],6:22,7:23,8:$V0,10:7,11:8,12:9,13:10,14:11,15:12,17:14,18:$V1,19:$V2,20:15,22:5,23:$V3,33:16,34:$V4,77:$V5},o($V6,[2,2],{9:$V7}),o($V8,[2,4],{16:26,8:$V9,9:$Va,21:$Vb}),{9:[1,29]},{9:[1,30]},o([5,8,9,21,23,34,36],[2,7],{17:14,20:15,10:31,18:$V1,19:$V2,77:$V5}),o($Vc,[2,8]),o($Vc,[2,9]),o($Vc,[2,10]),o($Vc,[2,11]),o($Vc,[2,12]),{10:33,17:14,18:$V1,19:$V2,20:15,24:$Vd,37:$Ve,39:$Vf,40:34,41:35,42:$Vg,45:$Vh,77:$V5},o($Vi,[2,18]),o($Vi,[2,19]),o($V8,[2,40],{16:41,8:[1,42],9:[1,40],21:$Vb}),o($Vi,[2,16]),o($Vi,[2,17]),{20:49,25:43,38:$Vj,43:$Vk,48:44,49:45,50:$Vl,52:$Vm,59:$Vn,71:50,72:$Vo,73:$Vp,74:$Vq,75:$Vr,76:$Vs,77:$V5},{10:58,17:14,18:$V1,19:$V2,20:15,77:$V5},{1:[2,1]},o($V6,[2,3],{9:$V7}),o($V8,[2,5],{16:26,8:$V9,9:$Va,21:$Vb}),o($Vt,[2,26]),o($Vc,[2,13]),o($Vc,[2,14]),o($Vc,[2,15]),o($Vt,[2,21],{16:59,21:$Vb}),{4:60,6:3,7:4,8:$V0,10:7,11:8,12:9,13:10,14:11,15:12,17:14,18:$V1,19:$V2,20:15,22:5,23:$V3,33:16,34:$V4,77:$V5},o($Vc,[2,6]),o([5,8,9,21,23,26,34,36],[2,20],{17:14,20:15,10:31,18:$V1,19:$V2,77:$V5}),{20:49,25:61,38:$Vj,43:$Vk,48:44,49:45,50:$Vl,52:$Vm,59:$Vn,71:50,72:$Vo,73:$Vp,74:$Vq,75:$Vr,76:$Vs,77:$V5},{10:31,17:14,18:$V1,19:$V2,20:15,26:[1,62],77:$V5},{26:[1,63]},{26:[1,64]},{20:66,38:[1,65],77:$V5},{26:[1,67]},{43:[1,68]},{43:[1,69]},o($Vc,[2,39],{35:[1,70]}),o([5,9,18,19,21,23,34,36,77],[2,36],{8:[1,71]}),o($Vc,[2,37]),{53:$Vu,54:$Vv,55:$Vw,56:$Vx,57:$Vy,58:$Vz,60:$VA,61:$VB,62:$VC,63:$VD,64:$VE,65:$VF,66:$VG,67:$VH,68:$VI,78:[1,72]},o($VJ,[2,51]),o($VJ,[2,52]),{20:49,25:88,38:$Vj,43:$Vk,48:44,49:45,50:$Vl,52:$Vm,59:$Vn,71:50,72:$Vo,73:$Vp,74:$Vq,75:$Vr,76:$Vs,77:$V5},{20:49,25:89,38:$Vj,43:$Vk,48:44,49:45,50:$Vl,52:$Vm,59:$Vn,71:50,72:$Vo,73:$Vp,74:$Vq,75:$Vr,76:$Vs,77:$V5},{20:49,25:90,38:$Vj,43:$Vk,48:44,49:45,50:$Vl,52:$Vm,59:$Vn,71:50,72:$Vo,73:$Vp,74:$Vq,75:$Vr,76:$Vs,77:$V5},o($VJ,[2,75]),o($VJ,[2,76]),o($VJ,[2,77]),{50:[1,91]},o($VJ,[2,78]),o($VJ,[2,79]),o($VJ,[2,80]),o($VJ,[2,81]),o($VJ,[2,82]),o([5,8,9,21,34,36],[2,34],{17:14,20:15,10:31,22:92,18:$V1,19:$V2,23:[1,93],77:$V5}),o($Vc,[2,22]),{6:22,7:23,8:$V0,10:7,11:8,12:9,13:10,14:11,15:12,17:14,18:$V1,19:$V2,20:15,22:5,23:[1,94],28:95,29:96,31:97,33:16,34:$V4,77:$V5},{26:[1,98],53:$Vu,54:$Vv,55:$Vw,56:$Vx,57:$Vy,58:$Vz,60:$VA,61:$VB,62:$VC,63:$VD,64:$VE,65:$VF,66:$VG,67:$VH,68:$VI},o($Vc,[2,42]),o($Vc,[2,46]),o($Vc,[2,47]),{26:[1,99]},{26:[1,100]},o($Vc,[2,45]),{44:[1,101]},{44:[1,102]},{4:103,6:3,7:4,8:$V0,10:7,11:8,12:9,13:10,14:11,15:12,17:14,18:$V1,19:$V2,20:15,22:5,23:$V3,33:16,34:$V4,77:$V5},o($Vc,[2,38]),o([5,8,9,18,19,21,23,26,34,36,46,51,53,54,55,56,57,58,60,61,62,63,64,65,66,67,68,70,77,78],[2,83]),{20:49,25:104,38:$Vj,43:$Vk,48:44,49:45,50:$Vl,52:$Vm,59:$Vn,71:50,72:$Vo,73:$Vp,74:$Vq,75:$Vr,76:$Vs,77:$V5},{20:49,25:105,38:$Vj,43:$Vk,48:44,49:45,50:$Vl,52:$Vm,59:$Vn,71:50,72:$Vo,73:$Vp,74:$Vq,75:$Vr,76:$Vs,77:$V5},{20:49,25:106,38:$Vj,43:$Vk,48:44,49:45,50:$Vl,52:$Vm,59:$Vn,71:50,72:$Vo,73:$Vp,74:$Vq,75:$Vr,76:$Vs,77:$V5},{20:49,25:107,38:$Vj,43:$Vk,48:44,49:45,50:$Vl,52:$Vm,59:$Vn,71:50,72:$Vo,73:$Vp,74:$Vq,75:$Vr,76:$Vs,77:$V5},{20:49,25:108,38:$Vj,43:$Vk,48:44,49:45,50:$Vl,52:$Vm,59:$Vn,71:50,72:$Vo,73:$Vp,74:$Vq,75:$Vr,76:$Vs,77:$V5},{20:49,25:109,38:$Vj,43:$Vk,48:44,49:45,50:$Vl,52:$Vm,59:$Vn,71:50,72:$Vo,73:$Vp,74:$Vq,75:$Vr,76:$Vs,77:$V5},{20:49,25:110,38:$Vj,43:$Vk,48:44,49:45,50:$Vl,52:$Vm,59:$Vn,71:50,72:$Vo,73:$Vp,74:$Vq,75:$Vr,76:$Vs,77:$V5},{20:49,25:111,38:$Vj,43:$Vk,48:44,49:45,50:$Vl,52:$Vm,59:$Vn,71:50,72:$Vo,73:$Vp,74:$Vq,75:$Vr,76:$Vs,77:$V5},{20:49,25:112,38:$Vj,43:$Vk,48:44,49:45,50:$Vl,52:$Vm,59:$Vn,71:50,72:$Vo,73:$Vp,74:$Vq,75:$Vr,76:$Vs,77:$V5},{20:49,25:113,38:$Vj,43:$Vk,48:44,49:45,50:$Vl,52:$Vm,59:$Vn,71:50,72:$Vo,73:$Vp,74:$Vq,75:$Vr,76:$Vs,77:$V5},{20:49,25:114,38:$Vj,43:$Vk,48:44,49:45,50:$Vl,52:$Vm,59:$Vn,71:50,72:$Vo,73:$Vp,74:$Vq,75:$Vr,76:$Vs,77:$V5},{20:49,25:115,38:$Vj,43:$Vk,48:44,49:45,50:$Vl,52:$Vm,59:$Vn,71:50,72:$Vo,73:$Vp,74:$Vq,75:$Vr,76:$Vs,77:$V5},{20:49,25:116,38:$Vj,43:$Vk,48:44,49:45,50:$Vl,52:$Vm,59:$Vn,71:50,72:$Vo,73:$Vp,74:$Vq,75:$Vr,76:$Vs,77:$V5},{20:49,25:117,38:$Vj,43:$Vk,48:44,49:45,50:$Vl,52:$Vm,59:$Vn,71:50,72:$Vo,73:$Vp,74:$Vq,75:$Vr,76:$Vs,77:$V5},{20:49,25:118,38:$Vj,43:$Vk,48:44,49:45,50:$Vl,52:$Vm,59:$Vn,71:50,72:$Vo,73:$Vp,74:$Vq,75:$Vr,76:$Vs,77:$V5},{51:[1,119],53:$Vu,54:$Vv,55:$Vw,56:$Vx,57:$Vy,58:$Vz,60:$VA,61:$VB,62:$VC,63:$VD,64:$VE,65:$VF,66:$VG,67:$VH,68:$VI},o($VK,[2,54],{58:$Vz}),o($VL,[2,61],{53:$Vu,54:$Vv,55:$Vw,56:$Vx,57:$Vy,58:$Vz,60:$VA,61:$VB,62:$VC,63:$VD,64:$VE,65:$VF,66:$VG,67:$VH,68:$VI}),{20:49,25:122,38:$Vj,43:$Vk,48:44,49:45,50:$Vl,51:[1,120],52:$Vm,59:$Vn,69:121,71:50,72:$Vo,73:$Vp,74:$Vq,75:$Vr,76:$Vs,77:$V5},o($Vc,[2,35]),{24:$Vd},{10:33,17:14,18:$V1,19:$V2,20:15,24:$Vd,27:[1,123],30:$VM,32:$VN,37:$Ve,39:$Vf,40:34,41:35,42:$Vg,45:$Vh,77:$V5},o($Vt,[2,25]),{4:126,6:3,7:4,8:$V0,9:[1,127],10:7,11:8,12:9,13:10,14:11,15:12,17:14,18:$V1,19:$V2,20:15,22:5,23:$V3,33:16,34:$V4,77:$V5},{4:128,6:3,7:4,8:$V0,9:[1,129],10:7,11:8,12:9,13:10,14:11,15:12,17:14,18:$V1,19:$V2,20:15,22:5,23:$V3,33:16,34:$V4,77:$V5},o($Vc,[2,23]),o($Vc,[2,43]),o($Vc,[2,44]),{20:49,25:130,38:$Vj,43:$Vk,48:44,49:45,50:$Vl,52:$Vm,59:$Vn,71:50,72:$Vo,73:$Vp,74:$Vq,75:$Vr,76:$Vs,77:$V5},{20:49,25:131,38:$Vj,43:$Vk,48:44,49:45,50:$Vl,52:$Vm,59:$Vn,71:50,72:$Vo,73:$Vp,74:$Vq,75:$Vr,76:$Vs,77:$V5},{6:22,7:23,8:$V0,10:7,11:8,12:9,13:10,14:11,15:12,17:14,18:$V1,19:$V2,20:15,22:5,23:$V3,33:16,34:$V4,36:[1,132],77:$V5},o($VO,[2,55],{55:$Vw,56:$Vx,57:$Vy,58:$Vz}),o($VO,[2,56],{55:$Vw,56:$Vx,57:$Vy,58:$Vz}),o($VK,[2,57],{58:$Vz}),o($VK,[2,58],{58:$Vz}),o($VK,[2,59],{58:$Vz}),o($VL,[2,60],{53:$Vu,54:$Vv,55:$Vw,56:$Vx,57:$Vy,58:$Vz,60:$VA,61:$VB,62:$VC,63:$VD,64:$VE,65:$VF,66:$VG,67:$VH,68:$VI}),o([26,46,51,60,70,78],[2,62],{53:$Vu,54:$Vv,55:$Vw,56:$Vx,57:$Vy,58:$Vz,61:$VB,62:$VC,63:$VD,64:$VE,65:$VF,66:$VG,67:$VH,68:$VI}),o([26,46,51,60,61,70,78],[2,63],{53:$Vu,54:$Vv,55:$Vw,56:$Vx,57:$Vy,58:$Vz,62:$VC,63:$VD,64:$VE,65:$VF,66:$VG,67:$VH,68:$VI}),o([26,46,51,60,61,62,70,78],[2,64],{53:$Vu,54:$Vv,55:$Vw,56:$Vx,57:$Vy,58:$Vz,63:$VD,64:$VE,65:$VF,66:$VG,67:$VH,68:$VI}),o($VP,[2,65],{53:$Vu,54:$Vv,55:$Vw,56:$Vx,57:$Vy,58:$Vz}),o($VP,[2,66],{53:$Vu,54:$Vv,55:$Vw,56:$Vx,57:$Vy,58:$Vz}),o($VP,[2,67],{53:$Vu,54:$Vv,55:$Vw,56:$Vx,57:$Vy,58:$Vz}),o($VP,[2,68],{53:$Vu,54:$Vv,55:$Vw,56:$Vx,57:$Vy,58:$Vz}),o($VP,[2,69],{53:$Vu,54:$Vv,55:$Vw,56:$Vx,57:$Vy,58:$Vz}),o($VP,[2,70],{53:$Vu,54:$Vv,55:$Vw,56:$Vx,57:$Vy,58:$Vz}),o($VJ,[2,53]),o($VJ,[2,71]),{51:[1,133],70:[1,134]},o($VQ,[2,74],{53:$Vu,54:$Vv,55:$Vw,56:$Vx,57:$Vy,58:$Vz,60:$VA,61:$VB,62:$VC,63:$VD,64:$VE,65:$VF,66:$VG,67:$VH,68:$VI}),{26:[1,135]},{26:[1,136]},{20:49,25:137,38:$Vj,43:$Vk,48:44,49:45,50:$Vl,52:$Vm,59:$Vn,71:50,72:$Vo,73:$Vp,74:$Vq,75:$Vr,76:$Vs,77:$V5},{6:22,7:23,8:$V0,10:7,11:8,12:9,13:10,14:11,15:12,17:14,18:$V1,19:$V2,20:15,22:5,23:[1,138],33:16,34:$V4,77:$V5},o($VR,[2,28]),{6:22,7:23,8:$V0,10:7,11:8,12:9,13:10,14:11,15:12,17:14,18:$V1,19:$V2,20:15,22:5,23:[1,139],28:140,29:96,31:97,33:16,34:$V4,77:$V5},o($VR,[2,30]),{26:[2,48],53:$Vu,54:$Vv,55:$Vw,56:$Vx,57:$Vy,58:$Vz,60:$VA,61:$VB,62:$VC,63:$VD,64:$VE,65:$VF,66:$VG,67:$VH,68:$VI},{26:[2,49],46:[1,141],53:$Vu,54:$Vv,55:$Vw,56:$Vx,57:$Vy,58:$Vz,60:$VA,61:$VB,62:$VC,63:$VD,64:$VE,65:$VF,66:$VG,67:$VH,68:$VI},o($Vc,[2,41]),o($VJ,[2,72]),{20:49,25:142,38:$Vj,43:$Vk,48:44,49:45,50:$Vl,52:$Vm,59:$Vn,71:50,72:$Vo,73:$Vp,74:$Vq,75:$Vr,76:$Vs,77:$V5},o($Vt,[2,24]),o($VR,[2,27]),{26:[1,143],53:$Vu,54:$Vv,55:$Vw,56:$Vx,57:$Vy,58:$Vz,60:$VA,61:$VB,62:$VC,63:$VD,64:$VE,65:$VF,66:$VG,67:$VH,68:$VI},{10:33,17:14,18:$V1,19:$V2,20:15,24:$Vd,27:[1,144],37:$Ve,39:$Vf,40:34,41:35,42:$Vg,45:$Vh,77:$V5},{10:33,17:14,18:$V1,19:$V2,20:15,24:$Vd,27:[1,145],30:$VM,32:$VN,37:$Ve,39:$Vf,40:34,41:35,42:$Vg,45:$Vh,77:$V5},o($Vt,[2,33]),{47:[1,146]},o($VQ,[2,73],{53:$Vu,54:$Vv,55:$Vw,56:$Vx,57:$Vy,58:$Vz,60:$VA,61:$VB,62:$VC,63:$VD,64:$VE,65:$VF,66:$VG,67:$VH,68:$VI}),o($VR,[2,29]),{26:[1,147]},{26:[1,148]},{26:[2,50]},o($Vt,[2,31]),o($Vt,[2,32])],defaultActions:{21:[2,1],146:[2,50]},parseError:function(str,hash){if(!hash.recoverable){var error=new Error(str);throw error.hash=hash,error}this.trace(str)},parse:function(input){var self=this,stack=[0],vstack=[null],lstack=[],table=this.table,yytext="",yylineno=0,yyleng=0,recovering=0,TERROR=2,EOF=1,args=lstack.slice.call(arguments,1),lexer=Object.create(this.lexer),sharedState={yy:{}};for(var k in this.yy)Object.prototype.hasOwnProperty.call(this.yy,k)&&(sharedState.yy[k]=this.yy[k]);lexer.setInput(input,sharedState.yy),sharedState.yy.lexer=lexer,sharedState.yy.parser=this,void 0===lexer.yylloc&&(lexer.yylloc={});var yyloc=lexer.yylloc;lstack.push(yyloc);var ranges=lexer.options&&lexer.options.ranges;"function"==typeof sharedState.yy.parseError?this.parseError=sharedState.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var symbol,preErrorSymbol,state,action,r,p,len,newState,expected,lex=function(){var token;return"number"!=typeof(token=lexer.lex()||EOF)&&(token=self.symbols_[token]||token),token},yyval={};;){if(state=stack[stack.length-1],this.defaultActions[state]?action=this.defaultActions[state]:(null==symbol&&(symbol=lex()),action=table[state]&&table[state][symbol]),void 0===action||!action.length||!action[0]){var errStr="";for(p in expected=[],table[state])this.terminals_[p]&&p>TERROR&&expected.push("'"+this.terminals_[p]+"'");errStr=lexer.showPosition?"Parse error on line "+(yylineno+1)+":\n"+lexer.showPosition()+"\nExpecting "+expected.join(", ")+", got '"+(this.terminals_[symbol]||symbol)+"'":"Parse error on line "+(yylineno+1)+": Unexpected "+(symbol==EOF?"end of input":"'"+(this.terminals_[symbol]||symbol)+"'"),this.parseError(errStr,{text:lexer.match,token:this.terminals_[symbol]||symbol,line:lexer.yylineno,loc:yyloc,expected:expected})}if(action[0]instanceof Array&&action.length>1)throw new Error("Parse Error: multiple actions possible at state: "+state+", token: "+symbol);switch(action[0]){case 1:stack.push(symbol),vstack.push(lexer.yytext),lstack.push(lexer.yylloc),stack.push(action[1]),symbol=null,preErrorSymbol?(symbol=preErrorSymbol,preErrorSymbol=null):(yyleng=lexer.yyleng,yytext=lexer.yytext,yylineno=lexer.yylineno,yyloc=lexer.yylloc,recovering>0&&recovering--);break;case 2:if(len=this.productions_[action[1]][1],yyval.$=vstack[vstack.length-len],yyval._$={first_line:lstack[lstack.length-(len||1)].first_line,last_line:lstack[lstack.length-1].last_line,first_column:lstack[lstack.length-(len||1)].first_column,last_column:lstack[lstack.length-1].last_column},ranges&&(yyval._$.range=[lstack[lstack.length-(len||1)].range[0],lstack[lstack.length-1].range[1]]),void 0!==(r=this.performAction.apply(yyval,[yytext,yyleng,yylineno,sharedState.yy,action[1],vstack,lstack].concat(args))))return r;len&&(stack=stack.slice(0,-1*len*2),vstack=vstack.slice(0,-1*len),lstack=lstack.slice(0,-1*len)),stack.push(this.productions_[action[1]][0]),vstack.push(yyval.$),lstack.push(yyval._$),newState=table[stack[stack.length-2]][stack[stack.length-1]],stack.push(newState);break;case 3:return!0}}return!0}};function Parser(){this.yy={}}Parser.prototype=parser,parser.Parser=Parser},950:(module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;class Text{}class Shortcut{}class Conditional{}class Assignment{}class Literal{}class Expression{}class FunctionCall{}class Command{}exports.default={types:{Text:Text,Shortcut:Shortcut,Conditional:Conditional,Assignment:Assignment,Literal:Literal,Expression:Expression,FunctionCall:FunctionCall,Command:Command},DialogShortcutNode:class extends Shortcut{constructor(text,content,lineNo){let hashtags=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],conditionalExpression=arguments.length>4?arguments[4]:void 0;super(),this.type="DialogShortcutNode",this.text=text,this.content=content,this.lineNum=lineNo.first_line,this.hashtags=hashtags,this.conditionalExpression=conditionalExpression}},IfNode:class extends Conditional{constructor(expression,statement){super(),this.type="IfNode",this.expression=expression,this.statement=statement}},IfElseNode:class extends Conditional{constructor(expression,statement,elseStatement){super(),this.type="IfElseNode",this.expression=expression,this.statement=statement,this.elseStatement=elseStatement}},ElseNode:class extends Conditional{constructor(statement){super(),this.type="ElseNode",this.statement=statement}},ElseIfNode:class extends Conditional{constructor(expression,statement,elseStatement){super(),this.type="ElseIfNode",this.expression=expression,this.statement=statement,this.elseStatement=elseStatement}},GenericCommandNode:class extends Command{constructor(command,lineNo){let hashtags=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];super(),this.type="GenericCommandNode",this.command=command,this.hashtags=hashtags,this.lineNum=lineNo.first_line}},JumpCommandNode:class extends Command{constructor(destination){super(),this.type="JumpCommandNode",this.destination=destination}},StopCommandNode:class extends Command{constructor(){super(),this.type="StopCommandNode"}},TextNode:class extends Text{constructor(text,lineNo){let hashtags=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];super(),this.type="TextNode",this.text=text,this.lineNum=lineNo.first_line,this.hashtags=hashtags}},EscapedCharacterNode:class extends Text{constructor(text,lineNo){let hashtags=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];super(),this.type="EscapedCharacterNode",this.text=text,this.lineNum=lineNo.first_line,this.hashtags=hashtags}},NumericLiteralNode:class extends Literal{constructor(numericLiteral){super(),this.type="NumericLiteralNode",this.numericLiteral=numericLiteral}},StringLiteralNode:class extends Literal{constructor(stringLiteral){super(),this.type="StringLiteralNode",this.stringLiteral=stringLiteral.substring(1,stringLiteral.length-1).replace(/\\(.)/g,"$1")}},BooleanLiteralNode:class extends Literal{constructor(booleanLiteral){super(),this.type="BooleanLiteralNode",this.booleanLiteral=booleanLiteral}},VariableNode:class extends Literal{constructor(variableName){super(),this.type="VariableNode",this.variableName=variableName}},UnaryMinusExpressionNode:class extends Expression{constructor(expression){super(),this.type="UnaryMinusExpressionNode",this.expression=expression}},ArithmeticExpressionAddNode:class extends Expression{constructor(expression1,expression2){super(),this.type="ArithmeticExpressionAddNode",this.expression1=expression1,this.expression2=expression2}},ArithmeticExpressionMinusNode:class extends Expression{constructor(expression1,expression2){super(),this.type="ArithmeticExpressionMinusNode",this.expression1=expression1,this.expression2=expression2}},ArithmeticExpressionMultiplyNode:class extends Expression{constructor(expression1,expression2){super(),this.type="ArithmeticExpressionMultiplyNode",this.expression1=expression1,this.expression2=expression2}},ArithmeticExpressionExponentNode:class extends Expression{constructor(expression1,expression2){super(),this.type="ArithmeticExpressionExponentNode",this.expression1=expression1,this.expression2=expression2}},ArithmeticExpressionDivideNode:class extends Expression{constructor(expression1,expression2){super(),this.type="ArithmeticExpressionDivideNode",this.expression1=expression1,this.expression2=expression2}},ArithmeticExpressionModuloNode:class extends Expression{constructor(expression1,expression2){super(),this.type="ArithmeticExpressionModuloNode",this.expression1=expression1,this.expression2=expression2}},NegatedBooleanExpressionNode:class extends Expression{constructor(expression){super(),this.type="NegatedBooleanExpressionNode",this.expression=expression}},BooleanOrExpressionNode:class extends Expression{constructor(expression1,expression2){super(),this.type="BooleanOrExpressionNode",this.expression1=expression1,this.expression2=expression2}},BooleanAndExpressionNode:class extends Expression{constructor(expression1,expression2){super(),this.type="BooleanAndExpressionNode",this.expression1=expression1,this.expression2=expression2}},BooleanXorExpressionNode:class extends Expression{constructor(expression1,expression2){super(),this.type="BooleanXorExpressionNode",this.expression1=expression1,this.expression2=expression2}},EqualToExpressionNode:class extends Expression{constructor(expression1,expression2){super(),this.type="EqualToExpressionNode",this.expression1=expression1,this.expression2=expression2}},NotEqualToExpressionNode:class extends Expression{constructor(expression1,expression2){super(),this.type="NotEqualToExpressionNode",this.expression1=expression1,this.expression2=expression2}},GreaterThanExpressionNode:class extends Expression{constructor(expression1,expression2){super(),this.type="GreaterThanExpressionNode",this.expression1=expression1,this.expression2=expression2}},GreaterThanOrEqualToExpressionNode:class extends Expression{constructor(expression1,expression2){super(),this.type="GreaterThanOrEqualToExpressionNode",this.expression1=expression1,this.expression2=expression2}},LessThanExpressionNode:class extends Expression{constructor(expression1,expression2){super(),this.type="LessThanExpressionNode",this.expression1=expression1,this.expression2=expression2}},LessThanOrEqualToExpressionNode:class extends Expression{constructor(expression1,expression2){super(),this.type="LessThanOrEqualToExpressionNode",this.expression1=expression1,this.expression2=expression2}},SetVariableEqualToNode:class extends Assignment{constructor(variableName,expression){super(),this.type="SetVariableEqualToNode",this.variableName=variableName,this.expression=expression}},FunctionCallNode:class extends FunctionCall{constructor(functionName,args,lineNo){let hashtags=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.type="FunctionCallNode",this.functionName=functionName,this.args=args,this.lineNum=lineNo.first_line,this.hashtags=hashtags}},InlineExpressionNode:class extends Expression{constructor(expression,lineNo){let hashtags=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];super(),this.type="InlineExpressionNode",this.expression=expression,this.lineNum=lineNo.first_line,this.hashtags=hashtags}}},module.exports=exports.default},476:(module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _nodes=_interopRequireDefault(__webpack_require__(950)),_lexer=_interopRequireDefault(__webpack_require__(160)),_compiledParser=__webpack_require__(358);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}_compiledParser.parser.lexer=new _lexer.default,_compiledParser.parser.yy=_nodes.default,_compiledParser.parser.yy.declarations={},_compiledParser.parser.yy.parseError=function(e){throw e},_compiledParser.parser.yy.registerDeclaration=function(variableName,expression,explicitType){if(!this.areDeclarationsHandled){if(this.declarations[variableName])throw new Error("Duplicate declaration found for variable: ".concat(variableName));this.declarations[variableName]={variableName:variableName,expression:expression,explicitType:explicitType}}},exports.default=_compiledParser.parser,module.exports=exports.default},377:(module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;class Result{}class OptionResult extends Result{constructor(text){let isAvailable=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],hashtags=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],metadata=arguments.length>3?arguments[3]:void 0;super(),this.text=text,this.isAvailable=isAvailable,this.hashtags=hashtags,this.metadata=metadata}}exports.default={Result:Result,TextResult:class extends Result{constructor(text,hashtags,metadata){super(),this.text=text,this.hashtags=hashtags,this.metadata=metadata}},CommandResult:class extends Result{constructor(command,hashtags,metadata){super(),this.command=command,this.hashtags=hashtags,this.metadata=metadata}},OptionsResult:class extends Result{constructor(options,metadata){super(),this.options=options.map(((s,i)=>{const opt=new OptionResult(s.text,s.isAvailable,s.hashtags);return opt.index=i,opt})),this.metadata=metadata}select(){let index=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;if(index<0||index>=this.options.length)throw new Error("Cannot select option #".concat(index,", there are ").concat(this.options.length," options"));this.selected=index}}},module.exports=exports.default},333:(module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _parser=_interopRequireDefault(__webpack_require__(476)),_results=_interopRequireDefault(__webpack_require__(377)),_defaultVariableStorage=_interopRequireDefault(__webpack_require__(163)),_convertYarnToJs=_interopRequireDefault(__webpack_require__(897)),_nodes2=_interopRequireDefault(__webpack_require__(950));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const nodeTypes=_nodes2.default.types;exports.default={Runner:class{constructor(){this.noEscape=!1,this.lookahead=!1,this.yarnNodes={},this.variables=new _defaultVariableStorage.default,this.functions={}}load(dialogue){if(!dialogue)throw new Error("No dialogue supplied");let nodes;nodes="string"==typeof dialogue?(0,_convertYarnToJs.default)(dialogue):dialogue,nodes.forEach((node=>{if(!node.title)throw new Error("Node needs a title: ".concat(JSON.stringify(node)));if(node.title.split(".").length>1)throw new Error("Node title cannot contain a dot: ".concat(node.title));if(!node.body)throw new Error("Node needs a body: ".concat(JSON.stringify(node)));if(this.yarnNodes[node.title])throw new Error("Duplicate node title: ".concat(node.title));this.yarnNodes[node.title]=node,console.log("Loaded Node:",node.title,"Parsed Nodes (body length):",node.body.length,"Is Array?",Array.isArray(node.body))})),console.log("YarnNodes keys:",Object.keys(this.yarnNodes)),_parser.default.yy.areDeclarationsHandled=!1,_parser.default.yy.declarations={},this.handleDeclarations(nodes),_parser.default.yy.areDeclarationsHandled=!0}setVariableStorage(storage){if("function"!=typeof storage.set||"function"!=typeof storage.get)throw new Error('Variable Storage object must contain both a "set" and "get" function');this.variables=storage}handleDeclarations(nodes){const exampleValues={Number:0,String:"",Boolean:!1},declareLines=nodes.reduce(((acc,node)=>[...acc,...node.body.split(/\r?\n+/)]),[]).reduce(((acc,line)=>line.match(/^<<declare .+>>/)?[...acc,line]:acc),[]);declareLines.length&&_parser.default.parse(declareLines.join("\n")),Object.entries(_parser.default.yy.declarations).forEach((_ref=>{let[variableName,{expression:expression,explicitType:explicitType}]=_ref;const value=this.evaluateExpressionOrLiteral(expression);if(explicitType&&typeof value!=typeof exampleValues[explicitType])throw new Error("Cannot declare value ".concat(value," as type ").concat(explicitType," for variable ").concat(variableName));this.variables.get(variableName)||this.variables.set(variableName,value)}))}registerFunction(name,func){if("function"!=typeof func)throw new Error("Registered function must be...well...a function");this.functions[name]=func}*run(nodeName){const{parserNodes:parserNodes,metadata:metadata}=this.getParserNodes(nodeName);return yield*this.evalNodes(parserNodes,metadata)}getParserNodes(nodeName){const yarnNode=this.yarnNodes[nodeName];if(void 0===yarnNode)throw new Error('Node "'.concat(nodeName,'" does not exist'));const parserNodes=Array.from(_parser.default.parse(yarnNode.body));console.log("Parsed AST Nodes count:",parserNodes.length);const metadata={...yarnNode};return delete metadata.body,{parserNodes:parserNodes,metadata:metadata}}evalNodes(nodes,metadata){var _this=this;let shortcutNodes=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],textRunNodes=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return function*(){const filteredNodes=nodes.filter(Boolean),_textRunNodes=[...textRunNodes],_shortcutNodes=[...shortcutNodes],_nodes=[...nodes],getGeneratorHere=()=>_this.evalNodes(_nodes,metadata,_shortcutNodes,_textRunNodes),node=filteredNodes[0],nextNode=filteredNodes[1];if("TextNode"===node.type||"ExpressionNode"===node.type||"InlineExpressionNode"===node.type){if(textRunNodes.push(node),!nextNode||node.lineNum!==nextNode.lineNum||"TextNode"!==nextNode.type&&"ExpressionNode"!==nextNode.type&&"InlineExpressionNode"!==nextNode.type){const text=textRunNodes.reduce(((acc,node)=>acc+_this.evaluateExpressionOrLiteral(node).toString()),"");textRunNodes=[];const textResult=Object.assign(new _results.default.TextResult(text,node.hashtags,metadata),{getGeneratorHere:getGeneratorHere});yield textResult}}else if("ShortcutNode"===node.type||"DialogShortcutNode"===node.type){if(shortcutNodes.push(node),!nextNode||"ShortcutNode"!==nextNode.type&&"DialogShortcutNode"!==nextNode.type)return yield*_this.handleShortcuts(shortcutNodes,metadata,filteredNodes.slice(1),getGeneratorHere)}else if("SetVariableEqualToNode"===node.type){const varName=node.variableName,isInternal=varName&&(varName.startsWith("$__")||varName.startsWith("__"));_this.lookahead&&!isInternal||_this.evaluateAssignment(node)}else if("IfNode"===node.type||"IfElseNode"===node.type||"ElseIfNode"===node.type||"ElseNode"===node.type){console.log("Conditional Node Type:",node.type);const evalResult=_this.evaluateConditional(node);if(console.log("EvalResult:",evalResult?evalResult.length:"null"),evalResult)return yield*_this.evalNodes([...evalResult,...filteredNodes.slice(1)],metadata,shortcutNodes,textRunNodes)}else{if("JumpCommandNode"===node.type){const destination=node.destination instanceof _nodes2.default.InlineExpressionNode?_this.evaluateExpressionOrLiteral(node.destination):node.destination,{parserNodes:parserNodes,metadata:metadata}=_this.getParserNodes(destination);return yield*_this.evalNodes(parserNodes,metadata)}if("StopCommandNode"===node.type)return void console.log("StopCommandNode hit");if("DeclareCommandNode"===node.type);else{node.command||console.log("Falling through to generic command with node type:",node.type,node);const command=_this.evaluateExpressionOrLiteral(node.command),detourMatch=command&&"string"==typeof command?command.match(/^detour\s+(.+)$/):null;if(detourMatch){const nodeName=detourMatch[1].trim(),detourInfo=_this.getParserNodes(nodeName),marker=new _nodes2.default.GenericCommandNode("__DETOUR_END__",{first_line:node.lineNum}),newNodes=[...detourInfo.parserNodes,marker,...filteredNodes.slice(1)];return yield*_this.evalNodes(newNodes,detourInfo.metadata,shortcutNodes,textRunNodes)}if("return"===command){const markerIndex=filteredNodes.findIndex((n=>"GenericCommandNode"===n.type&&"__DETOUR_END__"===_this.evaluateExpressionOrLiteral(n.command)));return-1!==markerIndex?yield*_this.evalNodes(filteredNodes.slice(markerIndex+1),metadata,shortcutNodes,textRunNodes):void 0}if("__DETOUR_END__"===command)return yield*_this.evalNodes(filteredNodes.slice(1),metadata,shortcutNodes,textRunNodes);{const commandResult=Object.assign(new _results.default.CommandResult(command,node.hashtags,metadata),{getGeneratorHere:getGeneratorHere});yield commandResult}}}if(filteredNodes.length>1)return yield*_this.evalNodes(filteredNodes.slice(1),metadata,shortcutNodes,textRunNodes)}()}*handleShortcuts(selections,metadata,restNodes,getGeneratorHere){const transformedSelections=selections.map((s=>{let isAvailable=!0;s.conditionalExpression&&!this.evaluateExpressionOrLiteral(s.conditionalExpression)&&(isAvailable=!1);const text=this.evaluateExpressionOrLiteral(s.text);return Object.assign(s,{isAvailable:isAvailable,text:text})})),optionsResult=Object.assign(new _results.default.OptionsResult(transformedSelections,metadata),{getGeneratorHere:getGeneratorHere});if(yield optionsResult,"number"!=typeof optionsResult.selected)throw new Error("No option selected before resuming dialogue");const selectedOption=transformedSelections[optionsResult.selected];return selectedOption.content?yield*this.evalNodes([...selectedOption.content,...restNodes],metadata):restNodes.length?yield*this.evalNodes(restNodes,metadata):void 0}evaluateAssignment(node){const result=this.evaluateExpressionOrLiteral(node.expression),oldValue=this.variables.get(node.variableName);if(oldValue&&typeof oldValue!=typeof result)throw new Error("Variable ".concat(node.variableName," is already type ").concat(typeof oldValue,"; cannot set equal to ").concat(result," of type ").concat(typeof result));this.variables.set(node.variableName,result)}evaluateConditional(node){if("IfNode"===node.type){if(this.evaluateExpressionOrLiteral(node.expression))return node.statement}else{if("IfElseNode"!==node.type&&"ElseIfNode"!==node.type)return node.statement;if(this.evaluateExpressionOrLiteral(node.expression))return node.statement;if(node.elseStatement)return this.evaluateConditional(node.elseStatement)}return null}evaluateFunctionCall(node){if(this.functions[node.functionName])return this.functions[node.functionName](...node.args.map(this.evaluateExpressionOrLiteral,this));throw new Error('Function "'.concat(node.functionName,'" not found'))}evaluateExpressionOrLiteral(node){if(Array.isArray(node))return node.reduce(((acc,n)=>acc+this.evaluateExpressionOrLiteral(n).toString()),"");if("object"!=typeof node)return node;const handler={UnaryMinusExpressionNode:a=>-a,ArithmeticExpressionAddNode:(a,b)=>a+b,ArithmeticExpressionMinusNode:(a,b)=>a-b,ArithmeticExpressionExponentNode:(a,b)=>a**b,ArithmeticExpressionMultiplyNode:(a,b)=>a*b,ArithmeticExpressionDivideNode:(a,b)=>a/b,ArithmeticExpressionModuloNode:(a,b)=>a%b,NegatedBooleanExpressionNode:a=>!a,BooleanOrExpressionNode:(a,b)=>a||b,BooleanAndExpressionNode:(a,b)=>a&&b,BooleanXorExpressionNode:(a,b)=>!!(a^b),EqualToExpressionNode:(a,b)=>a===b,NotEqualToExpressionNode:(a,b)=>a!==b,GreaterThanExpressionNode:(a,b)=>a>b,GreaterThanOrEqualToExpressionNode:(a,b)=>a>=b,LessThanExpressionNode:(a,b)=>a<b,LessThanOrEqualToExpressionNode:(a,b)=>a<=b,TextNode:a=>a.text,EscapedCharacterNode:a=>this.noEscape?a.text:a.text.slice(1),NumericLiteralNode:a=>parseFloat(a.numericLiteral),StringLiteralNode:a=>"".concat(a.stringLiteral),BooleanLiteralNode:a=>"true"===a.booleanLiteral,VariableNode:a=>{const value=this.variables.get(a.variableName);if(void 0===value&&!this.lookahead){if(a.variableName.startsWith("$__once_")||a.variableName.startsWith("__once_")||a.variableName.startsWith("$__lg_")||a.variableName.startsWith("__lg_")||a.variableName.startsWith("$__ng_")||a.variableName.startsWith("__ng_"))return!1;throw new Error('Attempted to access undefined variable "'.concat(a.variableName,'"'))}return value},FunctionCallNode:a=>this.evaluateFunctionCall(a),InlineExpressionNode:a=>a}[node.type];if(!handler)throw new Error("node type not recognized: ".concat(node.type));return handler(node instanceof nodeTypes.Expression?this.evaluateExpressionOrLiteral(node.expression||node.expression1):node,node.expression2?this.evaluateExpressionOrLiteral(node.expression2):node)}},TextResult:_results.default.TextResult,CommandResult:_results.default.CommandResult,OptionsResult:_results.default.OptionsResult},module.exports=exports.default},954:(module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _yarnBound=_interopRequireDefault(__webpack_require__(523)),_index=_interopRequireDefault(__webpack_require__(947));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const{OptionsResult:OptionsResult,TextResult:TextResult,CommandResult:CommandResult}=_index.default;_yarnBound.default.OptionsResult=OptionsResult,_yarnBound.default.TextResult=TextResult,_yarnBound.default.CommandResult=CommandResult,exports.default=_yarnBound.default,module.exports=exports.default},384:(module,exports)=>{function parseAttributeContents(contents,locale){const nameMatch=contents.match(/^\/?([^\s=/]+)(\/|\s|$)/),isClosing="/"===contents[0],isSelfClosing="/"===contents[contents.length-1];if("/"===contents)return{name:"closeall",isCloseAll:!0};if(isClosing)return{name:nameMatch[1],isClosing:!0};{const propertyAssignments=(nameMatch?contents.replace(nameMatch[0],""):contents).match(/(\S+?".*?"|[^\s/]+)/g);let properties={};propertyAssignments&&(properties=propertyAssignments.reduce(((acc,propAss)=>({...acc,...parsePropertyAssignment(propAss)})),{}));const name=nameMatch&&nameMatch[1]||Object.keys(properties)[0];let replacement;return"select"===name?replacement=function(properties){return properties[properties.value]}(properties):"plural"===name?replacement=function(properties,locale){return properties[new Intl.PluralRules(locale).select(properties.value)].replace(/%/g,properties.value)}(properties,locale):"ordinal"===name&&(replacement=function(properties,locale){return properties[new Intl.PluralRules(locale,{type:"ordinal"}).select(properties.value)].replace(/%/g,properties.value)}(properties,locale)),{name:name,properties:properties,isSelfClosing:isSelfClosing,replacement:replacement}}}function parsePropertyAssignment(propAss){const[propName,...rest]=propAss.split("="),stringValue=rest.join("=");if(!propName||!stringValue)throw new Error("Invalid markup property assignment: ".concat(propAss));let value;return value="true"===stringValue||"false"===stringValue?"true"===stringValue:/^-?\d*\.?\d+$/.test(stringValue)?+stringValue:'"'===stringValue[0]&&'"'===stringValue[stringValue.length-1]?stringValue.slice(1,-1):stringValue,{[propName]:value}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(node,locale){node.markup=[],function(node){const match=node.text.match(/^(\S+):\s+/);match&&(node.text=node.text.replace(match[0],""),node.markup.push({name:"character",properties:{name:match[1]}}))}(node),function(node,locale){const attributes=[];let noMarkup=!1;const attributeRegex=/(^|[^\\])\[(.*?[^\\])\](.|$)/;let textRemaining=node.text,resultText="",match=textRemaining.match(attributeRegex);for(;match;){const{index:index}=match,[wholeMatch,charBefore,contents,charAfter]=match,hasLeadingSpace=/\s/.test(charBefore),hasTrailingSpace=/\s/.test(charAfter),attribute={...parseAttributeContents(contents,locale),position:resultText.length+index+charBefore.length};if(noMarkup&&"nomarkup"!==attribute.name)resultText+=textRemaining.slice(0,index+wholeMatch.length-1),textRemaining=textRemaining.slice(index+wholeMatch.length-1);else{const isReplacementTag="select"===attribute.name||"plural"===attribute.name||"ordinal"===attribute.name,shouldTrim=!isReplacementTag&&attribute.isSelfClosing&&attribute.properties&&!1!==attribute.properties.trimwhitespace&&(0===index&&hasTrailingSpace||hasLeadingSpace&&hasTrailingSpace);attribute.properties&&delete attribute.properties.trimwhitespace;const replacement=charBefore+(attribute.replacement||"")+(shouldTrim?charAfter.slice(1):charAfter);textRemaining=textRemaining.replace(attributeRegex,replacement),resultText+=textRemaining.slice(0,index+replacement.slice(1).length),textRemaining=textRemaining.slice(index+replacement.slice(1).length),isReplacementTag||"nomarkup"===attribute.name||attributes.push(attribute)}"nomarkup"===attribute.name&&(noMarkup=!attribute.isClosing),match=textRemaining.match(attributeRegex)}node.text=resultText+textRemaining;const escapedCharacterRegex=/\\(\[|\])/;for(match=node.text.match(escapedCharacterRegex),textRemaining=node.text,resultText="";match;){const char=match[1];attributes.forEach((attr=>{attr.position>resultText.length+match.index&&(attr.position-=1)})),textRemaining=textRemaining.replace(escapedCharacterRegex,char),resultText+=textRemaining.slice(0,match.index+1),textRemaining=textRemaining.slice(match.index+1),match=textRemaining.match(escapedCharacterRegex)}node.text=resultText+textRemaining;const openTagStacks={};attributes.forEach((attr=>{if(openTagStacks[attr.name]||(openTagStacks[attr.name]=[]),attr.isClosing&&!openTagStacks[attr.name].length)throw new Error("Encountered closing ".concat(attr.name," tag before opening tag"));if(attr.isClosing){const openTag=openTagStacks[attr.name].pop();node.markup.push({name:openTag.name,position:openTag.position,properties:openTag.properties,length:attr.position-openTag.position})}else if(attr.isSelfClosing)node.markup.push({name:attr.name,position:attr.position,properties:attr.properties,length:0});else if(attr.isCloseAll){const openTags=Object.values(openTagStacks).flat();for(;openTags.length;){const openTag=openTags.pop();node.markup.push({name:openTag.name,position:openTag.position,properties:openTag.properties,length:attr.position-openTag.position})}}else openTagStacks[attr.name].push({name:attr.name,position:attr.position,properties:attr.properties})}))}(node,locale),node.text=node.text.replace(/(?:\\(.))/g,"$1")},module.exports=exports.default},523:(module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _index=_interopRequireDefault(__webpack_require__(947)),_lineParser=_interopRequireDefault(__webpack_require__(384));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}exports.default=class{constructor(_ref){let{dialogue:dialogue,variableStorage:variableStorage,functions:functions,handleCommand:handleCommand,combineTextAndOptionsResults:combineTextAndOptionsResults,locale:locale,pauseCommand:pauseCommand="pause",startAt:startAt="Start"}=_ref;this.handleCommand=handleCommand,this.pauseCommand=pauseCommand,this.combineTextAndOptionsResults=combineTextAndOptionsResults,this.bondage=_index.default,this.currentResult=null,this.history=[],this.locale=locale,this.runner=new _index.default.Runner,this.runner.noEscape=!0,variableStorage&&(variableStorage.display=variableStorage.display||variableStorage.get,this.runner.setVariableStorage(variableStorage)),this.registerFunction("random",(()=>Math.random())),this.registerFunction("floor",(n=>Math.floor(n))),functions&&Object.entries(functions).forEach((entry=>{this.registerFunction(...entry)})),this.runner.load(dialogue),this.jump(startAt)}jump(startAt){this.generator=this.runner.run(startAt),this.advance()}handleConsecutiveOptionsNodes(shouldHandleCommand){let next=this.generator.next();for(;next.value instanceof _index.default.CommandResult&&next.value.command!==this.pauseCommand;)shouldHandleCommand&&this.handleCommand(next.value),next=this.generator.next();return next}lookahead(){let next=this.generator.next();if(next.done)return next.value=Object.assign(next.value||{},{isDialogueEnd:!0}),next;if(next.done||next.value&&next.value.command===this.pauseCommand||next.value instanceof _index.default.OptionsResult)return next;this.handleCommand&&next.value instanceof _index.default.CommandResult&&next.value.command!==this.pauseCommand&&(this.handleCommand(next.value),next=this.handleConsecutiveOptionsNodes(!0)),this.runner.lookahead=!0,this.runner.variables.set("__lookahead",!0);let upcoming=this.generator.next();if(this.handleCommand&&upcoming.value instanceof _index.default.CommandResult&&upcoming.value.command!==this.pauseCommand){upcoming=this.handleConsecutiveOptionsNodes(),this.generator=next.value.getGeneratorHere(),this.runner.lookahead=!1,this.runner.variables.set("__lookahead",!1);const rewoundNext=next.value instanceof _index.default.CommandResult?this.handleConsecutiveOptionsNodes(!0):this.generator.next();return upcoming.value||(upcoming=this.handleConsecutiveOptionsNodes(!0),upcoming.value?this.generator=upcoming.value.getGeneratorHere():Object.assign(rewoundNext.value,{isDialogueEnd:!0})),rewoundNext}if(next.value instanceof _index.default.TextResult&&this.combineTextAndOptionsResults&&upcoming.value instanceof _index.default.OptionsResult){this.generator=next.value.getGeneratorHere(),this.runner.lookahead=!1,this.runner.variables.set("__lookahead",!1);const rewoundNext=this.generator.next(),rewoundUpcoming=this.generator.next();return Object.assign(rewoundUpcoming.value,rewoundNext.value),rewoundUpcoming}{this.generator=next.value.getGeneratorHere(),this.runner.lookahead=!1,this.runner.variables.set("__lookahead",!1);const rewoundNext=this.generator.next();return upcoming.value||Object.assign(rewoundNext.value,{isDialogueEnd:!0}),rewoundNext}}advance(optionIndex){void 0!==optionIndex&&this.currentResult&&this.currentResult.select&&this.currentResult.select(optionIndex);const next=this.lookahead();[next.value.text&&next.value,...next.value.options||[]].filter(Boolean).forEach((node=>(0,_lineParser.default)(node,this.locale))),!this.currentResult||this.handleCommand&&this.currentResult instanceof _index.default.CommandResult||this.history.push(this.currentResult),this.currentResult=next.value}registerFunction(name,func){this.runner.registerFunction(name,func)}},module.exports=exports.default}},__webpack_module_cache__={},__webpack_exports__=function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(void 0!==cachedModule)return cachedModule.exports;var module=__webpack_module_cache__[moduleId]={exports:{}};return __webpack_modules__[moduleId](module,module.exports,__webpack_require__),module.exports}(954),__webpack_exports__;var __webpack_modules__,__webpack_module_cache__,__webpack_exports__},"object"==typeof exports&&"object"==typeof module?module.exports=factory():"function"==typeof define&&define.amd?define("mod_minilesson/external/yarn-bound",[],factory):"object"==typeof exports?exports.YarnBound=factory():root.YarnBound=factory();

//# sourceMappingURL=yarn-bound.min.js.map