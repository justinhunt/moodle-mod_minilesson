define(["jquery","core/log"],(function($,log){return log.debug("MiniLesson TTS Passage: initialising"),{init:function(PASSAGEID){var thesentence_number=0,lettered=!1,aplayer=$("#"+PASSAGEID+"_player"),fa=$("#"+PASSAGEID+" .fa"),passagelines=$("#"+PASSAGEID+"_textblock span.tbr_sentence"),doplayaudio=function(thesentence){log.debug(thesentence),log.debug($(passagelines[thesentence]).data("audiourl")),function(thesentence){passagelines.removeClass("passageplayer_activesentence"),$(passagelines[thesentence]).addClass("passageplayer_activesentence")}(thesentence),aplayer.attr("src",$(passagelines[thesentence]).data("audiourl")),aplayer[0].play()};aplayer[0].addEventListener("ended",(function(){thesentence_number<passagelines.length-1?(thesentence_number++,doplayaudio(thesentence_number)):(passagelines.removeClass("passageplayer_activesentence"),$(fa).removeClass("fa-stop"),$(fa).addClass("fa-volume-up"),thesentence_number=0,aplayer.removeAttr("src"))})),$("#"+PASSAGEID).click((function(){aplayer[0].paused||aplayer[0].ended?aplayer[0].paused&&aplayer.attr("src")?(aplayer[0].play(),$(fa).removeClass("fa-volume-up"),$(fa).addClass("fa-stop")):(lettered||(lettered=!0),doplayaudio(thesentence_number=0),$(fa).removeClass("fa-volume-up"),$(fa).addClass("fa-stop")):(aplayer[0].pause(),aplayer[0].load(),thesentence_number=0,$(fa).removeClass("fa-stop"),$(fa).addClass("fa-volume-up"))})),$("#"+PASSAGEID+"_textblock  .tbr_innerdiv").on("click",".tbr_sentence",(function(){aplayer[0].pause();var sentenceindex=$(this).attr("data-sentenceindex");$(fa).removeClass("fa-volume-up"),$(fa).addClass("fa-stop"),thesentence_number=sentenceindex,doplayaudio(sentenceindex)})),function(){for(var linecount=passagelines.length,thesentence=0;thesentence<linecount;thesentence++)$(passagelines[thesentence]).attr("data-sentenceindex",thesentence)}()}}}));

//# sourceMappingURL=ttspassage.min.js.map