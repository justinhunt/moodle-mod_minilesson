{"version":3,"sources":["../src/dictationchat.js"],"names":["define","$","log","def","polly","debug","init","index","itemdata","quizhelper","self","register_events","setvoice","getItems","uniqueid","on","stepdata","grade","do_next","start","items","game","pointer","audio","load","play","prop","text","target","setTimeout","length","answered","correct","nextPrompt","end","passage","transcriptArray","each","push","val","trim","transcript","join","getComparison","comparison","gotComparison","spliton","usevoice","mf","voice","text_items","customtext1","split","map","dictate_targetWords","filter","e","typed","item","fetch_polly_url","then","audiourl","Audio","src","appReady","console","hide","show","addClass","removeClass","Object","keys","forEach","idx","effect","realidx","data","dictate_targetWord","getWords","thetext","toLowerCase","chunks","words","i","match","getSimpleComparison","callback","pwords","twords","ret","pi","ajax","call","methodname","args","alternatives","language","done","ajaxresult","payloadobject","JSON","parse","fail","err","numCorrect","totalNum","html","fadeOut","spoken","code","replace","color","progress","toggle","direction","nextReply","dictate_targetWordsCode","word","append","trigger"],"mappings":"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","sourcesContent":["define(['jquery', 'core/log', 'mod_poodlltime/definitions', 'mod_poodlltime/pollyhelper'], function($, log, def, polly) {\n  \"use strict\"; // jshint ;_;\n\n  log.debug('Poodll Time dictation chat: initialising');\n\n  return {\n\n    init: function(index, itemdata, quizhelper) {\n      var self = this;\n      self.itemdata = itemdata;\n      self.quizhelper = quizhelper;\n      self.index = index;\n      self.register_events();\n      self.setvoice();\n      self.getItems();\n    },\n\n    register_events: function() {\n\n      var self = this;\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .poodlltime_nextbutton\").on('click', function(e) {\n        var stepdata = {};\n        var grade = 50;\n        stepdata.index = self.index;\n        stepdata.grade = grade;\n        self.quizhelper.do_next(stepdata);\n      });\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_start_btn\").on(\"click\", function() {\n        self.start();\n      });\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_listen_btn\").on(\"click\", function() {\n        self.items[self.game.pointer].audio.load();\n        self.items[self.game.pointer].audio.play();\n      });\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_skip_btn\").on(\"click\", function() {\n        $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_ctrl-btn\").prop(\"disabled\", true);\n        $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_speech.dictate_teacher_left\").text(self.items[self.game.pointer].target + \"\");\n        setTimeout(function() {\n          if (self.game.pointer < self.items.length - 1) {\n            self.items[self.game.pointer].answered = true;\n            self.items[self.game.pointer].correct = false;\n            self.game.pointer++;\n            self.nextPrompt();\n          } else {\n            self.end();\n          }\n        }, 3000);\n      });\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_check_btn\").on(\"click\", function() {\n\n        var passage = self.items[self.game.pointer].target;\n        var transcriptArray = [];\n\n        $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetWord\").each(function() {\n          transcriptArray.push($(this).val().trim() == \"\" ? \"|\" : $(this).val().trim());\n        })\n\n        var transcript = transcriptArray.join(\" \");\n\n        self.getComparison(passage, transcript, function(comparison) {\n          self.gotComparison(comparison, transcript);\n        });\n\n      })\n    },\n    spliton: new RegExp('([,.!?:;\" ])', 'g'),\n    game: {\n      pointer: 0\n    },\n    usevoice: 'Amy',\n    setvoice: function() {\n      var self = this;\n      var language = \"English(US)\";\n      var mf = \"Female\";\n      var voice = 'Amy';\n      switch (language) {\n        case \"English(US)\":\n          voice = mf === 'Male' ? 'Joey' : 'Kendra';\n          break;\n        case \"English(GB)\":\n          voice = mf === 'Male' ? 'Brian' : 'Amy';\n          break;\n        case \"English(AU)\":\n          voice = mf === 'Male' ? 'Russell' : 'Nicole';\n          break;\n        case \"English(IN)\":\n          voice = mf === 'Male' ? 'Aditi' : 'Raveena';\n          break;\n        case \"English(Welsh)\":\n          voice = mf === 'Male' ? 'Geraint' : 'Geraint';\n          break;\n        case \"Danish\":\n          voice = mf === 'Male' ? 'Mads' : 'Naja';\n          break;\n        case \"Dutch\":\n          voice = mf === 'Male' ? 'Ruben' : 'Lotte';\n          break;\n        case \"French(FR)\":\n          voice = mf === 'Male' ? 'Mathieu' : 'Celine';\n          break;\n        case \"French(CA)\":\n          voice = mf === 'Male' ? 'Chantal' : 'Chantal';\n          break;\n        case \"German\":\n          voice = mf === 'Male' ? 'Hans' : 'Marlene';\n          break;\n        case \"Icelandic\":\n          voice = mf === 'Male' ? 'Karl' : 'Dora';\n          break;\n        case \"Italian\":\n          voice = mf === 'Male' ? 'Carla' : 'Giorgio';\n          break;\n        case \"Japanese\":\n          voice = mf === 'Male' ? 'Takumi' : 'Mizuki';\n          break;\n        case \"Korean\":\n          voice = mf === 'Male' ? 'Seoyan' : 'Seoyan';\n          break;\n        case \"Norwegian\":\n          voice = mf === 'Male' ? 'Liv' : 'Liv';\n          break;\n        case \"Polish\":\n          voice = mf === 'Male' ? 'Jacek' : 'Ewa';\n          break;\n        case \"Portugese(BR)\":\n          voice = mf === 'Male' ? 'Ricardo' : 'Vitoria';\n          break;\n        case \"Portugese(PT)\":\n          voice = mf === 'Male' ? 'Cristiano' : 'Ines';\n          break;\n        case \"Romanian\":\n          voice = mf === 'Male' ? 'Carmen' : 'Carmen';\n          break;\n        case \"Russian\":\n          voice = mf === 'Male' ? 'Maxim' : 'Tatyana';\n          break;\n        case \"Spanish(ES)\":\n          voice = mf === 'Male' ? 'Enrique' : 'Conchita';\n          break;\n        case \"Spanish(US)\":\n          voice = mf === 'Male' ? 'Miguel' : 'Penelope';\n          break;\n        case \"Swedish\":\n          voice = mf === 'Male' ? 'Astrid' : 'Astrid';\n          break;\n        case \"Turkish\":\n          voice = mf === 'Male' ? 'Filiz' : 'Filiz';\n          break;\n        case \"Welsh\":\n          voice = mf === 'Male' ? 'Gwyneth' : 'Gwyneth';\n          break;\n        default:\n          voice = mf === 'Male' ? 'Brian' : 'Amy';\n      }\n      self.usevoice = voice;\n    },\n    getItems: function() {\n      var self = this;\n\n      var text_items = self.itemdata.customtext1.split(\"\\n\");\n\n      self.items = text_items.map(function(target) {\n        return {\n          dictate_targetWords: target.trim().split(self.spliton).filter(function(e) {\n            return e !== \"\";\n          }),\n          target: target,\n          typed: \"\",\n          answered: false,\n          correct: false,\n          audio: null\n        };\n      }).filter(function(e) {\n        return e.target !== \"\";\n      });\n\n      $.each(self.items, function(index, item) {\n        polly.fetch_polly_url(item.target, 'text', 'Amy').then(function(audiourl) {\n          item.audio = new Audio();\n          item.audio.src = audiourl;\n          if (self.items.filter(function(e) {\n              return e.audio == null\n            }).length == 0) {\n            self.appReady();\n          } else {\n            console.log(self.items);\n          }\n        });\n\n      });\n\n    },\n    appReady: function() {\n      var self = this;\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_not_loaded\").hide();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_loaded\").show();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_start_btn\").prop(\"disabled\", false);\n    },\n    gotComparison: function(comparison, typed) {\n      var self = this;\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetWord\").addClass(\"dictate_correct\").removeClass(\"dictate_incorrect\");\n\n      if (!Object.keys(comparison).length) {\n        $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_speech.dictate_teacher_left\").text(self.items[self.game.pointer].target + \"\");\n\n        self.items[self.game.pointer].answered = true;\n        self.items[self.game.pointer].correct = true;\n        self.items[self.game.pointer].typed = typed;\n\n        $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_ctrl-btn\").prop(\"disabled\", true);\n        if (self.game.pointer < self.items.length - 1) {\n          setTimeout(function() {\n            self.game.pointer++;\n            self.nextPrompt();\n          }, 3000);\n        } else {\n          setTimeout(function() {\n            self.end();\n          }, 3000);\n        }\n\n      } else {\n\n        Object.keys(comparison).forEach(function(idx) {\n          $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetWord[data-idx='\" + idx + \"']\").removeClass(\"dictate_correct\").addClass(\"dictate_incorrect\");\n        });\n\n        $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_reply_\" + self.game.pointer).effect(\"shake\", function() {\n\n          $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_ctrl-btn\").prop(\"disabled\", false);\n\n        });\n\n      }\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetWord.dictate_correct\").each(function() {\n        var realidx = $(this).data(\"realidx\");\n        var dictate_targetWord = self.items[self.game.pointer].dictate_targetWords[realidx];\n        $(this).val(dictate_targetWord).prop(\"disabled\", true);\n      });\n\n    },\n    getWords: function(thetext) {\n      var self = this;\n      var checkcase = false;\n      if (checkcase == 'false') {\n        thetext = thetext.toLowerCase();\n      }\n      var chunks = thetext.split(self.spliton).filter(function(e) {\n        return e !== \"\";\n      });\n      var words = [];\n      for (var i = 0; i < chunks.length; i++) {\n        if (!chunks[i].match(self.spliton)) {\n          words.push(chunks[i]);\n        }\n      }\n      return words;\n    },\n    getSimpleComparison(passage, transcript, callback) {\n      var self = this;\n      var pwords = self.getWords(passage);\n      var twords = self.getWords(transcript);\n      var ret = {};\n      for (var pi = 0; pi < pwords.length && pi < twords.length; pi++) {\n        if (pwords[pi] != twords[pi]) {\n          ret[pi + 1] = {\n            \"word\": pwords[pi],\n            \"number\": pi + 1\n          };\n        }\n      }\n      callback(ret);\n    },\n    getComparison: function(passage, transcript, callback) {\n      var self = this;\n      var comparison = \"simple\";\n      if (comparison == 'simple') {\n        self.getSimpleComparison(passage, transcript, callback);\n        return;\n      }\n\n      $(\".dictate_ctrl-btn\").prop(\"disabled\", true);\n\n      this.ajax.call([{\n        methodname: 'mod_poodlltime_compare_passage_to_transcript',\n        args: {\n          passage: passage,\n          transcript: transcript,\n          alternatives: '',\n          language: 'en-US'\n        },\n        done: function(ajaxresult) {\n          var payloadobject = JSON.parse(ajaxresult);\n          if (payloadobject) {\n            callback(payloadobject);\n          } else {\n            callback(false);\n          }\n        },\n        fail: function(err) {\n          console.log(err);\n        }\n      }]);\n\n    },\n    end: function() {\n      var self = this;\n\n      var numCorrect = self.items.filter(function(e) {\n        return e.correct;\n      }).length;\n\n      var totalNum = self.items.length;\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_results\").html(\"TOTAL<br/>\" + numCorrect + \"/\" + totalNum).show();\n\n      setTimeout(function() {\n        $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_results\").fadeOut();\n      }, 2000);\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_game\").hide();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_start_btn\").show();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_mainmenu\").show();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_controls\").hide();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_title\").html(\"Listen and Repeat\");\n\n    },\n    start: function() {\n      var self = this;\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_ctrl-btn\").prop(\"disabled\", true);\n\n      self.items.forEach(function(item) {\n        item.spoken = \"\";\n        item.answered = false;\n        item.correct = false;\n      });\n\n      self.game.pointer = 0;\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_game\").show();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_start_btn\").hide();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_mainmenu\").hide();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_controls\").show();\n\n      self.nextPrompt();\n\n    },\n    nextPrompt: function() {\n\n      var self = this;\n\n      var target = self.items[self.game.pointer].target;\n      var code = \"<div class='dictate_prompt dictate_prompt_\" + self.game.pointer + \"' style='display:none;'>\";\n\n      code += \"<i class='fa fa-graduation-cap dictate_speech-icon-left'></i>\";\n      code += \"<div style='margin-left:90px;' class='dictate_speech dictate_teacher_left'>\";\n      code += target.replace(/[^a-zA-Z0-9 ]/g, '').replace(/[a-zA-Z0-9]/g, 'â€¢');\n      code += \"</div>\";\n      code += \"</div>\";\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_game\").html(code);\n      $(\".dictate_ctrl-btn\").prop(\"disabled\", false);\n\n      var color;\n\n      var progress = self.items.map(function(item, idx) {\n        color = \"gray\";\n        if (self.items[idx].answered && self.items[idx].correct) {\n          color = \"green\";\n        } else if (self.items[idx].answered && !self.items[idx].correct) {\n          color = \"red\";\n        }\n        return \"<i style='color:\" + color + \"' class='fa fa-circle'></i>\";\n      }).join(\" \");\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_title\").html(progress);\n      $(\".dictate_prompt_\" + self.game.pointer).toggle(\"slide\", {\n        direction: 'left'\n      });\n\n      self.nextReply();\n\n    },\n    nextReply: function() {\n      var self = this;\n      var target = self.items[self.game.pointer].target;\n      var code = \"<div class='dictate_reply dictate_reply_\" + self.game.pointer + \"' style='display:none;'>\";\n      code += \"<i class='fa fa-user dictate_speech-icon-right'></i>\";\n      var dictate_targetWordsCode = \"\";\n      var idx = 1;\n      self.items[self.game.pointer].dictate_targetWords.forEach(function(word, realidx) {\n        if (!word.match(self.spliton)) {\n          dictate_targetWordsCode += \"<input type='text' maxlength='\" + word.length + \"' size='\" + (word.length + 1) + \"' class='dictate_targetWord' data-realidx='\" + realidx + \"' data-idx='\" + idx + \"'>\";\n          idx++;\n\n        } else {\n          dictate_targetWordsCode += word;\n        }\n      });\n      code += \"<div style='margin-right:90px;' class='dictate_speech dictate_right'>\" + dictate_targetWordsCode + \"</div>\";\n      code += \"</div>\";\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_game\").append(code);\n      $(\".dictate_reply_\" + self.game.pointer).toggle(\"slide\", {\n        direction: 'right'\n      });\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_ctrl-btn\").prop(\"disabled\", false);\n      setTimeout(function() {\n        $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_listen_btn\").trigger('click');\n      }, 1000);\n    }\n\n  };\n});"],"file":"dictationchat.min.js"}