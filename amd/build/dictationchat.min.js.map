{"version":3,"file":"dictationchat.min.js","sources":["../src/dictationchat.js"],"sourcesContent":["define(['jquery',\n  'core/log',\n  'core/ajax',\n  'mod_minilesson/definitions',\n  'mod_minilesson/pollyhelper',\n  'mod_minilesson/animatecss',\n  'core/templates'\n    ], function ($, log, ajax, def, polly, anim, templates) {\n        \"use strict\"; // jshint ;_;\n\n        log.debug('MiniLesson dictation chat: initialising');\n\n        return {\n\n            //for making multiple instances\n            clone: function () {\n                return $.extend(true, {}, this);\n            },\n\n            usevoice: 'Amy',\n\n            init: function (index, itemdata, quizhelper) {\n                var self = this;\n                self.itemdata = itemdata;\n                self.quizhelper = quizhelper;\n                self.index = index;\n\n    //anim\n                var animopts = {};\n                animopts.useanimatecss = quizhelper.useanimatecss;\n                anim.init(animopts);\n\n                self.register_events();\n                self.setvoice();\n                self.getItems();\n\n            },\n            next_question:function () {\n                var self = this;\n                var stepdata = {};\n                stepdata.index = self.index;\n                stepdata.hasgrade = true;\n                stepdata.totalitems = self.items.length;\n                stepdata.correctitems = self.items.filter(function (e) {\n                    return e.correct;}).length;\n                stepdata.grade = Math.round((stepdata.correctitems / stepdata.totalitems) * 100);\n\n      //stop audio\n                self.stop_audio();\n\n      //move to next question\n                self.quizhelper.do_next(stepdata);\n            },\n\n            show_item_review:function () {\n                var self = this;\n\n                self.items.forEach(function (item) {\n                            var itemwordlist = [];\n\n                            item.dictate_targetWords.forEach(function (data) {\n                                if (data !== '') {\n                                    itemwordlist.push(data);\n                                }\n                            });\n                            var wordmatch = itemwordlist.join(\"\");\n                            var regex = new RegExp(wordmatch, \"gi\");\n                            var answerclass = item.correct ? 'correctitem' : 'wrongitem';\n                            var result = item.target.replace(regex, `<span class=\"${answerclass}\">${wordmatch}</span>`);\n                            item.target = result;\n                });\n\n                var review_data = {};\n                review_data.items = self.items;\n                review_data.totalitems = self.items.length;\n                review_data.correctitems = self.items.filter(function (e) {\n                    return e.correct;}).length;\n\n    //display results\n                var gamebox = $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_game\");\n                var controlsbox = $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_controls\");\n                var recorderbox = $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_speakbtncontainer\");\n                var resultsbox = $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_resultscontainer\");\n                var resultsbox = $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_resultscontainer\");\n                var title = $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_title\");\n                var listencontroler = $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_listen_controler\");\n                templates.render('mod_minilesson/listitemresults',review_data).then(\n                    function (html,js) {\n                          resultsbox.html(html);\n                          //show and hide\n                          resultsbox.show();\n                          gamebox.hide();\n                          controlsbox.hide();\n                          recorderbox.hide();\n                          title.hide();\n                          listencontroler.hide();\n                          // Run js for audio player events\n                          templates.runTemplateJS(js);\n                    }\n                );// End of templates\n            },\n\n            register_events: function () {\n\n                var self = this;\n\n                $(\"#\" + self.itemdata.uniqueid + \"_container .minilesson_nextbutton\").on('click', function (e) {\n                            self.next_question();\n                });\n\n                $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_start_btn\").on(\"click\", function () {\n                            self.start();\n                });\n\n                var audioplayerbtn = $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_listen_btn\");\n                audioplayerbtn.on(\"click\", function () {\n                            var theaudio = self.items[self.game.pointer].audio;\n                    if (!theaudio.paused) {\n                        theaudio.pause();\n                        theaudio.currentTime = 0;\n                        audioplayerbtn.children('.fa').removeClass('fa-stop');\n                        audioplayerbtn.children('.fa').addClass('fa-volume-up');\n                        return;\n                    }\n\n                    theaudio.addEventListener('ended', function () {\n                        audioplayerbtn.children('.fa').removeClass('fa-stop');\n                        audioplayerbtn.children('.fa').addClass('fa-volume-up');\n                    });\n\n                            theaudio.addEventListener('play', function () {\n                                audioplayerbtn.children('.fa').removeClass('fa-volume-up');\n                                audioplayerbtn.children('.fa').addClass('fa-stop');\n                            });\n\n                            theaudio.load();\n                            theaudio.play();\n                });\n\n      //on skip button click\n                $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_skip_btn\").on(\"click\", function () {\n                            //disable buttons\n                            $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_ctrl-btn\").prop(\"disabled\", true);\n                            //reveal prompt\n                            $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_speech.dictate_teacher_left\").text(self.items[self.game.pointer].displayprompt + \"\");\n                            //reveal answers\n                            //reveal the answer\n                            $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetWord\").each(function () {\n                                var realidx = $(this).data(\"realidx\");\n                                var dictate_targetWord = self.items[self.game.pointer].dictate_targetWords[realidx];\n                                $(this).val(dictate_targetWord);\n                            });\n\n\n                            //move on after short time, to next prompt, or next question\n                    if (self.game.pointer < self.items.length - 1) {\n                        setTimeout(function () {\n                            self.items[self.game.pointer].answered = true;\n                            self.items[self.game.pointer].correct = false;\n                            self.game.pointer++;\n                            self.nextPrompt();\n                        }, 3000);\n                    } else {\n                        self.end();\n                    }\n                });\n\n\n                $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_check_btn\").on(\"click\", function () {\n                            self.check_answer();\n                });\n\n      //listen for enter key\n                $(\"#\" + self.itemdata.uniqueid + \"_container\").on(\"keydown\",\".dictate_targetWord\", function (e) {\n                    if (e.which == 13) {\n                        self.check_answer();\n                    }\n                });\n\n      //auto nav between inputs\n                $(\"#\" + self.itemdata.uniqueid + \"_container\").on(\"keyup\",\".dictate_targetWord\", function (e) {\n\n                            //move focus between textboxes\n                            //log.debug(e);\n                            var target = e.srcElement || e.target;\n                            var maxLength = parseInt(target.attributes[\"maxlength\"].value, 10);\n                            var myLength = target.value.length;\n                            var key = e.which;\n                    if (myLength >= maxLength) {\n                        var nextIdx = $(this).data('idx') + 1;\n                        var next = $(\"#\" + self.itemdata.uniqueid + \"_container input.dictate_targetWord[data-idx=\\\"\" + nextIdx + \"\\\"\");\n                        if (next.length === 1) {\n                            next.focus();\n                        }\n\n          // Move to previous field if empty (user pressed backspace or delete)\n                    } else if (( key == 8 || key == 46 ) && myLength === 0) {\n                        var previousIdx = $(this).data('idx') - 1;\n                        var previous = $(\"#\" + self.itemdata.uniqueid + \"_container input.dictate_targetWord[data-idx=\\\"\" + previousIdx + \"\\\"\");\n                        if (previous.length === 1) {\n                            previous.focus();\n                        }\n                    }\n                });\n\n            },\n\n            game: {\n                pointer: 0\n            },\n\n            check_answer: function () {\n                var self = this;\n                var passage = self.items[self.game.pointer].target;\n                var transcript = '';\n                $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetBit\").each(function () {\n                    if ($(this).hasClass('dictate_targetWord')) {\n                        transcript += $(this).val();\n                    } else if ($(this).hasClass('dictate_targetWordPunc')) {\n                        transcript += $(this).text();\n                    }\n                });\n\n        //the old code looped over dictate_targetWord, pushed to transcriptArray, and joined with a space\n        //But that did not account for words split by punc, eg It's.\n          // Kept that here for now, but can delete  I think.\n          /*\n          var transcriptArray = [];\n          $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetWord\").each(function() {\n          transcriptArray.push($(this).val().trim() == \"\" ? \"|\" : $(this).val().trim());\n          });\n         var transcript = transcriptArray.join(\" \");\n        */\n\n                self.getComparison(passage, transcript, function (comparison) {\n                      self.gotComparison(comparison, transcript);\n                });\n            },\n            setvoice: function () {\n                var self = this;\n                self.usevoice = self.itemdata.usevoice;\n                self.voiceoption = self.itemdata.voiceoption;\n                return;\n            },\n            getItems: function () {\n                var self = this;\n                var text_items = self.itemdata.sentences;\n\n                self.items = text_items.map(function (target) {\n                            return {\n                                dictate_targetWords: target.sentence.trim().split(self.quizhelper.spliton_regexp).filter(function (e) {\n                                    return e !== \"\";\n                                }),\n                            target: target.sentence,\n                            prompt: target.prompt,\n                            displayprompt: target.displayprompt,\n                            typed: \"\",\n                            answered: false,\n                            correct: false,\n                            audio: null,\n                            audiourl: target.audiourl ? target.audiourl : \"\",\n                            imageurl: target.imageurl,\n                    };\n                }).filter(function (e) {\n                          return e.target !== \"\";\n                });\n\n                $.each(self.items, function (index, item) {\n                            item.audio = new Audio();\n                            item.audio.src = item.audiourl;\n                    if (self.items.filter(function (e) {\n                        return e.audio == null;\n                    }).length == 0) {\n                        self.appReady();\n                    } else {\n                        console.log(self.items);\n                    }\n                });\n\n            },\n            appReady: function () {\n                var self = this;\n                $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_not_loaded\").hide();\n                $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_loaded\").show();\n                $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_start_btn\").prop(\"disabled\", false);\n            },\n            gotComparison: function (comparison, typed) {\n\n                var self = this;\n\n                $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetWord\").removeClass(\"dictate_correct dictate_incorrect\");\n                $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_feedback\").removeClass(\"fa fa-check fa-times\");\n\n                var allCorrect = comparison.filter(function (e) {\n                            return !e.matched;\n                }).length == 0;\n\n                if (allCorrect) {\n                            $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetWord\").addClass(\"dictate_correct\").prop(\"disabled\",true);\n                            $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_feedback\").addClass(\"fa fa-check\");\n                            $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_speech.dictate_teacher_left\").text(self.items[self.game.pointer].displayprompt + \"\");\n\n                            self.items[self.game.pointer].answered = true;\n                            self.items[self.game.pointer].correct = true;\n                            self.items[self.game.pointer].typed = typed;\n\n                            $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_ctrl-btn\").prop(\"disabled\", true);\n                    if (self.game.pointer < self.items.length - 1) {\n                        setTimeout(function () {\n                                  self.game.pointer++;\n                                  self.nextPrompt();\n                        }, 2200);\n                    } else {\n                        self.end();\n                    }\n                } else {\n                    comparison.forEach(function (obj) {\n                        if (!obj.matched) {\n                            $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetWord[data-idx='\" + obj.wordnumber + \"']\").addClass(\"dictate_incorrect\");\n                            $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_feedback[data-idx='\" + obj.wordnumber + \"']\").addClass(\"fa fa-times\");\n                        } else {\n                            $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetWord[data-idx='\" + obj.wordnumber + \"']\").addClass(\"dictate_correct\").prop(\"disabled\",true);\n                            $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_feedback[data-idx='\" + obj.wordnumber + \"']\").addClass(\"fa fa-check\");\n                        }\n                    });\n                    var thereply = $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_reply_\" + self.game.pointer);\n                    anim.do_animate(thereply,'shakeX animate__faster').then(\n                        function () {\n                            $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_ctrl-btn\").prop(\"disabled\", false);}\n                    );\n                    /*\n                    $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_reply_\" + self.game.pointer).effect(\"shake\", function() {\n                    $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_ctrl-btn\").prop(\"disabled\", false);\n                    }\n                    );\n                    */\n                }\n\n                $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetWord.dictate_correct\").each(function () {\n                          var realidx = $(this).data(\"realidx\");\n                          var dictate_targetWord = self.items[self.game.pointer].dictate_targetWords[realidx];\n                          $(this).val(dictate_targetWord);\n                });\n\n            },\n            getWords: function (thetext) {\n                var self = this;\n                var checkcase = false;\n                if (checkcase == 'false') {\n                            thetext = thetext.toLowerCase();\n                }\n                var chunks = thetext.split(self.quizhelper.spliton_regexp).filter(function (e) {\n                          return e !== \"\";\n                });\n                var words = [];\n                for (var i = 0; i < chunks.length; i++) {\n                    if (!chunks[i].match(self.quizhelper.spliton_regexp)) {\n                        words.push(chunks[i]);\n                    }\n                }\n                return words;\n            },\n            getComparison: function (passage, transcript, callback) {\n                var self = this;\n\n                $(\".dictate_ctrl-btn\").prop(\"disabled\", true);\n                var phonetic = '';//we do not want a phonetic match in dictation.\n                self.quizhelper.comparePassageToTranscript(passage,transcript,phonetic,self.itemdata.language).then(function (ajaxresult) {\n                          var payloadobject = JSON.parse(ajaxresult);\n                    if (payloadobject) {\n                        callback(payloadobject);\n                    } else {\n                        callback(false);\n                    }\n                });\n\n            },\n\n            end: function () {\n                var self = this;\n                $(\".minilesson_nextbutton\").prop(\"disabled\",true);\n\n      //progress dots are updated on next_item. The last item has no next item, so we update from here\n                self.updateProgressDots();\n\n      //disable the buttons and go to next question or review\n                setTimeout(function () {\n                            $(\".minilesson_nextbutton\").prop(\"disabled\",false);\n                    if (self.quizhelper.showitemreview) {\n                        self.show_item_review();\n                    } else {\n                        self.next_question();\n                    }\n                }, 2200);\n            },\n\n            start: function () {\n                var self = this;\n\n                $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_ctrl-btn\").prop(\"disabled\", true);\n                $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_title\").show();\n\n                self.items.forEach(function (item) {\n                            item.spoken = \"\";\n                            item.answered = false;\n                            item.correct = false;\n                });\n\n                self.game.pointer = 0;\n\n                $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_game\").show();\n                $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_start_btn\").hide();\n                $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_mainmenu\").hide();\n                $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_controls\").show();\n                $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_image_container\").hide();\n                $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_description\").hide();\n                $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_maintitle\").show();\n                $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_itemtext\").show();\n                $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_listen_controler\").show();\n\n                self.nextPrompt();\n\n            },\n            nextPrompt: function () {\n\n                var self = this;\n                var target = self.items[self.game.pointer].target;\n                var prompt = self.items[self.game.pointer].prompt;\n                var displayprompt = self.items[self.game.pointer].displayprompt;\n\n                var nopunc = prompt.replace(self.quizhelper.nopunc_regexp,\"\");\n                var dots = nopunc.replace(self.quizhelper.nonspaces_regexp, 'â€¢');\n                var code = \"<div class='dictate_prompt dictate_prompt_\" + self.game.pointer + \"' style='display:none;'>\";\n\n                code += \"<i class='fa fa-graduation-cap dictate_speech-icon-left'></i>\";\n                code += \"<div style='margin-left:90px;' class='dictate_speech dictate_teacher_left'>\";\n                code += dots;\n                code += \"</div>\";\n                code += \"</div>\";\n\n                $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_game\").html(code);\n                $(\".dictate_ctrl-btn\").prop(\"disabled\", false);\n\n                self.updateProgressDots();\n\n                var newprompt = $(\".dictate_prompt_\" + self.game.pointer);\n                anim.do_animate(newprompt,'zoomIn animate__faster','in').then(\n                    function (){}\n                );\n      /*\n      $(\".dictate_prompt_\" + self.game.pointer).toggle(\"slide\", {\n        direction: 'left'\n      });\n       */\n\n                self.nextReply();\n\n            },\n\n            updateProgressDots: function () {\n                var self = this;\n                var color,icon;\n                var progress = self.items.map(function (item, idx) {\n                            color = \"#E6E9FD\";\n                            icon = \"fa fa-square\";\n                    if (self.items[idx].answered && self.items[idx].correct) {\n                        color = \"#74DC72\";\n                        icon = 'fa fa-check-square';\n                    } else if (self.items[idx].answered && !self.items[idx].correct) {\n                        color = \"#FB6363\";\n                        icon = \"fa fa-window-close\";\n                    }\n                    return \"<i style='color:\" + color + \"' class='\" + icon + \" pl-1'></i>\";\n                }).join(\" \");\n                $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_title\").html(progress);\n            },\n\n            nextReply: function () {\n                var self = this;\n                var target = self.items[self.game.pointer].target;\n                var code = \"<div class='dictate_reply dictate_reply_\" + self.game.pointer + \"' style='display:none;'>\";\n                code += \"<i class='fa fa-user dictate_speech-icon-right'></i>\";\n                var dictate_targetWordsCode = \"\";\n                var idx = 1;\n                self.items[self.game.pointer].dictate_targetWords.forEach(function (word, realidx) {\n                    if (!word.match(self.quizhelper.spliton_regexp)) {\n                        dictate_targetWordsCode += \"<ruby><input type='text' maxlength='\" + word.length + \"' size='\" + (word.length + 1) + \"' class='dictate_targetBit dictate_targetWord' data-realidx='\" + realidx + \"' data-idx='\" + idx + \"'><rt><i data-idx='\" + idx + \"' class='dictate_feedback'></i></rt></ruby>\";\n                        idx++;\n                    } else {\n                        dictate_targetWordsCode += \"<span class='dictate_targetBit dictate_targetWordPunc' data-idx='\" + idx + \"'>\" + word + \"</span>\";\n                    }\n                });\n                code += \"<div style='margin-right:90px;' class='dictate_speech dictate_right'>\" + dictate_targetWordsCode + \"</div>\";\n                code += \"</div>\";\n                $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_game\").append(code);\n                var newreply = $(\".dictate_reply_\" + self.game.pointer);\n                anim.do_animate(newreply,'zoomIn animate__faster','in').then(\n                    function (){}\n                );\n      /*\n      $(\".dictate_reply_\" + self.game.pointer).toggle(\"slide\", {\n        direction: 'right'\n      });\n       */\n                $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_ctrl-btn\").prop(\"disabled\", false);\n                setTimeout(function () {\n                            $(\".dictate_targetWord\").first().focus();\n                            $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_listen_btn\").trigger('click');\n                }, 500);\n            },\n\n          // Stop audio .. usually when leaving the item or sentence\n            stop_audio: function () {\n                var self = this;\n      //pause audio if its playing\n                var theaudio = self.items[self.game.pointer].audio;\n                if (theaudio && !theaudio.paused) {\n                            theaudio.pause();\n                }\n            }\n\n        };\n    });"],"names":["define","$","log","ajax","def","polly","anim","templates","debug","clone","extend","this","usevoice","init","index","itemdata","quizhelper","animopts","useanimatecss","register_events","setvoice","getItems","next_question","stepdata","hasgrade","totalitems","items","length","correctitems","filter","e","correct","grade","Math","round","stop_audio","do_next","show_item_review","forEach","item","itemwordlist","dictate_targetWords","data","push","wordmatch","join","regex","RegExp","answerclass","result","target","replace","review_data","gamebox","uniqueid","controlsbox","recorderbox","resultsbox","title","listencontroler","render","then","html","js","show","hide","runTemplateJS","self","on","start","audioplayerbtn","theaudio","game","pointer","audio","paused","pause","currentTime","children","removeClass","addClass","addEventListener","load","play","prop","text","displayprompt","each","realidx","dictate_targetWord","val","setTimeout","answered","nextPrompt","end","check_answer","which","srcElement","maxLength","parseInt","attributes","value","myLength","key","nextIdx","next","focus","previousIdx","previous","passage","transcript","hasClass","getComparison","comparison","gotComparison","voiceoption","text_items","sentences","map","sentence","trim","split","spliton_regexp","prompt","typed","audiourl","imageurl","Audio","src","appReady","console","matched","obj","wordnumber","thereply","do_animate","getWords","thetext","chunks","words","i","match","callback","comparePassageToTranscript","language","ajaxresult","payloadobject","JSON","parse","updateProgressDots","showitemreview","spoken","dots","nopunc_regexp","nonspaces_regexp","code","newprompt","nextReply","color","icon","progress","idx","dictate_targetWordsCode","word","append","newreply","first","trigger"],"mappings":"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"}