{"version":3,"file":"dictationchat.min.js","sources":["../src/dictationchat.js"],"sourcesContent":["define(['jquery',\n  'core/log',\n  'core/ajax',\n  'mod_minilesson/definitions',\n  'mod_minilesson/pollyhelper',\n  'mod_minilesson/animatecss',\n  'core/templates'\n    ], function($, log, ajax, def, polly, anim, templates) {\n  \"use strict\"; // jshint ;_;\n\n  log.debug('MiniLesson dictation chat: initialising');\n\n  return {\n\n      //for making multiple instances\n      clone: function () {\n          return $.extend(true, {}, this);\n      },\n\n      usevoice: 'Amy',\n\n      init: function(index, itemdata, quizhelper) {\n        var self = this;\n        self.itemdata = itemdata;\n        self.quizhelper = quizhelper;\n        self.index = index;\n\n        //anim\n        var animopts = {};\n        animopts.useanimatecss=quizhelper.useanimatecss;\n        anim.init(animopts);\n\n        self.register_events();\n        self.setvoice();\n        self.getItems();\n\n    },\n    next_question:function(){\n      var self=this;\n      var stepdata = {};\n      stepdata.index = self.index;\n      stepdata.hasgrade = true;\n      stepdata.totalitems=self.items.length;\n      stepdata.correctitems=self.items.filter(function(e) {return e.correct;}).length;\n      stepdata.grade = Math.round((stepdata.correctitems/stepdata.totalitems)*100);\n\n      //stop audio\n      self.stop_audio();\n\n      //move to next question\n      self.quizhelper.do_next(stepdata);\n    },\n\n    show_item_review:function(){\n      var self=this;\n      var review_data = {};\n      review_data.items = self.items;\n      review_data.totalitems=self.items.length;\n      review_data.correctitems=self.items.filter(function(e) {return e.correct;}).length;\n\n      //display results\n      var gamebox= $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_game\");\n      var controlsbox = $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_controls\");\n      var recorderbox = $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_speakbtncontainer\");\n      var resultsbox = $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_resultscontainer\");\n      templates.render('mod_minilesson/listitemresults',review_data).then(\n        function(html,js){\n            resultsbox.html(html);\n            //show and hide\n            resultsbox.show();\n            gamebox.hide();\n            controlsbox.hide();\n            recorderbox.hide();\n            // Run js for audio player events\n            templates.runTemplateJS(js);\n        }\n      );// End of templates\n    },\n\n    register_events: function() {\n\n      var self = this;\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .minilesson_nextbutton\").on('click', function(e) {\n        self.next_question();\n      });\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_start_btn\").on(\"click\", function() {\n        self.start();\n      });\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_listen_btn\").on(\"click\", function() {\n        self.items[self.game.pointer].audio.load();\n        self.items[self.game.pointer].audio.play();\n      });\n\n      //on skip button click\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_skip_btn\").on(\"click\", function() {\n        //disable buttons\n        $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_ctrl-btn\").prop(\"disabled\", true);\n        //reveal prompt\n        $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_speech.dictate_teacher_left\").text(self.items[self.game.pointer].displayprompt + \"\");\n        //reveal answers\n        //reveal the answer\n        $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetWord\").each(function() {\n          var realidx = $(this).data(\"realidx\");\n          var dictate_targetWord = self.items[self.game.pointer].dictate_targetWords[realidx];\n          $(this).val(dictate_targetWord);\n        });\n\n\n          //move on after short time, to next prompt, or next question\n          if (self.game.pointer < self.items.length - 1) {\n            setTimeout(function() {\n              self.items[self.game.pointer].answered = true;\n              self.items[self.game.pointer].correct = false;\n              self.game.pointer++;\n              self.nextPrompt();\n            }, 3000);\n          } else {\n            self.end();\n          }\n      });\n\n      \n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_check_btn\").on(\"click\", function() {\n        self.check_answer();\n      });\n\n      //listen for enter key\n      $(\"#\" + self.itemdata.uniqueid + \"_container\").on(\"keydown\",\".dictate_targetWord\", function(e) {\n        if (e.which == 13) {\n          self.check_answer();\n        }\n      });\n\n      //auto nav between inputs\n      $(\"#\" + self.itemdata.uniqueid + \"_container\").on(\"keyup\",\".dictate_targetWord\", function(e) {\n\n        //move focus between textboxes\n        //log.debug(e);\n        var target = e.srcElement || e.target;\n        var maxLength = parseInt(target.attributes[\"maxlength\"].value, 10);\n        var myLength = target.value.length;\n        var key = e.which;\n        if (myLength >= maxLength) {\n          var nextIdx = $(this).data('idx') + 1;\n          var next = $(\"#\" + self.itemdata.uniqueid + \"_container input.dictate_targetWord[data-idx=\\\"\"+nextIdx+\"\\\"\");\n          if (next.length === 1){\n            next.focus();\n          }\n\n          // Move to previous field if empty (user pressed backspace or delete)\n        } else if (( key == 8 || key == 46 ) && myLength === 0) {\n          var previousIdx = $(this).data('idx') - 1;\n          var previous = $(\"#\" + self.itemdata.uniqueid + \"_container input.dictate_targetWord[data-idx=\\\"\"+previousIdx+\"\\\"\");\n          if (previous.length === 1){\n            previous.focus();\n          }\n        }\n      });\n      \n    },\n\n    game: {\n      pointer: 0\n    },\n\n    check_answer: function(){\n      var self = this;\n      var passage = self.items[self.game.pointer].target;\n      var transcript = '';\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetBit\").each(function() {\n        if($(this).hasClass('dictate_targetWord')){\n          transcript += $(this).val();\n        }else if($(this).hasClass('dictate_targetWordPunc')){\n          transcript += $(this).text();\n        }\n      });\n\n    //the old code looped over dictate_targetWord, pushed to transcriptArray, and joined with a space\n    //But that did not account for words split by punc, eg It's.\n      // Kept that here for now, but can delete  I think.\n      /*\n      var transcriptArray = [];\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetWord\").each(function() {\n        transcriptArray.push($(this).val().trim() == \"\" ? \"|\" : $(this).val().trim());\n      });\n     var transcript = transcriptArray.join(\" \");\n    */\n\n      self.getComparison(passage, transcript, function(comparison) {\n        self.gotComparison(comparison, transcript);\n      });\n    },\n    setvoice: function() {\n        var self = this;\n        self.usevoice = self.itemdata.usevoice;\n        self.voiceoption=self.itemdata.voiceoption;\n        return;\n    },\n    getItems: function() {\n      var self = this;\n      var text_items = self.itemdata.sentences;\n\n      self.items = text_items.map(function(target) {\n        return {\n          dictate_targetWords: target.sentence.trim().split(self.quizhelper.spliton_regexp).filter(function(e) {\n            return e !== \"\";\n          }),\n          target: target.sentence,\n          prompt: target.prompt,\n          displayprompt: target.displayprompt,\n          typed: \"\",\n          answered: false,\n          correct: false,\n          audio: null,\n          audiourl: target.audiourl ? target.audiourl : \"\",\n          imageurl: target.imageurl,\n        };\n      }).filter(function(e) {\n        return e.target !== \"\";\n      });\n\n      $.each(self.items, function(index, item) {\n          item.audio = new Audio();\n          item.audio.src = item.audiourl;\n          if (self.items.filter(function(e) {\n              return e.audio == null;\n            }).length == 0) {\n            self.appReady();\n          } else {\n            console.log(self.items);\n          }\n      });\n\n    },\n    appReady: function() {\n      var self = this;\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_not_loaded\").hide();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_loaded\").show();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_start_btn\").prop(\"disabled\", false);\n    },\n    gotComparison: function(comparison, typed) {\n\n      var self = this;\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetWord\").removeClass(\"dictate_correct dictate_incorrect\");\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_feedback\").removeClass(\"fa fa-check fa-times\");\n\n      var allCorrect = comparison.filter(function(e) {\n        return !e.matched;\n      }).length == 0;\n\n      if (allCorrect) {\n\n        $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetWord\").addClass(\"dictate_correct\").prop(\"disabled\",true);\n        $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_feedback\").addClass(\"fa fa-check\");\n        $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_speech.dictate_teacher_left\").text(self.items[self.game.pointer].displayprompt + \"\");\n\n        self.items[self.game.pointer].answered = true;\n        self.items[self.game.pointer].correct = true;\n        self.items[self.game.pointer].typed = typed;\n\n        $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_ctrl-btn\").prop(\"disabled\", true);\n        if (self.game.pointer < self.items.length - 1) {\n          setTimeout(function() {\n            self.game.pointer++;\n            self.nextPrompt();\n          }, 2200);\n        } else {\n            self.end();\n        }\n\n      } else {\n\n        comparison.forEach(function(obj) {\n          if (!obj.matched) {\n            $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetWord[data-idx='\" + obj.wordnumber + \"']\").addClass(\"dictate_incorrect\");\n            $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_feedback[data-idx='\" + obj.wordnumber + \"']\").addClass(\"fa fa-times\");\n          } else {\n            $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetWord[data-idx='\" + obj.wordnumber + \"']\").addClass(\"dictate_correct\").prop(\"disabled\",true);\n            $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_feedback[data-idx='\" + obj.wordnumber + \"']\").addClass(\"fa fa-check\");\n          }\n        });\n        var thereply = $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_reply_\" + self.game.pointer);\n        anim.do_animate(thereply,'shakeX animate__faster').then(\n            function() {$(\"#\" + self.itemdata.uniqueid + \"_container .dictate_ctrl-btn\").prop(\"disabled\", false);}\n        );\n        /*\n        $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_reply_\" + self.game.pointer).effect(\"shake\", function() {\n          $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_ctrl-btn\").prop(\"disabled\", false);\n        }\n        );\n        */\n\n      }\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_targetWord.dictate_correct\").each(function() {\n        var realidx = $(this).data(\"realidx\");\n        var dictate_targetWord = self.items[self.game.pointer].dictate_targetWords[realidx];\n        $(this).val(dictate_targetWord);\n      });\n\n    },\n    getWords: function(thetext) {\n      var self = this;\n      var checkcase = false;\n      if (checkcase == 'false') {\n        thetext = thetext.toLowerCase();\n      }\n      var chunks = thetext.split(self.quizhelper.spliton_regexp).filter(function(e) {\n        return e !== \"\";\n      });\n      var words = [];\n      for (var i = 0; i < chunks.length; i++) {\n        if (!chunks[i].match(self.quizhelper.spliton_regexp)) {\n          words.push(chunks[i]);\n        }\n      }\n      return words;\n    },\n    getComparison: function(passage, transcript, callback) {\n        var self = this;\n\n        $(\".dictate_ctrl-btn\").prop(\"disabled\", true);\n        var phonetic ='';//we do not want a phonetic match in dictation.\n        self.quizhelper.comparePassageToTranscript(passage,transcript,phonetic,self.itemdata.language).then(function(ajaxresult) {\n            var payloadobject = JSON.parse(ajaxresult);\n            if (payloadobject) {\n                callback(payloadobject);\n            } else {\n                callback(false);\n            }\n        });\n\n    },\n\n    end: function() {\n      var self = this;\n      $(\".minilesson_nextbutton\").prop(\"disabled\",true);\n\n      //progress dots are updated on next_item. The last item has no next item, so we update from here\n      self.updateProgressDots();\n\n      //disable the buttons and go to next question or review\n      setTimeout(function() {\n        $(\".minilesson_nextbutton\").prop(\"disabled\",false);\n        if(self.quizhelper.showitemreview){\n          self.show_item_review();\n        }else{\n          self.next_question();\n        }\n      }, 2200);\n    },\n\n    start: function() {\n      var self = this;\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_ctrl-btn\").prop(\"disabled\", true);\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_title\").show();\n\n      self.items.forEach(function(item) {\n        item.spoken = \"\";\n        item.answered = false;\n        item.correct = false;\n      });\n\n      self.game.pointer = 0;\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_game\").show();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_start_btn\").hide();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_mainmenu\").hide();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_controls\").show();\n\n      self.nextPrompt();\n\n    },\n    nextPrompt: function() {\n\n      var self = this;\n      var target = self.items[self.game.pointer].target;\n      var prompt = self.items[self.game.pointer].prompt;\n      var displayprompt = self.items[self.game.pointer].displayprompt;\n\n      var nopunc = prompt.replace(self.quizhelper.nopunc_regexp,\"\");\n      var dots = nopunc.replace(self.quizhelper.nonspaces_regexp, '•');\n      var code = \"<div class='dictate_prompt dictate_prompt_\" + self.game.pointer + \"' style='display:none;'>\";\n\n      code += \"<i class='fa fa-graduation-cap dictate_speech-icon-left'></i>\";\n      code += \"<div style='margin-left:90px;' class='dictate_speech dictate_teacher_left'>\";\n      code += dots;\n      code += \"</div>\";\n      code += \"</div>\";\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_game\").html(code);\n      $(\".dictate_ctrl-btn\").prop(\"disabled\", false);\n\n      self.updateProgressDots();\n\n      var newprompt = $(\".dictate_prompt_\" + self.game.pointer);\n      anim.do_animate(newprompt,'zoomIn animate__faster','in').then(\n          function(){}\n      );\n      /*\n      $(\".dictate_prompt_\" + self.game.pointer).toggle(\"slide\", {\n        direction: 'left'\n      });\n       */\n\n      self.nextReply();\n\n    },\n\n    updateProgressDots: function() {\n      var self = this;\n      var color;\n      var progress = self.items.map(function(item, idx) {\n        color = \"gray\";\n        if (self.items[idx].answered && self.items[idx].correct) {\n          color = \"green\";\n        } else if (self.items[idx].answered && !self.items[idx].correct) {\n          color = \"red\";\n        }\n        return \"<i style='color:\" + color + \"' class='fa fa-circle'></i>\";\n      }).join(\" \");\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_title\").html(progress);\n    },\n\n    nextReply: function() {\n      var self = this;\n      var target = self.items[self.game.pointer].target;\n      var code = \"<div class='dictate_reply dictate_reply_\" + self.game.pointer + \"' style='display:none;'>\";\n      code += \"<i class='fa fa-user dictate_speech-icon-right'></i>\";\n      var dictate_targetWordsCode = \"\";\n      var idx = 1;\n      self.items[self.game.pointer].dictate_targetWords.forEach(function(word, realidx) {\n        if (!word.match(self.quizhelper.spliton_regexp)) {\n          dictate_targetWordsCode += \"<ruby><input type='text' maxlength='\" + word.length + \"' size='\" + (word.length + 1) + \"' class='dictate_targetBit dictate_targetWord' data-realidx='\" + realidx + \"' data-idx='\" + idx + \"'><rt><i data-idx='\" + idx + \"' class='dictate_feedback'></i></rt></ruby>\";\n          idx++;\n        } else {\n          dictate_targetWordsCode += \"<span class='dictate_targetBit dictate_targetWordPunc' data-idx='\" + idx + \"'>\" + word + \"</span>\";\n        }\n      });\n      code += \"<div style='margin-right:90px;' class='dictate_speech dictate_right'>\" + dictate_targetWordsCode + \"</div>\";\n      code += \"</div>\";\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_game\").append(code);\n      var newreply = $(\".dictate_reply_\" + self.game.pointer);\n      anim.do_animate(newreply,'zoomIn animate__faster','in').then(\n          function(){}\n      );\n      /*\n      $(\".dictate_reply_\" + self.game.pointer).toggle(\"slide\", {\n        direction: 'right'\n      });\n       */\n      $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_ctrl-btn\").prop(\"disabled\", false);\n      setTimeout(function() {\n        $(\".dictate_targetWord\").first().focus();\n        $(\"#\" + self.itemdata.uniqueid + \"_container .dictate_listen_btn\").trigger('click');\n      }, 500);\n    },\n\n    // Stop audio .. usually when leaving the item or sentence\n    stop_audio: function(){\n      var self =this;\n      //pause audio if its playing\n      var theaudio = self.items[self.game.pointer].audio;\n      if(theaudio && !theaudio.paused) {\n        theaudio.pause();\n      }\n    }\n\n  };\n});"],"names":["define","$","log","ajax","def","polly","anim","templates","debug","clone","extend","this","usevoice","init","index","itemdata","quizhelper","animopts","useanimatecss","register_events","setvoice","getItems","next_question","stepdata","hasgrade","totalitems","items","length","correctitems","filter","e","correct","grade","Math","round","stop_audio","do_next","show_item_review","review_data","gamebox","uniqueid","controlsbox","recorderbox","resultsbox","render","then","html","js","show","hide","runTemplateJS","self","on","start","game","pointer","audio","load","play","prop","text","displayprompt","each","realidx","data","dictate_targetWord","dictate_targetWords","val","setTimeout","answered","nextPrompt","end","check_answer","which","target","srcElement","maxLength","parseInt","attributes","value","myLength","key","nextIdx","next","focus","previousIdx","previous","passage","transcript","hasClass","getComparison","comparison","gotComparison","voiceoption","text_items","sentences","map","sentence","trim","split","spliton_regexp","prompt","typed","audiourl","imageurl","item","Audio","src","appReady","console","removeClass","matched","addClass","forEach","obj","wordnumber","thereply","do_animate","getWords","thetext","chunks","words","i","match","push","callback","comparePassageToTranscript","language","ajaxresult","payloadobject","JSON","parse","updateProgressDots","showitemreview","spoken","dots","replace","nopunc_regexp","nonspaces_regexp","code","newprompt","nextReply","color","progress","idx","join","dictate_targetWordsCode","word","append","newreply","first","trigger","theaudio","paused","pause"],"mappings":"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"}