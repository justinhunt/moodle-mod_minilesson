define ("mod_minilesson/activitycontroller",["jquery","core/log","mod_minilesson/definitions","mod_minilesson/quizhelper","mod_minilesson/pollyhelper","core/modal_factory","core/modal_events","core/str"],function(a,b,c,d,e,f,g,h){"use strict";b.debug("Activity controller: initialising");return{cmid:null,activitydata:null,sorryboxid:null,controls:null,init:function init(c){var d=this,f="#amdopts_"+c.widgetid,g=a(f).get(0);if(g){d.activitydata=JSON.parse(g.value);a(f).remove()}else{b.debug("MiniLesson activity Controller: No config found on page. Giving up.");return}d.cmid=c.cmid;d.attemptid=1;d.sorryboxid=c.widgetid+"_sorrybox";e.init(d.activitydata.token,d.activitydata.region,d.activitydata.owner,d.activitydata.cloudpoodllurl);d.register_events();d.process_html();d.doquizlayout()},process_html:function process_html(){var b=this.activitydata,c={introbox:a(".mod_intro_box"),quizcontainer:a("."+b.quizcontainer),feedbackcontainer:a("."+b.feedbackcontainer),errorcontainer:a("."+b.errorcontainer),instructionscontainer:a("."+b.instructionscontainer),wheretonextcontainer:a("."+b.wheretonextcontainer),placeholder:a(".mod_minilesson_placeholder")};this.controls=c},register_events:function register_events(){},doquizlayout:function doquizlayout(){var a=this;a.controls.instructionscontainer.hide();d.init(a.controls.quizcontainer,this.activitydata,this.cmid,this.attemptid,e);a.controls.placeholder.hide();a.controls.quizcontainer.show()},doerrorlayout:function doerrorlayout(){this.controls.errorcontainer.show();this.controls.wheretonextcontainer.show()},continueconfirmation:function continueconfirmation(a){var b=document.querySelector(a);if(!b){return}b.addEventListener("click",function(a){a.preventDefault();var c=b.form;if(!c){return}h.get_strings([{key:"confirmation",component:"core_admin"},{key:"confirmactionmessage",component:"mod_minilesson"},{key:"ok",component:"moodle"}]).then(function(a){f.create({type:f.types.SAVE_CANCEL,title:a[0],body:a[1],buttons:{save:a[2]}}).then(function(a){a.getRoot().on(g.save,function(){var a=document.createElement("input");a.type="hidden";a.name=b.getAttribute("name");a.value=b.getAttribute("value");c.appendChild(a);c.submit()});a.show()})})})}}});
//# sourceMappingURL=activitycontroller.min.js.map
