{"version":3,"file":"freewriting.min.js","sources":["../src/freewriting.js"],"sourcesContent":["define([\n    'jquery', 'core/log', 'core/str', 'core/notification', 'mod_minilesson/definitions', 'mod_minilesson/correctionsmarkup', 'core/templates', 'mod_minilesson/external/simplekeyboard', 'mod_minilesson/external/keyboardlayouts'],\n    function ($, log, str, notification, def, correctionsmarkup, templates, SimpleKeyboard, KeyboardLayouts) {\n        \"use strict\"; // jshint ;_;\n\n        /*\n        This file is to manage the free writing item type\n        */\n\n        log.debug('MiniLesson FreeWriting: initialising');\n\n        return {\n\n            transcript_evaluation: null,\n            rawscore: 0,\n            percentscore: 0,\n            strings: {},\n\n            //for making multiple instances\n            clone: function () {\n                return $.extend(true, {}, this);\n            },\n\n            init: function (index, itemdata, quizhelper) {\n                this.itemdata = itemdata;\n                log.debug('itemdata', itemdata);\n                this.quizhelper = quizhelper;\n                this.init_strings();\n                this.init_components(quizhelper, itemdata);\n                this.register_events(index, itemdata, quizhelper);\n            },\n\n            init_strings: function () {\n                var self = this;\n                str.get_strings([\n                    { \"key\": \"notsubmitted\", \"component\": 'mod_minilesson' },\n                    { \"key\": \"notsubmit\", \"component\": 'mod_minilesson' },\n                    { \"key\": \"submitnow\", \"component\": 'mod_minilesson' },\n                    { \"key\": \"cancel\", \"component\": 'core' },\n                ]).done(function (s) {\n                    var i = 0;\n                    self.strings.notsubmitted = s[i++];\n                    self.strings.notsubmit = s[i++];\n                    self.strings.submitnow = s[i++];\n                    self.strings.cancel = s[i++];\n                });\n            },\n\n            next_question: function () {\n                var self = this;\n                var stepdata = {};\n                stepdata.index = self.index;\n                stepdata.hasgrade = true;\n                stepdata.totalitems = self.itemdata.totalmarks;\n                stepdata.lessonitemid = self.itemdata.id;\n                stepdata.correctitems = self.rawscore > 0 ? self.rawscore : 0;\n                stepdata.grade = self.percentscore;\n                stepdata.resultsdata = self.transcript_evaluation;\n                self.quizhelper.do_next(stepdata);\n            },\n\n            calculate_score: function (transcript_evaluation) {\n                var self = this;\n\n                if (transcript_evaluation === null) {\n                    return 0;\n                }\n\n                //words ratio\n                var wordsratio = 1;\n                if (self.itemdata.countwords) {\n                    wordsratio = transcript_evaluation.stats.words / self.itemdata.targetwordcount;\n                    if (wordsratio > 1) {\n                        wordsratio = 1;\n                    }\n                }\n\n                //relevance\n                var relevanceratio = 1;\n                if (self.itemdata.relevance > 0) {\n                    relevanceratio = (transcript_evaluation.stats.relevance + 10) / 100;\n                    if (relevanceratio > 1) {\n                        relevanceratio = 1;\n                    }\n                }\n                //calculate score based on AI grade * relevance * wordcount\n                var score = Math.round(transcript_evaluation.marks * relevanceratio * wordsratio);\n                return score;\n            },\n\n            register_events: function (index, itemdata, quizhelper) {\n\n                var self = this;\n                self.index = index;\n                self.quizhelper = quizhelper;\n\n                self.nextbutton.on('click', function (e) {\n                    e.preventDefault();\n                    var wordcount = self.quizhelper.count_words(self.thetextarea.val());\n                    var submitted = self.transcript_evaluation !== null;\n                    if (submitted || wordcount === 0) {\n                        self.next_question();\n                    } else {\n                        notification.confirm(\n                            self.strings.notsubmit,\n                            self.strings.notsubmitted,\n                            self.strings.submitnow,\n                            '',\n                            function () {\n                                self.submitbutton.click();\n                            }\n                        );\n                    }\n                });\n\n                if (self.itemdata.enablevkeyboard && self.itemdata.enablevkeyboard != '0') {\n                    var KeyboardClass = SimpleKeyboard.default || SimpleKeyboard;\n\n                    var keyboardConfig = {\n                        onChange: input => self.onChange(input),\n                        onKeyPress: button => self.onKeyPress(button)\n                    };\n\n                    if (self.itemdata.enablevkeyboard == '2') {\n                        // Custom Layout\n                        var customKeys = self.itemdata.customkeys || \"\";\n                        // 1. Clean up the string (remove extra spaces)\n                        var charArray = customKeys.split(' ').filter(c => c.trim() !== \"\");\n                        // If no spaces, and not empty, split by character\n                        if (charArray.length === 0 && customKeys.trim().length > 0) {\n                            charArray = customKeys.trim().split('');\n                        }\n\n                        // 2. Map to uppercase\n                        var upperArray = charArray.map(c => c.toUpperCase());\n\n                        // 3. Join back into the format simple-keyboard expects\n                        var lowerRow = charArray.join(' ') + ' {shift}';\n                        var upperRow = upperArray.join(' ') + ' {shift}';\n\n                        keyboardConfig.layout = {\n                            'default': [lowerRow],\n                            'shift': [upperRow]\n                        };\n                        keyboardConfig.display = {\n                            '{shift}': 'â‡§'\n                        };\n                        keyboardConfig.useStandardCaps = false;\n                        keyboardConfig.mergeDisplay = true;\n\n                    } else {\n                        // Standard Language Layout\n                        var LayoutsClass = KeyboardLayouts.default || KeyboardLayouts;\n                        var keyboardLayouts = new LayoutsClass();\n                        var layoutName = self.get_keyboard_layout(self.itemdata.language);\n                        var layout = keyboardLayouts.get(layoutName);\n                        $.extend(keyboardConfig, layout);\n                    }\n\n                    self.keyboard = new KeyboardClass(\".simple-keyboard-\" + self.itemdata.uniqueid, keyboardConfig);\n\n                    self.keyboardtoggle.on('click', function (e) {\n                        var kbContainers = self.container.find(\".simple-keyboard-\" + self.itemdata.uniqueid);\n                        if (kbContainers.is(\":visible\")) {\n                            kbContainers.hide();\n                        } else {\n                            kbContainers.show();\n                        }\n                    });\n\n                    self.thetextarea.on('input', function (e) {\n                        self.keyboard.setInput(e.target.value);\n                    });\n                }\n\n                self.thetextarea.on('input', function (e) {\n                    e.preventDefault();\n                    var wordcount = self.quizhelper.count_words(self.thetextarea.val());\n                    self.wordcount.text(wordcount);\n                });\n\n                if (self.itemdata.nopasting > 0) {\n                    self.thetextarea.bind(\"cut copy paste\", function (e) {\n                        e.preventDefault();\n                    });\n                    self.thetextarea.bind(\"contextmenu\", function (e) {\n                        e.preventDefault();\n                    });\n                }\n\n                self.submitbutton.on('click', function (e) {\n                    e.preventDefault();\n                    var transcript = self.thetextarea.val();\n                    //update the wordcount\n                    var wordcount = self.quizhelper.count_words(transcript);\n                    self.wordcount.text(wordcount);\n\n                    self.do_evaluation(transcript);\n                });\n\n                $(\"#\" + itemdata.uniqueid + \"_container\").on(\"showElement\", () => {\n                    if (itemdata.timelimit > 0) {\n                        $(\"#\" + itemdata.uniqueid + \"_container .progress-container\").show();\n                        $(\"#\" + itemdata.uniqueid + \"_container .progress-container i\").show();\n                        $(\"#\" + itemdata.uniqueid + \"_container .progress-container #progresstimer\").progressTimer({\n                            height: '5px',\n                            timeLimit: itemdata.timelimit,\n                            onFinish: function () {\n                                self.ontimelimitreached();\n                            }\n                        });\n                    }\n                });\n\n            },\n\n            ontimelimitreached: function () {\n                var self = this;\n                var submitted = self.transcript_evaluation !== null;\n                var wordcount = self.quizhelper.count_words(self.thetextarea.val());\n                if (wordcount == 0) {\n                    self.next_question();\n                } else if (!submitted) {\n                    self.submitbutton.click();\n                }\n            },\n\n            init_components: function (quizhelper, itemdata) {\n                var self = this;\n                self.container = $(\"#\" + self.itemdata.uniqueid + \"_container\");\n                self.allwords = $(\"#\" + self.itemdata.uniqueid + \"_container.mod_minilesson_mu_passage_word\");\n                self.submitbutton = $(\"#\" + itemdata.uniqueid + \"_container .ml_freewriting_submitbutton\");\n                self.nextbutton = $(\"#\" + itemdata.uniqueid + \"_container .minilesson_nextbutton\");\n                self.thetextarea = $(\"#\" + self.itemdata.uniqueid + \"_container .ml_freewriting_textarea\");\n                self.wordcount = $(\"#\" + self.itemdata.uniqueid + \"_container span.ml_wordcount\");\n                self.actionbox = $(\"#\" + self.itemdata.uniqueid + \"_container div.ml_freewriting_actionbox\");\n                self.keyboardtoggle = $(\"#\" + self.itemdata.uniqueid + \"_container .ml_simple_keyboard_toggle\");\n                self.pendingbox = $(\"#\" + self.itemdata.uniqueid + \"_container div.ml_freewriting_pendingbox\");\n                self.resultsbox = $(\"#\" + self.itemdata.uniqueid + \"_container div.ml_freewriting_resultsbox\");\n                self.timerdisplay = $(\"#\" + self.itemdata.uniqueid + \"_container div.ml_freewriting_timerdisplay\");\n                self.iteminstructions = $(\"#\" + self.itemdata.uniqueid + \"_container div.mod_minilesson_iteminstructions\");\n                self.itemtext = $(\"#\" + self.itemdata.uniqueid + \"_container div.mod_minilesson_itemtext\");\n                self.questionheader_contents = $(\"#\" + self.itemdata.uniqueid + \"_container div.minilesson_questionheader_contents\");\n            }, //end of init components\n\n            do_corrections_markup: function (grammarerrors, grammarmatches, insertioncount) {\n                var self = this;\n                //corrected text container is created at runtime, so it wont exist at init_components time\n                //that's why we find it here\n                var correctionscontainer = self.resultsbox.find('.mlfsr_correctedtext');\n\n                correctionsmarkup.init({\n                    \"correctionscontainer\": correctionscontainer,\n                    \"grammarerrors\": grammarerrors,\n                    \"grammarmatches\": grammarmatches,\n                    \"insertioncount\": insertioncount\n                });\n            },\n\n            do_evaluation: function (speechtext) {\n                var self = this;\n\n                //show a spinner while we do the AI stuff\n                self.resultsbox.hide();\n                self.actionbox.hide();\n                self.pendingbox.show();\n\n                //do evaluation\n                this.quizhelper.evaluateTranscript(speechtext, this.itemdata.itemid).then(function (ajaxresult) {\n                    var transcript_evaluation = JSON.parse(ajaxresult);\n                    if (transcript_evaluation) {\n                        transcript_evaluation.reviewsettings = self.itemdata.reviewsettings;\n                        //calculate raw score and percent score\n                        transcript_evaluation.rawscore = self.calculate_score(transcript_evaluation);\n                        self.rawscore = self.calculate_score(transcript_evaluation);\n                        self.percentscore = 0;\n                        if (self.itemdata.totalmarks > 0) {\n                            self.percentscore = Math.round((self.rawscore / self.itemdata.totalmarks) * 100);\n                        }\n                        if (isNaN(self.percentscore)) {\n                            self.percentscore = 0;\n                        }\n                        //add raw and percent score to trancript_evaluation for mustache\n                        transcript_evaluation.rawscore = self.rawscore;\n                        transcript_evaluation.percentscore = self.percentscore;\n                        transcript_evaluation.rawspeech = speechtext;\n                        transcript_evaluation.maxscore = self.itemdata.totalmarks;\n                        self.transcript_evaluation = transcript_evaluation;\n\n                        var ystarcnt = 0;\n                        var gstarcnt;\n                        const templatedata = Object.assign({}, transcript_evaluation);\n                        if (transcript_evaluation.reviewsettings.showscorestarrating) {\n                            if (self.percentscore == 0) {\n                                ystarcnt = 0;\n                            } else if (self.percentscore < 19) {\n                                ystarcnt = 1;\n                            } else if (self.percentscore < 39) {\n                                ystarcnt = 2;\n                            } else if (self.percentscore < 59) {\n                                ystarcnt = 3;\n                            } else if (self.percentscore < 79) {\n                                ystarcnt = 4;\n                            } else {\n                                ystarcnt = 5;\n                            }\n\n                            gstarcnt = 5 - ystarcnt;\n                            templatedata.yellowstars = new Array(ystarcnt).fill(M.cfg, 0, ystarcnt);\n                            templatedata.graystars = new Array(gstarcnt).fill(M.cfg, 0, gstarcnt);\n                        }\n\n                        log.debug(templatedata);\n\n                        //display results or move next if not show item review\n                        if (!self.quizhelper.showitemreview) {\n                            self.next_question();\n                        } else {\n                            templates.render('mod_minilesson/freewritingresults',Object.assign({}, templatedata)).then(\n                                function (html, js) {\n                                    self.resultsbox.html(html);\n                                    //do corrections markup\n                                    if (transcript_evaluation.hasOwnProperty('grammarerrors')) {\n                                        self.do_corrections_markup(\n                                            transcript_evaluation.grammarerrors,\n                                            transcript_evaluation.grammarmatches,\n                                            transcript_evaluation.insertioncount\n                                        );\n                                    }\n                                    //show and hide\n                                    self.iteminstructions.hide();\n                                    self.itemtext.hide();\n                                    self.questionheader_contents.hide();\n                                    self.resultsbox.show();\n                                    self.pendingbox.hide();\n                                    self.actionbox.hide();\n                                    templates.runTemplateJS(js);\n                                    //reset timer and wordcount on this page, in case reattempt\n                                    self.wordcount.text('0');\n                                    //self.ttrec.timer.reset();\n                                    //var displaytime = self.ttrec.timer.fetch_display_time();\n                                    //self.timerdisplay.html(displaytime);\n                                }\n                            );// End of templates\n                            // progresstimer clear interval when submitted and timelimit not finished\n                            if (self.itemdata.timelimit > 0) {\n                                let progresscontainer = $(\"#\" + self.itemdata.uniqueid + \"_container .progress-container\");\n                                progresscontainer.hide();\n                                var timerelement = $(\"#\" + self.itemdata.uniqueid + \"_container .progress-container #progresstimer\");\n                                var timerinterval = timerelement.attr('timer');\n                                if (timerinterval) {\n                                    clearInterval(timerinterval);\n                                }\n                            }\n                        }//end of show item review or not\n                    } else {\n                        log.debug('transcript_evaluation: oh no it failed');\n                        self.resultsbox.hide();\n                        self.pendingbox.hide();\n                        self.actionbox.show();\n                        self.iteminstructions.show();\n                        self.itemtext.show();\n                        self.questionheader_contents.show();\n                    }\n                });\n            },\n\n            onChange: function (input) {\n                this.thetextarea.val(input);\n                this.thetextarea.trigger('input');\n            },\n\n            onKeyPress: function (button) {\n                var self = this;\n                if (button === \"{shift}\" || button === \"{lock}\") {\n                    var currentLayout = self.keyboard.options.layoutName;\n                    var shiftToggle = currentLayout === \"default\" ? \"shift\" : \"default\";\n\n                    self.keyboard.setOptions({\n                        layoutName: shiftToggle\n                    });\n\n                    var kbContainers = self.container.find(\".simple-keyboard-\" + self.itemdata.uniqueid);\n                    if (shiftToggle === \"shift\") {\n                        kbContainers.addClass(\"vkeyboard-shifted\");\n                    } else {\n                        kbContainers.removeClass(\"vkeyboard-shifted\");\n                    }\n                }\n            },\n\n            get_keyboard_layout: function (lang) {\n                // Use first two letters of language code (e.g. en from en-US)\n                var langCode = lang.substring(0, 2).toLowerCase();\n                switch (langCode) {\n                    case 'en': return 'english';\n                    case 'de': return 'german';\n                    case 'es': return 'spanish';\n                    case 'fr': return 'french';\n                    case 'it': return 'italian';\n                    case 'ja': return 'japanese';\n                    case 'ko': return 'korean';\n                    case 'pt': return 'portuguese';\n                    case 'ru': return 'russian';\n                    case 'tr': return 'turkish';\n                    case 'uk': return 'ukrainian';\n                    case 'zh': return 'chinese';\n                    case 'ar': return 'arabic';\n                    case 'el': return 'greek';\n                    case 'he': return 'hebrew';\n                    case 'hi': return 'hindi';\n                    case 'th': return 'thai';\n                    case 'ur': return 'urdu';\n                    default: return 'english';\n                }\n            }\n        };\n    });"],"names":["define","$","log","str","notification","def","correctionsmarkup","templates","SimpleKeyboard","KeyboardLayouts","debug","transcript_evaluation","rawscore","percentscore","strings","clone","extend","this","init","index","itemdata","quizhelper","init_strings","init_components","register_events","self","get_strings","done","s","i","notsubmitted","notsubmit","submitnow","cancel","next_question","stepdata","hasgrade","totalitems","totalmarks","lessonitemid","id","correctitems","grade","resultsdata","do_next","calculate_score","wordsratio","countwords","stats","words","targetwordcount","relevanceratio","relevance","Math","round","marks","nextbutton","on","e","preventDefault","wordcount","count_words","thetextarea","val","confirm","submitbutton","click","enablevkeyboard","KeyboardClass","default","keyboardConfig","onChange","input","onKeyPress","button","customKeys","customkeys","charArray","split","filter","c","trim","length","upperArray","map","toUpperCase","lowerRow","join","upperRow","layout","display","useStandardCaps","mergeDisplay","keyboardLayouts","layoutName","get_keyboard_layout","language","get","keyboard","uniqueid","keyboardtoggle","kbContainers","container","find","is","hide","show","setInput","target","value","text","nopasting","bind","transcript","do_evaluation","timelimit","progressTimer","height","timeLimit","onFinish","ontimelimitreached","submitted","allwords","actionbox","pendingbox","resultsbox","timerdisplay","iteminstructions","itemtext","questionheader_contents","do_corrections_markup","grammarerrors","grammarmatches","insertioncount","correctionscontainer","speechtext","evaluateTranscript","itemid","then","ajaxresult","JSON","parse","reviewsettings","isNaN","rawspeech","maxscore","gstarcnt","ystarcnt","templatedata","Object","assign","showscorestarrating","yellowstars","Array","fill","M","cfg","graystars","showitemreview","render","html","js","hasOwnProperty","runTemplateJS","timerinterval","attr","clearInterval","trigger","shiftToggle","options","setOptions","addClass","removeClass","lang","substring","toLowerCase"],"mappings":"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"}