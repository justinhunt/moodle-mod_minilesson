{"version":3,"file":"listenrepeat.min.js","sources":["../src/listenrepeat.js"],"sourcesContent":["define(['jquery',\n      'core/log',\n      'core/ajax',\n      'mod_minilesson/definitions',\n      'mod_minilesson/pollyhelper',\n      'mod_minilesson/ttrecorder',\n      'mod_minilesson/animatecss',\n      'core/templates'\n    ], function($, log, ajax, def, polly, ttrecorder, anim, templates) {\n  \"use strict\"; // jshint ;_;\n\n  log.debug('MiniLesson listen and repeat: initialising');\n\n  return {\n\n      //a handle on the tt recorder\n      ttrec: null,\n\n      //for making multiple instances\n      clone: function () {\n          return $.extend(true, {}, this);\n      },\n\n      init: function(index, itemdata, quizhelper) {\n        var self = this;\n        var theCallback = function(message) {\n\n            switch (message.type) {\n                case 'recording':\n                    break;\n\n                case 'speech':\n                    log.debug(\"speech at listen_repeat\");\n                    //var wordcount = quizhelper.count_words(message.capturedspeech);\n                    self.getComparison(\n                        self.items[self.game.pointer].target,\n                        message.capturedspeech,\n                        self.items[self.game.pointer].phonetic,\n                        function(comparison) {\n                            self.gotComparison(comparison, message);\n                        }\n                    );\n                    break;\n\n            }\n\n        };\n\n        if(quizhelper.use_ttrecorder()) {\n            var opts = {};\n            opts.uniqueid = itemdata.uniqueid;\n            opts.callback = theCallback;\n            opts.stt_guided=quizhelper.is_stt_guided();\n            opts.wwwroot=quizhelper.is_stt_guided();\n            self.ttrec = ttrecorder.clone();\n            self.ttrec.init(opts);\n        }else{\n            //init cloudpoodll push recorder\n            cloudpoodll.init('minilesson-recorder-listenrepeat-' + itemdata.id, theCallback);\n        }\n\n        self.itemdata = itemdata;\n        self.quizhelper = quizhelper;\n        self.index = index;\n\n        //anim\n        var animopts = {};\n        animopts.useanimatecss= quizhelper.useanimatecss;\n        anim.init(animopts);\n\n        self.register_events();\n        self.setvoice();\n        self.getItems();\n    },\n\n    next_question:function(percent){\n      var self=this;\n      var stepdata = {};\n      stepdata.index = self.index;\n      stepdata.hasgrade = true;\n      stepdata.totalitems=self.items.length;\n      stepdata.correctitems=self.items.filter(function(e) {return e.correct;}).length;\n      stepdata.grade = Math.round((stepdata.correctitems/stepdata.totalitems)*100);\n      self.quizhelper.do_next(stepdata);\n    },\n\n    show_item_review:function(){\n      var self=this;\n      var review_data = {};\n      review_data.items = self.items;\n      review_data.totalitems=self.items.length;\n      review_data.correctitems=self.items.filter(function(e) {return e.correct;}).length;\n\n      //display results\n      var gamebox= $(\"#\" + self.itemdata.uniqueid + \"_container .landr_game\");\n      var controlsbox = $(\"#\" + self.itemdata.uniqueid + \"_container .landr_controls\");\n      var recorderbox = $(\"#\" + self.itemdata.uniqueid + \"_container .landr_speakbtncontainer\");\n      var resultsbox = $(\"#\" + self.itemdata.uniqueid + \"_container .landr_resultscontainer\");\n      templates.render('mod_minilesson/listitemresults',review_data).then(\n        function(html,js){\n            resultsbox.html(html);\n            //show and hide\n            resultsbox.show();\n            gamebox.hide();\n            controlsbox.hide();\n            recorderbox.hide();\n            // Run js for audio player events\n            templates.runTemplateJS(js);\n        }\n      );// End of templates\n    },\n\n    register_events: function() {\n\n      var self = this;\n      //on next button click\n      $(\"#\" + self.itemdata.uniqueid + \"_container .minilesson_nextbutton\").on('click', function(e) {\n        self.next_question();\n      });\n      //on start button click\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_start_btn\").on(\"click\", function() {\n        self.start();\n      });\n      //on listen button click\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_listen_btn\").on(\"click\", function() {\n        self.items[self.game.pointer].audio.load();\n        self.items[self.game.pointer].audio.play();\n      });\n      //on skip button click\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_skip_btn\").on(\"click\", function() {\n        //disable the buttons\n        $(\"#\" + self.itemdata.uniqueid + \"_container .landr_ctrl-btn\").prop(\"disabled\", true);\n        //reveal the prompt\n        $(\"#\" + self.itemdata.uniqueid + \"_container .landr_speech.landr_teacher_left\").text(self.items[self.game.pointer].displayprompt + \"\");\n        //reveal the answer\n        $(\"#\" + self.itemdata.uniqueid + \"_container .landr_targetWord\").each(function() {\n          var realidx = $(this).data(\"realidx\");\n          var landr_targetWord = self.items[self.game.pointer].landr_targetWords[realidx];\n          $(this).val(landr_targetWord);\n        });\n\n        //mark as answered and incorrect\n        self.items[self.game.pointer].answered = true;\n        self.items[self.game.pointer].correct = false;\n\n        //next prompt or end\n        if (self.game.pointer < self.items.length - 1) {\n          //move on after short time to next prompt\n          setTimeout(function() {\n            self.game.pointer++;\n            self.nextPrompt();\n          }, 2200);\n        //end question\n        } else {\n          self.end();\n        }\n      });\n      \n    },\n    \n\n    game: {\n      pointer: 0\n    },\n    usevoice: '',\n    setvoice: function() {\n            var self = this;\n            self.usevoice = self.itemdata.usevoice;\n            self.voiceoption=self.itemdata.voiceoption;\n            return;\n    },\n    getItems: function() {\n      var self = this;\n      var text_items = self.itemdata.sentences;\n\n      self.items = text_items.map(function(target) {\n        return {\n          landr_targetWords: target.sentence.trim().split(self.quizhelper.spliton_regexp).filter(function(e) {\n            return e !== \"\";\n          }),\n          target: target.sentence,\n          prompt: target.prompt,\n          displayprompt: target.displayprompt,\n          phonetic: target.phonetic,\n          typed: \"\",\n          answered: false,\n          correct: false,\n          audio: null,\n          audiourl: target.audiourl ? target.audiourl : \"\",\n          imageurl: target.imageurl,\n        };\n      }).filter(function(e) {\n        return e.target !== \"\";\n      });\n\n\n      $.each(self.items, function(index, item) {\n          item.audio = new Audio();\n          item.audio.src = item.audiourl;\n          if (self.items.filter(function(e) {\n              return e.audio === null;\n            }).length === 0) {\n            self.appReady();\n          }\n      });\n    },\n    \n    appReady: function() {\n      var self = this;\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_not_loaded\").hide();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_loaded\").show();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_start_btn\").prop(\"disabled\", false);\n    },\n    gotComparison: function(comparison, typed) {\n      var self = this;\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_targetWord\").removeClass(\"landr_correct landr_incorrect\");\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_feedback\").removeClass(\"fa fa-check fa-times\");\n\n      var allCorrect = comparison.filter(function(e){return !e.matched;}).length==0;\n      \n      if (allCorrect && comparison && comparison.length>0) {\n        \n        $(\"#\" + self.itemdata.uniqueid + \"_container .landr_targetWord\").addClass(\"landr_correct\");\n        $(\"#\" + self.itemdata.uniqueid + \"_container .landr_feedback\").addClass(\"fa fa-check\");\n        $(\"#\" + self.itemdata.uniqueid + \"_container .landr_speech.landr_teacher_left\").text(self.items[self.game.pointer].displayprompt + \"\");\n\n        self.items[self.game.pointer].answered = true;\n        self.items[self.game.pointer].correct = true;\n        self.items[self.game.pointer].typed = typed;\n\n        $(\"#\" + self.itemdata.uniqueid + \"_container .landr_ctrl-btn\").prop(\"disabled\", true);\n        if (self.game.pointer < self.items.length - 1) {\n          setTimeout(function() {\n            self.game.pointer++;\n            self.nextPrompt();\n          }, 2200);\n        } else {\n            self.end();\n        }\n\n      } else {\n        //mark up the words as correct or not\n        comparison.forEach(function(obj) {\n          if(!obj.matched){\n            $(\"#\" + self.itemdata.uniqueid + \"_container .landr_targetWord[data-idx='\" + obj.wordnumber + \"']\").addClass(\"landr_incorrect\");\n            $(\"#\" + self.itemdata.uniqueid + \"_container .landr_feedback[data-idx='\" + obj.wordnumber + \"']\").addClass(\"fa fa-times\");\n          } else {\n            $(\"#\" + self.itemdata.uniqueid + \"_container .landr_targetWord[data-idx='\" + obj.wordnumber + \"']\").addClass(\"landr_correct\");\n            $(\"#\" + self.itemdata.uniqueid + \"_container .landr_feedback[data-idx='\" + obj.wordnumber + \"']\").addClass(\"fa fa-check\");\n          }\n        });\n        var thereply = $(\"#\" + self.itemdata.uniqueid + \"_container .landr_reply_\" + self.game.pointer);\n        anim.do_animate(thereply,'shakeX animate__faster').then(\n          function(){$(\"#\" + self.itemdata.uniqueid + \"_container .landr_ctrl-btn\").prop(\"disabled\", false);}\n        );\n        //shake the screen\n        /*\n        $(\"#\" + self.itemdata.uniqueid + \"_container .landr_reply_\" + self.game.pointer).effect(\"shake\", function() {\n          $(\"#\" + self.itemdata.uniqueid + \"_container .landr_ctrl-btn\").prop(\"disabled\", false);\n        });\n\n         */\n\n      }\n      //show all the correct words\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_targetWord.landr_correct\").each(function() {\n        var realidx = $(this).data(\"realidx\");\n        var landr_targetWord = self.items[self.game.pointer].landr_targetWords[realidx];\n        $(this).val(landr_targetWord);\n      });\n\n    },\n    getWords: function(thetext) {\n      var self = this;\n      var checkcase = false;\n      if (checkcase == 'false') {\n        thetext = thetext.toLowerCase();\n      }\n      var chunks = thetext.split(self.quizhelper.spliton_regexp).filter(function(e) {\n        return e !== \"\";\n      });\n      var words = [];\n      for (var i = 0; i < chunks.length; i++) {\n        if (!chunks[i].match(self.quizhelper.spliton_regexp)) {\n          words.push(chunks[i]);\n        }\n      }\n      return words;\n    },\n    getComparison: function(passage, transcript, phonetic, callback) {\n      var self = this;\n      \n      $(\".landr_ctrl-btn\").prop(\"disabled\", true);\n      self.quizhelper.comparePassageToTranscript(passage,transcript,phonetic,self.itemdata.language, self.itemdata.alternates).then(function(ajaxresult) {\n            var payloadobject = JSON.parse(ajaxresult);\n            if (payloadobject) {\n                callback(payloadobject);\n            } else {\n                callback(false);\n            }\n       });\n\n    },\n    end: function() {\n      var self = this;\n      $(\".minilesson_nextbutton\").prop(\"disabled\",true);\n      \n      //progress dots are updated on next_item. The last item has no next item, so we update from here\n      self.updateProgressDots();\n      \n      //disable the buttons and go to next question or review\n      setTimeout(function() {\n        $(\".minilesson_nextbutton\").prop(\"disabled\",false);\n        if(self.quizhelper.showitemreview){\n          self.show_item_review();\n        }else{\n          self.next_question();\n        }\n      }, 2200);\n\n    },\n    start: function() {\n      var self = this;\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_ctrl-btn\").prop(\"disabled\", true);\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_speakbtncontainer\").show();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_title\").show();\n\n      self.items.forEach(function(item) {\n        item.spoken = \"\";\n        item.answered = false;\n        item.correct = false;\n      });\n\n      self.game.pointer = 0;\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_game\").show();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_start_btn\").hide();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_mainmenu\").hide();\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_controls\").show();\n\n      self.nextPrompt();\n\n    },\n    nextPrompt: function() {\n      var showText = parseInt(this.itemdata.show_text);\n      var self = this;\n\n      //target is the speech we expect\n      var target = self.items[self.game.pointer].target;\n      //in some cases ttrecorder wants to know the target\n      if(self.quizhelper.use_ttrecorder()) {\n        self.ttrec.currentPrompt=target;\n      }\n      var displayprompt = self.items[self.game.pointer].displayprompt;\n      var code = \"<div class='landr_prompt landr_prompt_\" + self.game.pointer + \"' style='display:none;'>\";\n\n      code += \"<i class='fa fa-graduation-cap landr_speech-icon-left'></i>\";\n      code += \"<div style='margin-left:90px;' class='landr_speech landr_teacher_left'>\";\n      if(!showText){\n        var nopunc = displayprompt.replace(self.quizhelper.nopunc_regexp,\"\");\n        var dots = nopunc.replace(self.quizhelper.nonspaces_regexp, '•');\n        code += dots;\n      } else{\n        code += displayprompt;\n      }\n      code += \"</div>\";\n      code += \"</div>\";\n\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_game\").html(code);\n      $(\".landr_ctrl-btn\").prop(\"disabled\", false);\n\n      self.updateProgressDots();\n\n      var newprompt = $(\".landr_prompt_\" + self.game.pointer);\n      anim.do_animate(newprompt,'zoomIn animate__faster','in').then(\n          function(){}\n      );\n      self.nextReply();\n    },\n\n    updateProgressDots: function() {\n      var self = this;\n      var color;\n      var progress = self.items.map(function(item, idx) {\n        color = \"gray\";\n        if (self.items[idx].answered && self.items[idx].correct) {\n          color = \"green\";\n        } else if (self.items[idx].answered && !self.items[idx].correct) {\n          color = \"red\";\n        }\n        return \"<i style='color:\" + color + \"' class='fa fa-circle'></i>\";\n      }).join(\" \");\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_title\").html(progress);\n    },\n\n    nextReply: function() {\n      var self = this;\n      var target = self.items[self.game.pointer].target;\n      var code = \"<div class='landr_reply landr_reply_\" + self.game.pointer + \"' style='display:none;'>\";\n      code += \"<i class='fa fa-user landr_speech-icon-right'></i>\";\n      var landr_targetWordsCode = \"\";\n      var idx = 1;\n      self.items[self.game.pointer].landr_targetWords.forEach(function(word, realidx) {\n        if (!word.match(self.quizhelper.spliton_regexp)) {\n          landr_targetWordsCode += \"<ruby><input disabled type='text' maxlength='\" + word.length + \"' size='\" + (word.length + 1) + \"' class='landr_targetWord' data-realidx='\" + realidx + \"' data-idx='\" + idx + \"'><rt><i data-idx='\" + idx + \"' class='landr_feedback'></i></rt></ruby>\";\n          idx++;\n\n        } else {\n          landr_targetWordsCode += word;\n        }\n      });\n      code += \"<div style='margin-right:90px;' class='landr_speech landr_right'>\" + landr_targetWordsCode + \"</div>\";\n      code += \"</div>\";\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_game\").append(code);\n      var newreply = $(\".landr_reply_\" + self.game.pointer);\n      anim.do_animate(newreply,'zoomIn animate__faster','in').then(\n          function(){}\n      );\n      /*\n      $(\".landr_reply_\" + self.game.pointer).toggle(\"slide\", {\n        direction: 'right'\n      });\n       */\n      $(\"#\" + self.itemdata.uniqueid + \"_container .landr_ctrl-btn\").prop(\"disabled\", false);\n      if(!self.quizhelper.mobile_user()){\n        setTimeout(function(){\n          $(\"#\" + self.itemdata.uniqueid + \"_container .landr_listen_btn\").trigger('click');\n        },1000);\n      }\n    }\n\n  };\n});"],"names":["define","$","log","ajax","def","polly","ttrecorder","anim","templates","debug","ttrec","clone","extend","this","init","index","itemdata","quizhelper","self","theCallback","message","type","getComparison","items","game","pointer","target","capturedspeech","phonetic","comparison","gotComparison","use_ttrecorder","opts","uniqueid","callback","stt_guided","is_stt_guided","wwwroot","cloudpoodll","id","animopts","useanimatecss","register_events","setvoice","getItems","next_question","percent","stepdata","hasgrade","totalitems","length","correctitems","filter","e","correct","grade","Math","round","do_next","show_item_review","review_data","gamebox","controlsbox","recorderbox","resultsbox","render","then","html","js","show","hide","runTemplateJS","on","start","audio","load","play","prop","text","displayprompt","each","realidx","data","landr_targetWord","landr_targetWords","val","answered","setTimeout","nextPrompt","end","usevoice","voiceoption","text_items","sentences","map","sentence","trim","split","spliton_regexp","prompt","typed","audiourl","imageurl","item","Audio","src","appReady","removeClass","matched","addClass","forEach","obj","wordnumber","thereply","do_animate","getWords","thetext","chunks","words","i","match","push","passage","transcript","comparePassageToTranscript","language","alternates","ajaxresult","payloadobject","JSON","parse","updateProgressDots","showitemreview","spoken","showText","parseInt","show_text","currentPrompt","code","replace","nopunc_regexp","nonspaces_regexp","newprompt","nextReply","color","progress","idx","join","landr_targetWordsCode","word","append","newreply","mobile_user","trigger"],"mappings":"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"}