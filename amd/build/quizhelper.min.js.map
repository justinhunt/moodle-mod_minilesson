{"version":3,"file":"quizhelper.min.js","sources":["../src/quizhelper.js"],"sourcesContent":["define(['jquery', 'core/log', 'mod_minilesson/definitions', 'core/templates', 'core/ajax',\n    'mod_minilesson/dictation', 'mod_minilesson/dictationchat', 'mod_minilesson/multichoice','mod_minilesson/multiaudio',\n        'mod_minilesson/speechcards', 'mod_minilesson/listenrepeat',\n        'mod_minilesson/page','mod_minilesson/smartframe','mod_minilesson/shortanswer',\n        'mod_minilesson/listeninggapfill','mod_minilesson/typinggapfill','mod_minilesson/speakinggapfill',\n        'mod_minilesson/spacegame','mod_minilesson/fluency','mod_minilesson/freespeaking',\n        'mod_minilesson/freewriting','mod_minilesson/passagereading','mod_minilesson/h5p',\n        'mod_minilesson/conversation','mod_minilesson/compquiz','mod_minilesson/passagegapfill',\n        'mod_minilesson/audiochat','mod_minilesson/wordshuffle','mod_minilesson/scatter',\n        'mod_minilesson/progresstimer'],\n  function($, log, def, templates, Ajax, dictation, dictationchat, multichoice, multiaudio,\n           speechcards, listenrepeat, page, smartframe, shortanswer,\n           listeninggapfill,typinggapfill, speakinggapfill,\n           spacegame,fluency, freespeaking,freewriting,\n           passagereading,h5p,conversation,compquiz,passagegapfill,\n           audiochat,wordshuffle,scatter, progresstimer) {\n    \"use strict\"; // jshint ;_;\n\n    /*\n    This file is to manage the quiz stage\n     */\n\n    log.debug('MiniLesson Quiz helper: initialising');\n\n    return {\n\n      //original spliton_regexp: new RegExp(/([,.!?:;\" ])/, 'g'),\n        // V2 spliton_regexp new RegExp(/([!\"# ¡¿$%&'()。「」、*+,-.\\/:;<=>?@[\\]^_`{|}~])/, 'g'),\n        //v3 we removed the apostrophe because it was not counting words correcting in listen and speak\n      spliton_regexp: new RegExp(/([!\"# ¡¿$%&()。「」、*+,-.\\/:;<=>?@[\\]^_`{|}~])/, 'g'),\n      //nopunc is diff to split on because it does not match on spaces\n      nopunc_regexp: new RegExp(/[!\"#¡¿$%&'()。「」、*+,-.\\/:;<=>?@[\\]^_`{|}~]/,'g'),\n      nonspaces_regexp: new RegExp(/[^ ]/,'g'),\n      autoplaydelay: 800,\n\n      controls: {},\n      submitbuttonclass: 'mod_minilesson_quizsubmitbutton',\n      stepresults: [],\n\n      init: function(quizcontainer, activitydata, cmid, attemptid,polly) {\n        this.quizdata = activitydata.quizdata;\n        this.region = activitydata.region;\n        this.ttslanguage = activitydata.ttslanguage;\n        this.controls.quizcontainer = quizcontainer;\n        this.attemptid = attemptid;\n        this.courseurl = activitydata.courseurl;\n        this.cmid = cmid;\n        this.reattempturl = decodeURIComponent(activitydata.reattempturl).replace(/&amp;/g, \"&\");\n        this.activityurl = decodeURIComponent(activitydata.activityurl).replace(/&amp;/g, \"&\");\n        this.backtocourse = activitydata.backtocourse;\n        this.stt_guided = activitydata.stt_guided;\n        this.wwwroot = activitydata.wwwroot;\n        this.useanimatecss  = activitydata.useanimatecss;\n        this.showitemreview  = activitydata.showitemreview;\n\n        this.prepare_html();\n        this.init_questions(this.quizdata,polly);\n        this.register_events();\n        this.start_quiz();\n      },\n\n      prepare_html: function() {\n\n        // this.controls.quizcontainer.append(submitbutton);\n        this.controls.quizfinished=$(\"#mod_minilesson_quiz_finished\");\n\n      },\n\n      init_questions: function(quizdata, polly) {\n        var dd = this;\n        $.each(quizdata, function(index, item) {\n          switch (item.type) {\n            case def.qtype_dictation:\n              dictation.clone().init(index, item, dd, polly);\n              break;\n            case def.qtype_dictationchat:\n              dictationchat.clone().init(index, item, dd, polly);\n              break;\n            case def.qtype_multichoice:\n              multichoice.clone().init(index, item, dd);\n              break;\n            case def.qtype_multiaudio:\n                multiaudio.clone().init(index, item, dd);\n                break;\n            case def.qtype_speechcards:\n              //speechcards init needs to occur when it is visible. lame.\n              // so we do that in do_next function, down below\n              speechcards.clone().init(index, item, dd);\n              break;\n            case def.qtype_listenrepeat:\n              listenrepeat.clone().init(index, item, dd);\n              break;\n\n             case def.qtype_page:\n                  page.clone().init(index, item, dd);\n                  break;\n\n              case def.qtype_smartframe:\n                  smartframe.clone().init(index, item, dd);\n                  break;\n\n              case def.qtype_shortanswer:\n                  shortanswer.clone().init(index, item, dd);\n                  break;\n\n              case def.qtype_listeninggapfill:\n                  listeninggapfill.clone().init(index, item, dd);\n                  break;\n\n              case def.qtype_typinggapfill:\n                  typinggapfill.clone().init(index, item, dd);\n                  break;\n\n              case def.qtype_speakinggapfill:\n                  speakinggapfill.clone().init(index, item, dd);\n                  break;\n\n              case def.qtype_spacegame:\n                spacegame.clone().init(index, item, dd);\n                break;    \n\n              case def.qtype_fluency:\n                  fluency.clone().init(index, item, dd);\n                  break;\n\n              case def.qtype_freespeaking:\n                freespeaking.clone().init(index, item, dd);\n                break;\n                \n              case def.qtype_freewriting:\n                freewriting.clone().init(index, item, dd);\n                break;\n\n              case def.qtype_passagereading:\n                passagereading.clone().init(index, item, dd);\n                break;\n                  \n              case def.qtype_h5p:\n                h5p.clone().init(index, item, dd);\n                break;\n                \n              case def.qtype_conversation:\n                conversation.clone().init(index, item, dd);\n                break;\n\n              case def.qtype_compquiz:\n                compquiz.clone().init(index, item, dd);\n                break;\n\n              case def.qtype_passagegapfill:\n                  passagegapfill.clone().init(index, item, dd);\n                  break;\n\n              case def.qtype_audiochat:\n                  audiochat.clone().init(index, item, dd);\n                  break;\n\n              case def.qtype_wordshuffle:\n                  wordshuffle.clone().init(index, item, dd);\n                  break;\n\n              case def.qtype_scatter:\n                  scatter.clone().init(index, item, dd);\n                  break;\n          }\n\n        });\n\n        //TTS in question headers\n          $(\"audio.mod_minilesson_itemttsaudio\").each(function(){\n              var that=this;\n              polly.fetch_polly_url($(this).data('text'), $(this).data('ttsoption'), $(this).data('voice')).then(function(audiourl) {\n                  $(that).attr(\"src\", audiourl);\n              });\n          });\n\n      },\n\n      register_events: function() {\n        $('.' + this.submitbuttonclass).on('click', function() {\n          //do something\n        });\n      },\n      render_quiz_progress:function(current,total){\n        var array = [];\n        for(var i=0;i<total;i++){\n          array.push(i);\n        }\n\n        if (total <= 1) {\n          $(\".minilesson_quiz_progress\").hide();\n          return;\n        }\n\n        if(total<6) {\n            var slice = array.slice(0, 5);\n            var linestyles = \"width: \" + (100 - 100 / slice.length) + \"%; margin-left: auto; margin-right: auto\";\n            var html = \"<div class='minilesson_quiz_progress_line' style='\" + linestyles + \"'></div>\";\n\n            slice.forEach(function (i) {\n                html += \"<div class='minilesson_quiz_progress_item \" + (i === current ? 'minilesson_quiz_progress_item_current' : '') + \" \" + (i < current ? 'minilesson_quiz_progress_item_completed' : '') + \"'>\" + (i + 1) + \"</div>\";\n            });\n        }else {\n             if(current > total-6){\n                 var slice = array.slice(total-5, total-1);\n             }else{\n                 var slice = array.slice(current, current + 4);\n             }\n\n              //if first item is visible then no line trailing left of item 1\n              if(current==0){\n                  var linestyles = \"width: 80%; margin-left: auto; margin-right: auto\";\n              }else {\n                  var linestyles = \"width: \" + (100 - 100 / (2 *slice.length)) + \"%; margin-left: 0\";\n              }\n            var html = \"<div class='minilesson_quiz_progress_line' style='\" + linestyles + \"'></div>\";\n              slice.forEach(function (i) {\n                  html += \"<div class='minilesson_quiz_progress_item \" + (i === current ? 'minilesson_quiz_progress_item_current' : '') + \" \" + (i < current ? 'minilesson_quiz_progress_item_completed' : '') + \"'>\" + (i + 1) + \"</div>\";\n              });\n              //end marker\n            html += \"<div class='minilesson_quiz_progress_finalitem'>\" + (total) + \"</div>\";\n          }\n\n        html+=\"\";\n        $(\".minilesson_quiz_progress\").html(html);\n\n      },\n\n      do_next: function(stepdata){\n        var dd = this;\n        //get current question\n        var currentquizdataindex =   stepdata.index;\n        var currentitem = this.quizdata[currentquizdataindex];\n        //in preview mode do no do_next\n        if(currentitem.preview===true){return;}\n\n        //post grade\n         // log.debug(\"reporting step grade\");\n        dd.report_step_grade(stepdata);\n         // log.debug(\"reported step grade\");\n\n        //show next question or End Screen\n        if (dd.quizdata.length > currentquizdataindex+1) {\n          // we want to hide current question - before show new one\n          var theoldquestion = $(\"#\" + currentitem.uniqueid + \"_container\");\n          theoldquestion.hide();\n\n          var nextindex = currentquizdataindex+ 1;\n          var nextitem = this.quizdata[nextindex];\n            //show the question\n            $(\"#\" + nextitem.uniqueid + \"_container\").show().trigger(\"showElement\");\n          //any per question type init that needs to occur can go here\n          switch (nextitem.type) {\n              case def.qtype_speechcards:\n                  //speechcards.init(nextindex, nextitem, dd);\n                  break;\n              case def.qtype_dictation:\n              case def.qtype_dictationchat:\n              case def.qtype_multichoice:\n              case def.qtype_multiaudio:\n              case def.qtype_listenrepeat:\n              case def.qtype_smartframe:\n              case def.qtype_shortanswer:\n              case def.qtype_spacegame:\n              case def.qtype_fluency:\n              case def.qtype_freespeaking:\n              case def.qtype_freewriting:\n              case def.qtype_passagereading:\n              case def.qtype_h5p:\n              case def.qtype_conversation:\n              case def.qtype_compquiz:\n              case def.qtype_audiochat:\n              default:\n          }//end of nextitem switch\n\n            //autoplay audio if we need to\n            var ttsquestionplayer = $(\"#\" + nextitem.uniqueid + \"_container audio.mod_minilesson_itemttsaudio\");\n            if(ttsquestionplayer.data('autoplay')==\"1\"){\n                var that=this;\n                setTimeout(function() {ttsquestionplayer[0].play();}, that.autoplaydelay);\n            }\n\n        } else {\n          //just reload and re-fetch all the data to display\n            $(\".minilesson_nextbutton\").prop(\"disabled\", true);\n            window.location.href=dd.activityurl;\n            /*\n            setTimeout(function () {\n                log.debug(\"forwarding to finished page\");\n                window.location.href=dd.activityurl;\n            }, 500);\n            */\n\n          return;\n\n          //no longer do this\n            /*\n          var results = dd.stepresults.filter(function(e){return e.hasgrade;});\n          var correctitems = 0;\n          var totalitems = 0;\n          results.forEach(function(result,i){\n            result.index=i+1;\n            result.title=dd.quizdata[i].title;\n            correctitems += result.correctitems;\n            totalitems += result.totalitems;\n          });\n          var totalpercent = Math.round((correctitems/totalitems)*100);\n          console.log(results,correctitems,totalitems,totalpercent);\n          var finishedparams ={results:results,total:totalpercent, courseurl: this.courseurl};\n          if(this.reattempturl!=''){finishedparams.reattempturl = this.reattempturl;}\n          if(this.backtocourse!=''){finishedparams.backtocourse = true;}\n          templates.render('mod_minilesson/quizfinished',finishedparams).then(\n              function(html,js){\n                  dd.controls.quizfinished.html(html);\n                  dd.controls.quizfinished.show();\n                  templates.runTemplateJS(js);\n              }\n          );\n          */\n\n        }//end of if has more questions\n\n        this.render_quiz_progress(stepdata.index+1,this.quizdata.length);\n\n          //we want to destroy the old question in the DOM also because iframe/media content might be playing\n          theoldquestion.remove();\n        \n      },\n\n      report_step_grade: function(stepdata) {\n        var dd = this;\n\n        //store results locally\n        this.stepresults.push(stepdata);\n\n        //push results to server\n        var isasync = false;\n        var ret = Ajax.call([{\n          methodname: 'mod_minilesson_report_step_grade',\n          args: {\n            cmid: dd.cmid,\n            step: JSON.stringify(stepdata),\n          },\n        }],isasync)[0];\n        log.debug(\"report_step_grade success: \" + ret);\n\n      },\n\n\n\n      start_quiz: function() {\n        $(\"#\" + this.quizdata[0].uniqueid + \"_container\").show().trigger(\"showElement\");\n          //autoplay audio if we need to\n          var ttsquestionplayer = $(\"#\" + this.quizdata[0].uniqueid + \"_container audio.mod_minilesson_itemttsaudio\");\n          if(ttsquestionplayer.data('autoplay')==\"1\"){\n              var that=this;\n              setTimeout(function() {ttsquestionplayer[0].play();}, that.autoplaydelay);\n          }\n        this.render_quiz_progress(0,this.quizdata.length);\n      },\n\n      //this function is overridden by the calling class\n      onSubmit: function() {\n        alert('quiz submitted. Override this');\n      },\n\n        mobile_user: function() {\n\n            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {\n                return true;\n            } else {\n                return false;\n            }\n        },\n\n        chrome_user: function(){\n            if(/Chrome/i.test(navigator.userAgent)) {\n                return true;\n            }else{\n                return false;\n            }\n        },\n\n        //this will always be true these days\n        use_ttrecorder: function(){\n            return true;\n        },\n        is_stt_guided: function(){\n          return this.stt_guided;\n        },\n\n        //count words\n        count_words: function(transcript) {\n          return transcript.trim().split(/\\s+/).filter(function(word) {\n              return word.length > 0;\n          }).length;\n        },\n\n        //text comparison functions follow===============\n\n        similarity: function(s1, s2) {\n            //we remove spaces because JP transcript and passage might be different. And who cares about spaces anyway?\n            s1 = s1.replace(/\\s+/g, '');\n            s2 = s2.replace(/\\s+/g, '');\n\n            var longer = s1;\n            var shorter = s2;\n            if (s1.length < s2.length) {\n                longer = s2;\n                shorter = s1;\n            }\n            var longerLength = longer.length;\n            if (longerLength === 0) {\n                return 100;\n            }\n            return 100 * ((longerLength - this.editDistance(longer, shorter)) / parseFloat(longerLength));\n        },\n        editDistance: function(s1, s2) {\n            s1 = s1.toLowerCase();\n            s2 = s2.toLowerCase();\n\n            var costs = [];\n            for (var i = 0; i <= s1.length; i++) {\n                var lastValue = i;\n                for (var j = 0; j <= s2.length; j++) {\n                    if (i === 0) {\n                        costs[j] = j;\n                    }else {\n                        if (j > 0) {\n                            var newValue = costs[j - 1];\n                            if (s1.charAt(i - 1) !== s2.charAt(j - 1)) {\n                                newValue = Math.min(Math.min(newValue, lastValue),\n                                    costs[j]) + 1;\n                            }\n                            costs[j - 1] = lastValue;\n                            lastValue = newValue;\n                        }\n                    }\n                }\n                if (i > 0) {\n                    costs[s2.length] = lastValue;\n                }\n            }\n            return costs[s2.length];\n        },\n\n        cleanText: function(text) {\n            var lowertext = text.toLowerCase();\n            var punctuationless = lowertext.replace(this.nopunc_regexp,\"\");\n            var ret = punctuationless.replace(/\\s+/g, \" \").trim();\n            return ret;\n        },\n\n        //this will return the promise, the result of which is an integer 100 being perfect match, 0 being no match\n        checkByPhonetic: function(passage, transcript, passagephonetic, language) {\n            return Ajax.call([{\n                methodname: 'mod_minilesson_check_by_phonetic',\n                args: {\n                    'spoken': transcript,\n                    'correct': passage,\n                    'language': language,\n                    'phonetic': passagephonetic,\n                    'region': this.region,\n                    'cmid': this.cmid\n                },\n                async: false\n            }])[0];\n\n        },\n\n       comparePassageToTranscript: function (passage,transcript,passagephonetic,language,alternatives=\"\"){\n          return Ajax.call([{\n               methodname: 'mod_minilesson_compare_passage_to_transcript',\n               args: {\n                   passage: passage,\n                   transcript: transcript,\n                   alternatives: alternatives,\n                   phonetic: passagephonetic,\n                   language: language,\n                   region: this.region,\n                   cmid: this.cmid\n               },\n              async: false\n           }])[0];\n       },\n\n      //this will return the promise, the result of which is an object containing marks, corrections and feedback\n      evaluateTranscript: function(transcript, itemid) {\n        return Ajax.call([{\n            methodname: 'mod_minilesson_evaluate_transcript',\n            args: {\n                'transcript': transcript,\n                'itemid': itemid,\n                'cmid': this.cmid\n            },\n            async: false\n        }])[0];\n      },\n\n    }; //end of return value\n  });\n"],"names":["define","$","log","def","templates","Ajax","dictation","dictationchat","multichoice","multiaudio","speechcards","listenrepeat","page","smartframe","shortanswer","listeninggapfill","typinggapfill","speakinggapfill","spacegame","fluency","freespeaking","freewriting","passagereading","h5p","conversation","compquiz","passagegapfill","audiochat","wordshuffle","scatter","progresstimer","debug","spliton_regexp","RegExp","nopunc_regexp","nonspaces_regexp","autoplaydelay","controls","submitbuttonclass","stepresults","init","quizcontainer","activitydata","cmid","attemptid","polly","quizdata","region","ttslanguage","courseurl","reattempturl","decodeURIComponent","replace","activityurl","backtocourse","stt_guided","wwwroot","useanimatecss","showitemreview","prepare_html","init_questions","this","register_events","start_quiz","quizfinished","dd","each","index","item","type","qtype_dictation","clone","qtype_dictationchat","qtype_multichoice","qtype_multiaudio","qtype_speechcards","qtype_listenrepeat","qtype_page","qtype_smartframe","qtype_shortanswer","qtype_listeninggapfill","qtype_typinggapfill","qtype_speakinggapfill","qtype_spacegame","qtype_fluency","qtype_freespeaking","qtype_freewriting","qtype_passagereading","qtype_h5p","qtype_conversation","qtype_compquiz","qtype_passagegapfill","qtype_audiochat","qtype_wordshuffle","qtype_scatter","that","fetch_polly_url","data","then","audiourl","attr","on","render_quiz_progress","current","total","array","i","push","hide","html","linestyles","slice","length","forEach","do_next","stepdata","currentquizdataindex","currentitem","preview","report_step_grade","prop","window","location","href","theoldquestion","uniqueid","nextindex","nextitem","show","trigger","ttsquestionplayer","setTimeout","play","remove","ret","call","methodname","args","step","JSON","stringify","onSubmit","alert","mobile_user","test","navigator","userAgent","chrome_user","use_ttrecorder","is_stt_guided","count_words","transcript","trim","split","filter","word","similarity","s1","s2","longer","shorter","longerLength","editDistance","parseFloat","toLowerCase","costs","lastValue","j","newValue","charAt","Math","min","cleanText","text","checkByPhonetic","passage","passagephonetic","language","async","comparePassageToTranscript","alternatives","phonetic","evaluateTranscript","itemid"],"mappings":"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"}