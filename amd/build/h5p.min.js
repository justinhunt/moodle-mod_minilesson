define ("mod_minilesson/h5p",["jquery","core/log","mod_minilesson/definitions"],function(a,b){"use strict";b.debug("MiniLesson H5P: initialising");return{clone:function clone(){return a.extend(!0,{correctitems:0,totalitems:0},this)},init:function init(a,c,d){this.itemdata=c;this.register_events(a,c,d);b.debug("MiniLesson H5P URL: "+c.h5purl);b.debug("MiniLesson H5P Total Marks: "+c.totalmarks)},next_question:function next_question(){var a=this,b={};b.index=a.index;b.hasgrade=!0;b.totalitems=a.totalitems;b.correctitems=a.correctitems;b.grade=0<a.totalitems?100*a.correctitems/a.totalitems:0;a.quizhelper.do_next(b)},register_events:function register_events(b,c,d){var e=this;e.index=b;e.quizhelper=d;var f=a("#"+c.uniqueid+"_h5pplayer"),g=a("#"+c.uniqueid+"_container .minilesson_nextbutton");g.on("click",function(){e.next_question()});var h=f.find("iframe")[0];if(h){addEventListener("message",function(a){if(window===a.target&&"h5p"===a.data.context&&!h.getAttribute("data-gradelistener")){h.contentWindow.H5P.externalDispatcher.on("xAPI",function(a){if(0<a.getMaxScore()){console.log("gradehit");e.correctitems=a.getScore();e.totalitems=a.getMaxScore()}});h.setAttribute("data-gradelistener",1)}})}}}});
//# sourceMappingURL=h5p.min.js.map
