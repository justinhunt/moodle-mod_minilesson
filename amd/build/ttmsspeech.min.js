define("mod_minilesson/ttmsspeech",["jquery","core/log"],(function($,log){return log.debug("MS Speech initialising"),{thetoken:null,theregion:null,thelanguage:null,thereferencetext:null,speechsdk:null,clone:function(){return $.extend(!0,{},this)},init:function(mstoken,msregion,mslanguage,referencetext){var that=this;this.thetoken=mstoken,this.theregion=msregion,this.thelanguage=mslanguage,this.thereferencetext=referencetext,log.debug("MS Speech init"),window.hasOwnProperty("SpeechSDK")||(log.debug("MS Speech loading"),$.getScript("https://aka.ms/csspeech/jsbrowserpackageraw",(function(){log.debug("MS Speech loaded"),that.speechsdk=window.SpeechSDK,log.debug(that.speechsdk)})))},updatetoken:function(newtoken){this.thetoken=newtoken},recognize:function(blob,callback){var that=this;blob.name="audio.wav";let audioConfig=that.speechsdk.AudioConfig.fromWavFileInput(blob,blob.name);var speechConfig=that.speechsdk.SpeechConfig.fromAuthorizationToken(that.thetoken,that.theregion);speechConfig.speechRecognitionLanguage=that.thelanguage;var referencetext=that.thereferencetext,paconfig={};paconfig.referenceText=referencetext,paconfig.gradingSystem="HundredMark",paconfig.granularity="Phoneme",paconfig.phonemeAlphabet="IPA",paconfig.enableProsodyAssessment=!0,paconfig.showPhonemeLevelResult=!0,paconfig.enableMiscue=!0;const pronunciationAssessmentConfig=that.speechsdk.PronunciationAssessmentConfig.fromJSON(JSON.stringify(paconfig));var reco=new that.speechsdk.SpeechRecognizer(speechConfig,audioConfig);reco.sessionStarted=(_s,e)=>{console.log("SESSION ID: ".concat(e.sessionId))},pronunciationAssessmentConfig.applyTo(reco),reco.recognizeOnceAsync((function(speechRecognitionResult){var pronunciationAssessmentResult=that.speechsdk.PronunciationAssessmentResult.fromResult(speechRecognitionResult);callback(pronunciationAssessmentResult)}),(function(err){console.log("ERROR: "+err),exit()}))},set_reference_text:function(referencetext){this.thereferencetext=referencetext},on_recognition:function(){}}}));

//# sourceMappingURL=ttmsspeech.min.js.map