define("mod_minilesson/translate",["jquery","core/log"],(function($,log){return{session:null,sourceLang:null,destLang:null,check_availability:async function(sourceLang,destLang){if(!this.is_chrome())return"unavailable";try{if("Translator"in window){switch(await window.Translator.availability({sourceLanguage:sourceLang,targetLanguage:destLang})){case"available":return"ready";case"downloadable":case"downloading":return"download_needed";default:return"unavailable"}}}catch(e){log.error("Availability check failed: "+e.message)}return"unavailable"},create_session:async function(sourceLang,destLang,progressCallback){try{log.debug("Creating translator session: "+sourceLang+" -> "+destLang),log.debug("About to call window.Translator.create()...");const timeoutPromise=new Promise(((resolve,reject)=>{setTimeout((()=>{reject(new Error("Session creation timed out after 120 seconds"))}),12e4)})),createPromise=window.Translator.create({sourceLanguage:sourceLang,targetLanguage:destLang,monitor:m=>{log.debug("Monitor callback invoked"),m.addEventListener("downloadprogress",(event=>{const percent=(event.loaded/event.total*100).toFixed(1);log.debug("Download progress: "+percent+"% ("+event.loaded+"/"+event.total+")"),progressCallback&&"function"==typeof progressCallback&&progressCallback(percent),event.loaded===event.total&&log.debug("Download complete! Waiting for create() to resolve...")}))}});return log.debug("Waiting for translator creation or timeout..."),this.session=await Promise.race([createPromise,timeoutPromise]),log.debug("Promise resolved! Setting session properties..."),this.sourceLang=sourceLang,this.destLang=destLang,log.debug("Session created successfully"),!0}catch(e){return log.error("Session creation failed: "+e.message),log.error("Error details: "+JSON.stringify(e)),!1}},translate:async function(text){if(!text)return log.debug("no text to translate"),!1;try{log.debug("translating : "+text);var translated=await this.session.translate(text);return log.debug(translated),log.debug("translated : "+translated),translated}catch(e){log.error("Native translation failed: "+e.message)}return!1},is_chrome:function(){var isChromium=window.chrome,winNav=window.navigator,vendorName=winNav.vendor,isOpera=void 0!==window.opr,isIEedge=winNav.userAgent.indexOf("Edg")>-1;return!!winNav.userAgent.match("CriOS")||null!=isChromium&&"Google Inc."===vendorName&&!1===isOpera&&!1===isIEedge}}}));

//# sourceMappingURL=translate.min.js.map