define(["jquery","core/log","core/modal_factory","core/str","core/modal_events","mod_minilesson/definitions","core/templates","mod_minilesson/correctionsmarkup","mod_minilesson/passagereading"],(function($,log,ModalFactory,str,ModalEvents,def,templates,correctionsmarkup,passagereading){return log.debug("Poodll Minilesson Finished page: initialising"),{strings:{},clone:function(){return $.extend(!0,{},this)},init:function(){this.init_strings(),this.register_events()},register_events:function(){var that=this;$("body").on("click",".btn_finished_attempt",(function(e){e.preventDefault();var buttonhref=$(this).data("href");"reattempt"===$(this).data("action")?ModalFactory.create({type:ModalFactory.types.SAVE_CANCEL,title:that.strings.reattempttitle,body:that.strings.reattemptbody}).then((function(modal){modal.setSaveButtonText(that.strings.reattempt),modal.getRoot().on(ModalEvents.save,(function(){window.location.href=buttonhref})),modal.show()})):window.location.href=buttonhref})),$("body").on("click",".mod_minilesson_finishedanswerdetailslink",(function(e){e.preventDefault();$(this).data("type");var resultstemplate=$(this).data("resultstemplate"),resultsdata=$(this).data("resultsdata"),thetarget=$(this).data("target");if(void 0!==thetarget){var resultsbox=$("#"+thetarget);void 0!==resultsbox&&(resultsbox.is(":visible")?resultsbox.hide():!resultsbox.is(":visible")&&resultsbox.html().length>0?resultsbox.show():templates.render("mod_minilesson/"+resultstemplate,resultsdata).then((function(html,js){resultsbox.html(html),resultsdata.hasOwnProperty("grammarerrors")&&correctionsmarkup.init({correctionscontainer:resultsbox,grammarerrors:resultsdata.grammarerrors,grammarmatches:resultsdata.grammarmatches,insertioncount:resultsdata.insertioncount}),resultsdata.hasOwnProperty("unreached")&&passagereading.doComparisonMarkup(resultsdata.comparison,thetarget),resultsbox.show(),templates.runTemplateJS(js)})))}}))},init_strings:function(){var that=this;str.get_strings([{key:"reattempttitle",component:"mod_minilesson"},{key:"reattemptbody",component:"mod_minilesson"},{key:"reattempt",component:"mod_minilesson"}]).done((function(s){var i=0;that.strings.reattempttitle=s[i++],that.strings.reattemptbody=s[i++],that.strings.reattempt=s[i++]}))}}}));

//# sourceMappingURL=quizfinished.min.js.map